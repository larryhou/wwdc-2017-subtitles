[Script Info]
; Script generated by FFmpeg/Lavc57.89.100
ScriptType: v4.00+
PlayResX: 384
PlayResY: 288

[V4+ Styles]
Format: Name, Fontname, Fontsize, PrimaryColour, SecondaryColour, OutlineColour, BackColour, Bold, Italic, Underline, StrikeOut, ScaleX, ScaleY, Spacing, Angle, BorderStyle, Outline, Shadow, Alignment, MarginL, MarginR, MarginV, Encoding
Style: Default,Arial,16,&Hffffff,&Hffffff,&H0,&H0,0,0,0,0,100,100,0,0,1,1,0,2,10,10,10,0

[Events]
Format: Layer, Start, End, Style, Name, MarginL, MarginR, MarginV, Effect, Text
Dialogue: 0,0:00:27.37,0:00:29.13,Default,,0,0,0,,>> Thank you and good morning.
Dialogue: 0,0:00:30.02,0:00:31.78,Default,,0,0,0,,This is Session 712, What's New
Dialogue: 0,0:00:31.78,0:00:32.74,Default,,0,0,0,,In Core Bluetooth.
Dialogue: 0,0:00:33.33,0:00:34.27,Default,,0,0,0,,My name is Craig Dooley.
Dialogue: 0,0:00:34.27,0:00:36.06,Default,,0,0,0,,I'm a Bluetooth Engineer here at
Dialogue: 0,0:00:36.06,0:00:36.36,Default,,0,0,0,,Apple.
Dialogue: 0,0:00:36.93,0:00:39.42,Default,,0,0,0,,I think we have some really good
Dialogue: 0,0:00:39.42,0:00:40.29,Default,,0,0,0,,stuff to talk to you about
Dialogue: 0,0:00:40.29,0:00:42.66,Default,,0,0,0,,today, so we'll start with a
Dialogue: 0,0:00:42.85,0:00:44.78,Default,,0,0,0,,brief introduction of where Core
Dialogue: 0,0:00:44.78,0:00:45.73,Default,,0,0,0,,Bluetooth is right now.
Dialogue: 0,0:00:46.34,0:00:47.31,Default,,0,0,0,,We'll talk about some of the
Dialogue: 0,0:00:47.31,0:00:48.91,Default,,0,0,0,,enhanced reliability features
Dialogue: 0,0:00:48.91,0:00:50.07,Default,,0,0,0,,that we built for this year.
Dialogue: 0,0:00:50.52,0:00:52.15,Default,,0,0,0,,Talk about platform support.
Dialogue: 0,0:00:52.15,0:00:53.92,Default,,0,0,0,,We announced watchOS support
Dialogue: 0,0:00:53.92,0:00:54.69,Default,,0,0,0,,this year and we're really
Dialogue: 0,0:00:54.69,0:00:56.45,Default,,0,0,0,,excited about that.
Dialogue: 0,0:00:56.45,0:00:57.81,Default,,0,0,0,,A new feature for this year is
Dialogue: 0,0:00:57.81,0:00:58.91,Default,,0,0,0,,L2CAP channels.
Dialogue: 0,0:00:59.23,0:01:00.15,Default,,0,0,0,,Then we'll go over some of the
Dialogue: 0,0:01:00.15,0:01:01.34,Default,,0,0,0,,best practices we've learned
Dialogue: 0,0:01:01.34,0:01:03.08,Default,,0,0,0,,over the years, and finally
Dialogue: 0,0:01:03.08,0:01:05.26,Default,,0,0,0,,we'll do a real world example of
Dialogue: 0,0:01:05.26,0:01:06.34,Default,,0,0,0,,how to get the most out of Core
Dialogue: 0,0:01:06.34,0:01:06.78,Default,,0,0,0,,Bluetooth.
Dialogue: 0,0:01:07.26,0:01:10.00,Default,,0,0,0,,So I'd like to start with a
Dialogue: 0,0:01:10.00,0:01:11.04,Default,,0,0,0,,brief introduction.
Dialogue: 0,0:01:11.26,0:01:13.75,Default,,0,0,0,,Hopefully everybody knows but,
Dialogue: 0,0:01:14.11,0:01:15.40,Default,,0,0,0,,if you don't, Core Bluetooth is
Dialogue: 0,0:01:15.40,0:01:16.68,Default,,0,0,0,,our framework that we released
Dialogue: 0,0:01:16.68,0:01:19.12,Default,,0,0,0,,in 2011 to interact with
Dialogue: 0,0:01:19.12,0:01:20.96,Default,,0,0,0,,Bluetooth low energy peripherals
Dialogue: 0,0:01:20.96,0:01:21.80,Default,,0,0,0,,and accessories.
Dialogue: 0,0:01:22.20,0:01:25.23,Default,,0,0,0,,And since we initially shipped
Dialogue: 0,0:01:25.23,0:01:27.17,Default,,0,0,0,,the framework, we've just seen
Dialogue: 0,0:01:27.17,0:01:28.82,Default,,0,0,0,,amazing creativity come out of
Dialogue: 0,0:01:28.82,0:01:30.23,Default,,0,0,0,,accessory manufacturers and app
Dialogue: 0,0:01:30.23,0:01:30.84,Default,,0,0,0,,developers.
Dialogue: 0,0:01:30.84,0:01:32.07,Default,,0,0,0,,We're so pleased to see what
Dialogue: 0,0:01:32.07,0:01:34.84,Default,,0,0,0,,you've done with it.
Dialogue: 0,0:01:35.03,0:01:36.28,Default,,0,0,0,,So when we started off, we knew
Dialogue: 0,0:01:36.28,0:01:37.36,Default,,0,0,0,,that health and fitness and were
Dialogue: 0,0:01:37.36,0:01:38.58,Default,,0,0,0,,going to be big areas.
Dialogue: 0,0:01:39.17,0:01:40.26,Default,,0,0,0,,We've seen lots of things like
Dialogue: 0,0:01:40.33,0:01:42.95,Default,,0,0,0,,smart scales, running sensors,
Dialogue: 0,0:01:43.53,0:01:44.81,Default,,0,0,0,,fitness devices that you can
Dialogue: 0,0:01:44.81,0:01:45.46,Default,,0,0,0,,wear all day.
Dialogue: 0,0:01:45.81,0:01:47.98,Default,,0,0,0,,But the creativity has been
Dialogue: 0,0:01:47.98,0:01:48.67,Default,,0,0,0,,awesome to watch.
Dialogue: 0,0:01:48.67,0:01:50.15,Default,,0,0,0,,So things like toys and
Dialogue: 0,0:01:50.15,0:01:51.65,Default,,0,0,0,,connected accessories for kids.
Dialogue: 0,0:01:52.02,0:01:53.63,Default,,0,0,0,,We were really excited to see
Dialogue: 0,0:01:53.63,0:01:54.47,Default,,0,0,0,,the Swift Playground's
Dialogue: 0,0:01:54.47,0:01:56.10,Default,,0,0,0,,announcements this year, and
Dialogue: 0,0:01:56.30,0:01:57.40,Default,,0,0,0,,really making things more
Dialogue: 0,0:01:57.40,0:01:58.67,Default,,0,0,0,,interactive for children and
Dialogue: 0,0:01:58.67,0:02:00.80,Default,,0,0,0,,people who are first learning to
Dialogue: 0,0:02:01.38,0:02:01.48,Default,,0,0,0,,code.
Dialogue: 0,0:02:01.69,0:02:04.46,Default,,0,0,0,,And we love seeing how easy it
Dialogue: 0,0:02:04.46,0:02:06.04,Default,,0,0,0,,is for people to take things
Dialogue: 0,0:02:06.04,0:02:07.71,Default,,0,0,0,,like sensors or buttons or
Dialogue: 0,0:02:07.71,0:02:09.73,Default,,0,0,0,,switches and enable those
Dialogue: 0,0:02:09.73,0:02:11.15,Default,,0,0,0,,through their apps and enable
Dialogue: 0,0:02:11.15,0:02:11.98,Default,,0,0,0,,them wirelessly.
Dialogue: 0,0:02:12.96,0:02:14.52,Default,,0,0,0,,And then things have gone in
Dialogue: 0,0:02:14.52,0:02:16.65,Default,,0,0,0,,directions that we couldn't have
Dialogue: 0,0:02:16.65,0:02:17.81,Default,,0,0,0,,even imagined.
Dialogue: 0,0:02:18.81,0:02:21.03,Default,,0,0,0,,Things like connected goggles
Dialogue: 0,0:02:21.03,0:02:22.84,Default,,0,0,0,,with head-mounted displays, just
Dialogue: 0,0:02:23.03,0:02:24.35,Default,,0,0,0,,awesome creativity that's come
Dialogue: 0,0:02:24.35,0:02:25.17,Default,,0,0,0,,out of this community.
Dialogue: 0,0:02:25.56,0:02:26.94,Default,,0,0,0,,So I want to start this talk
Dialogue: 0,0:02:26.94,0:02:28.86,Default,,0,0,0,,just by saying thank you.
Dialogue: 0,0:02:30.52,0:02:32.55,Default,,0,0,0,,[ Applause ]
Dialogue: 0,0:02:33.05,0:02:34.75,Default,,0,0,0,,It's awesome for us to see what
Dialogue: 0,0:02:34.75,0:02:35.71,Default,,0,0,0,,you've been able to build with
Dialogue: 0,0:02:35.71,0:02:36.87,Default,,0,0,0,,this technology, and we can't
Dialogue: 0,0:02:36.87,0:02:39.18,Default,,0,0,0,,wait to see how you build even
Dialogue: 0,0:02:39.18,0:02:40.74,Default,,0,0,0,,better accessories going forward
Dialogue: 0,0:02:40.74,0:02:42.08,Default,,0,0,0,,with these enhancements we want
Dialogue: 0,0:02:42.08,0:02:45.77,Default,,0,0,0,,to talk to you about today.
Dialogue: 0,0:02:45.89,0:02:48.04,Default,,0,0,0,,And before we start, I just want
Dialogue: 0,0:02:48.04,0:02:49.25,Default,,0,0,0,,to mention there's a lot of
Dialogue: 0,0:02:49.25,0:02:50.34,Default,,0,0,0,,types of accessories that you
Dialogue: 0,0:02:50.34,0:02:51.47,Default,,0,0,0,,don't have to write any software
Dialogue: 0,0:02:51.47,0:02:51.77,Default,,0,0,0,,for.
Dialogue: 0,0:02:52.23,0:02:53.44,Default,,0,0,0,,So if you want to see things
Dialogue: 0,0:02:53.44,0:02:54.60,Default,,0,0,0,,like what the currently playing
Dialogue: 0,0:02:54.60,0:02:56.68,Default,,0,0,0,,music is on your device, you can
Dialogue: 0,0:02:56.68,0:02:57.68,Default,,0,0,0,,implement the Apple Media
Dialogue: 0,0:02:57.68,0:02:59.87,Default,,0,0,0,,Service and the device will take
Dialogue: 0,0:02:59.87,0:03:00.97,Default,,0,0,0,,care of all of that for you.
Dialogue: 0,0:03:01.38,0:03:03.76,Default,,0,0,0,,Things like iBeacon or HID
Dialogue: 0,0:03:03.76,0:03:05.33,Default,,0,0,0,,devices, you don't have to write
Dialogue: 0,0:03:05.33,0:03:06.49,Default,,0,0,0,,any software for those.
Dialogue: 0,0:03:06.49,0:03:07.17,Default,,0,0,0,,And we've seen really good
Dialogue: 0,0:03:07.17,0:03:07.98,Default,,0,0,0,,adoption for those as well.
Dialogue: 0,0:03:10.98,0:03:12.58,Default,,0,0,0,,But today is going to be about
Dialogue: 0,0:03:12.73,0:03:14.54,Default,,0,0,0,,Core Bluetooth and how your
Dialogue: 0,0:03:14.54,0:03:15.67,Default,,0,0,0,,device can talk to your
Dialogue: 0,0:03:15.67,0:03:16.18,Default,,0,0,0,,accessory.
Dialogue: 0,0:03:16.70,0:03:19.14,Default,,0,0,0,,So stepping back to stage 1,
Dialogue: 0,0:03:19.32,0:03:21.42,Default,,0,0,0,,Bluetooth Low Energy has two
Dialogue: 0,0:03:21.42,0:03:21.87,Default,,0,0,0,,roles.
Dialogue: 0,0:03:22.04,0:03:23.45,Default,,0,0,0,,There's a central that can look
Dialogue: 0,0:03:23.45,0:03:25.17,Default,,0,0,0,,for devices that are around your
Dialogue: 0,0:03:25.17,0:03:27.40,Default,,0,0,0,,environment, and there are
Dialogue: 0,0:03:27.40,0:03:28.73,Default,,0,0,0,,peripherals that can beacon to
Dialogue: 0,0:03:28.73,0:03:30.24,Default,,0,0,0,,the world that they're there.
Dialogue: 0,0:03:30.24,0:03:31.95,Default,,0,0,0,,They can either send out data or
Dialogue: 0,0:03:31.95,0:03:32.93,Default,,0,0,0,,just let their presence be
Dialogue: 0,0:03:32.93,0:03:33.29,Default,,0,0,0,,known.
Dialogue: 0,0:03:34.06,0:03:35.17,Default,,0,0,0,,So if you have simple things
Dialogue: 0,0:03:35.17,0:03:36.11,Default,,0,0,0,,that you want to send out like
Dialogue: 0,0:03:36.11,0:03:37.62,Default,,0,0,0,,the current temperature or the
Dialogue: 0,0:03:37.62,0:03:42.29,Default,,0,0,0,,time, you can do that and you
Dialogue: 0,0:03:42.29,0:03:43.60,Default,,0,0,0,,can actually connect device to
Dialogue: 0,0:03:43.60,0:03:44.41,Default,,0,0,0,,device as well.
Dialogue: 0,0:03:44.92,0:03:46.72,Default,,0,0,0,,iOS and Mac devices are allowed
Dialogue: 0,0:03:46.72,0:03:47.94,Default,,0,0,0,,to be both the central and the
Dialogue: 0,0:03:48.05,0:03:48.68,Default,,0,0,0,,peripheral side of the
Dialogue: 0,0:03:48.68,0:03:48.98,Default,,0,0,0,,connection.
Dialogue: 0,0:03:52.31,0:03:53.71,Default,,0,0,0,,After you find this device
Dialogue: 0,0:03:53.71,0:03:54.70,Default,,0,0,0,,that's around you, you can
Dialogue: 0,0:03:54.70,0:03:56.30,Default,,0,0,0,,connect to your device and then
Dialogue: 0,0:03:56.30,0:03:57.19,Default,,0,0,0,,you have bidirectional
Dialogue: 0,0:03:57.19,0:03:59.16,Default,,0,0,0,,communication through what's
Dialogue: 0,0:03:59.16,0:04:00.24,Default,,0,0,0,,called the GATT Protocol.
Dialogue: 0,0:04:00.81,0:04:02.23,Default,,0,0,0,,The GATT Protocol takes all of
Dialogue: 0,0:04:02.23,0:04:05.00,Default,,0,0,0,,your data and it exposes them in
Dialogue: 0,0:04:05.00,0:04:06.56,Default,,0,0,0,,a hierarchy called services and
Dialogue: 0,0:04:06.56,0:04:07.38,Default,,0,0,0,,characteristics.
Dialogue: 0,0:04:08.18,0:04:09.38,Default,,0,0,0,,We represent these in Core
Dialogue: 0,0:04:09.38,0:04:11.39,Default,,0,0,0,,Bluetooth as a CB service.
Dialogue: 0,0:04:11.96,0:04:13.96,Default,,0,0,0,,And a CB service can contain
Dialogue: 0,0:04:13.96,0:04:16.50,Default,,0,0,0,,characteristics inside of it.
Dialogue: 0,0:04:16.75,0:04:19.06,Default,,0,0,0,,Most of the time, your Apple
Dialogue: 0,0:04:19.06,0:04:19.93,Default,,0,0,0,,device is going to be the
Dialogue: 0,0:04:19.93,0:04:21.24,Default,,0,0,0,,central side of this connection
Dialogue: 0,0:04:21.75,0:04:22.46,Default,,0,0,0,,and you connect to your
Dialogue: 0,0:04:22.46,0:04:23.00,Default,,0,0,0,,peripheral.
Dialogue: 0,0:04:24.44,0:04:25.84,Default,,0,0,0,,But you can also do this in
Dialogue: 0,0:04:25.84,0:04:26.21,Default,,0,0,0,,reverse.
Dialogue: 0,0:04:26.21,0:04:27.67,Default,,0,0,0,,So one example of this is your
Dialogue: 0,0:04:27.67,0:04:30.12,Default,,0,0,0,,phone has its own GATT database
Dialogue: 0,0:04:30.17,0:04:31.43,Default,,0,0,0,,that exposes something like the
Dialogue: 0,0:04:31.43,0:04:32.44,Default,,0,0,0,,current time service.
Dialogue: 0,0:04:32.84,0:04:34.54,Default,,0,0,0,,So if it's useful for your
Dialogue: 0,0:04:34.54,0:04:35.82,Default,,0,0,0,,accessory to get the current
Dialogue: 0,0:04:35.82,0:04:38.36,Default,,0,0,0,,time, you can actually read that
Dialogue: 0,0:04:38.59,0:04:39.42,Default,,0,0,0,,off of your phone.
Dialogue: 0,0:04:40.48,0:04:41.56,Default,,0,0,0,,If you're looking to build these
Dialogue: 0,0:04:41.56,0:04:43.19,Default,,0,0,0,,type of iDirectional
Dialogue: 0,0:04:43.19,0:04:47.13,Default,,0,0,0,,communications on CB Central
Dialogue: 0,0:04:47.13,0:04:49.46,Default,,0,0,0,,manager, you can either retrieve
Dialogue: 0,0:04:49.46,0:04:50.75,Default,,0,0,0,,the connected peripherals if you
Dialogue: 0,0:04:50.75,0:04:52.34,Default,,0,0,0,,know that your device is already
Dialogue: 0,0:04:52.34,0:04:53.36,Default,,0,0,0,,connected by calling
Dialogue: 0,0:04:53.36,0:04:55.92,Default,,0,0,0,,retrieveConnectedPeripherals or
Dialogue: 0,0:04:55.92,0:04:57.49,Default,,0,0,0,,if you have an identifier for an
Dialogue: 0,0:04:57.49,0:04:58.41,Default,,0,0,0,,accessory you can call
Dialogue: 0,0:04:58.41,0:04:59.39,Default,,0,0,0,,retrievePeripherals
Dialogue: 0,0:04:59.39,0:05:01.38,Default,,0,0,0,,(withidentifiers) and get
Dialogue: 0,0:05:01.38,0:05:02.78,Default,,0,0,0,,handled back to your accessory.
Dialogue: 0,0:05:09.25,0:05:10.41,Default,,0,0,0,,So let's move onto something new
Dialogue: 0,0:05:10.41,0:05:10.96,Default,,0,0,0,,for this year.
Dialogue: 0,0:05:11.37,0:05:14.07,Default,,0,0,0,,As I mentioned, the health and
Dialogue: 0,0:05:14.07,0:05:15.42,Default,,0,0,0,,fitness space has really popped
Dialogue: 0,0:05:15.42,0:05:17.00,Default,,0,0,0,,up since Core Bluetooth was
Dialogue: 0,0:05:17.00,0:05:17.79,Default,,0,0,0,,first announced.
Dialogue: 0,0:05:18.25,0:05:19.35,Default,,0,0,0,,And we find there's a whole
Dialogue: 0,0:05:19.35,0:05:20.74,Default,,0,0,0,,class of devices that want to be
Dialogue: 0,0:05:20.74,0:05:21.57,Default,,0,0,0,,connected all day.
Dialogue: 0,0:05:22.53,0:05:24.56,Default,,0,0,0,,Users want access to their data
Dialogue: 0,0:05:25.01,0:05:26.28,Default,,0,0,0,,as they're wearing it or
Dialogue: 0,0:05:26.28,0:05:28.34,Default,,0,0,0,,throughout the night, and you
Dialogue: 0,0:05:28.34,0:05:29.50,Default,,0,0,0,,want to make sure that your
Dialogue: 0,0:05:29.50,0:05:30.65,Default,,0,0,0,,connection to your Accessories
Dialogue: 0,0:05:30.65,0:05:31.30,Default,,0,0,0,,is reliable.
Dialogue: 0,0:05:33.44,0:05:35.16,Default,,0,0,0,,So on iOS we allow you to be a
Dialogue: 0,0:05:35.16,0:05:36.34,Default,,0,0,0,,background application.
Dialogue: 0,0:05:36.74,0:05:38.09,Default,,0,0,0,,You can continue connecting out
Dialogue: 0,0:05:38.09,0:05:39.55,Default,,0,0,0,,to your accessory or you can
Dialogue: 0,0:05:39.55,0:05:41.80,Default,,0,0,0,,continue beaconing to the world
Dialogue: 0,0:05:41.80,0:05:42.74,Default,,0,0,0,,that you have data that's
Dialogue: 0,0:05:42.74,0:05:44.72,Default,,0,0,0,,available by using these two
Dialogue: 0,0:05:44.88,0:05:45.86,Default,,0,0,0,,options in Xcode.
Dialogue: 0,0:05:45.86,0:05:48.08,Default,,0,0,0,,In you can either choose to use
Dialogue: 0,0:05:48.08,0:05:49.86,Default,,0,0,0,,your Bluetooth LE accessories or
Dialogue: 0,0:05:49.86,0:05:51.50,Default,,0,0,0,,act as a Bluetooth LE accessory
Dialogue: 0,0:05:51.50,0:05:52.47,Default,,0,0,0,,if a peripheral is the role that
Dialogue: 0,0:05:52.47,0:05:52.98,Default,,0,0,0,,you want to implement.
Dialogue: 0,0:05:57.16,0:05:58.35,Default,,0,0,0,,But we allow you to go even
Dialogue: 0,0:05:58.35,0:06:00.62,Default,,0,0,0,,further than that, so if you're
Dialogue: 0,0:06:00.62,0:06:02.44,Default,,0,0,0,,acting as a central, you can do
Dialogue: 0,0:06:02.44,0:06:04.09,Default,,0,0,0,,things like Scan for new devices
Dialogue: 0,0:06:04.09,0:06:06.05,Default,,0,0,0,,by specifying a service or
Dialogue: 0,0:06:06.05,0:06:07.10,Default,,0,0,0,,Connect to an accessory you
Dialogue: 0,0:06:07.10,0:06:08.95,Default,,0,0,0,,already known about and even if
Dialogue: 0,0:06:08.95,0:06:10.60,Default,,0,0,0,,your application is Jetson from
Dialogue: 0,0:06:10.60,0:06:11.87,Default,,0,0,0,,the system from memory reasons,
Dialogue: 0,0:06:12.33,0:06:13.71,Default,,0,0,0,,Core Bluetooth will continue to
Dialogue: 0,0:06:13.71,0:06:15.17,Default,,0,0,0,,look for those devices for you.
Dialogue: 0,0:06:17.22,0:06:18.87,Default,,0,0,0,,If we were to do this in code,
Dialogue: 0,0:06:19.23,0:06:20.80,Default,,0,0,0,,at the time that you initialize
Dialogue: 0,0:06:20.80,0:06:22.57,Default,,0,0,0,,a CBCentralManager, you pass
Dialogue: 0,0:06:22.57,0:06:23.90,Default,,0,0,0,,this RestoreIdentifier.
Dialogue: 0,0:06:24.29,0:06:25.49,Default,,0,0,0,,This is just a string that
Dialogue: 0,0:06:25.49,0:06:26.86,Default,,0,0,0,,identifies your session that you
Dialogue: 0,0:06:26.86,0:06:28.08,Default,,0,0,0,,want to continue going.
Dialogue: 0,0:06:29.54,0:06:31.90,Default,,0,0,0,,And if we can complete those
Dialogue: 0,0:06:31.90,0:06:33.37,Default,,0,0,0,,actions on your behalf, like
Dialogue: 0,0:06:33.37,0:06:34.51,Default,,0,0,0,,connecting to your accessory,
Dialogue: 0,0:06:34.51,0:06:35.64,Default,,0,0,0,,even if it's a week after your
Dialogue: 0,0:06:35.64,0:06:37.52,Default,,0,0,0,,application was launched, we'll
Dialogue: 0,0:06:37.52,0:06:38.90,Default,,0,0,0,,relaunch your application and
Dialogue: 0,0:06:38.90,0:06:39.86,Default,,0,0,0,,give you this callback.
Dialogue: 0,0:06:39.86,0:06:41.51,Default,,0,0,0,,CentralManager will restore
Dialogue: 0,0:06:41.51,0:06:41.99,Default,,0,0,0,,state.
Dialogue: 0,0:06:42.72,0:06:44.33,Default,,0,0,0,,This is when we'll tell you what
Dialogue: 0,0:06:44.33,0:06:45.59,Default,,0,0,0,,the current state of the system
Dialogue: 0,0:06:45.59,0:06:47.06,Default,,0,0,0,,is so you can reconcile where we
Dialogue: 0,0:06:47.06,0:06:48.80,Default,,0,0,0,,are now versus the time that
Dialogue: 0,0:06:48.80,0:06:50.05,Default,,0,0,0,,your application was killed.
Dialogue: 0,0:06:50.59,0:06:52.07,Default,,0,0,0,,We'll tell you about the
Dialogue: 0,0:06:52.07,0:06:53.74,Default,,0,0,0,,currently connected peripherals
Dialogue: 0,0:06:53.97,0:06:55.30,Default,,0,0,0,,and we'll also tell you what we
Dialogue: 0,0:06:55.30,0:06:56.85,Default,,0,0,0,,are scanning for at the time
Dialogue: 0,0:06:56.85,0:06:58.39,Default,,0,0,0,,that you're relaunched.
Dialogue: 0,0:06:59.36,0:07:00.46,Default,,0,0,0,,Now there will be times where
Dialogue: 0,0:07:00.46,0:07:02.05,Default,,0,0,0,,these can be null as well, so
Dialogue: 0,0:07:02.38,0:07:04.00,Default,,0,0,0,,you have to be able to be
Dialogue: 0,0:07:04.00,0:07:06.46,Default,,0,0,0,,flexible with this and know that
Dialogue: 0,0:07:06.46,0:07:08.38,Default,,0,0,0,,you can rebuild your state after
Dialogue: 0,0:07:08.38,0:07:09.11,Default,,0,0,0,,you're relaunched.
Dialogue: 0,0:07:11.60,0:07:13.36,Default,,0,0,0,,Similarly, if you're acting as a
Dialogue: 0,0:07:13.36,0:07:16.24,Default,,0,0,0,,peripheral we can keep doing
Dialogue: 0,0:07:16.24,0:07:17.56,Default,,0,0,0,,things on your behalf even after
Dialogue: 0,0:07:17.56,0:07:18.93,Default,,0,0,0,,your application is no longer
Dialogue: 0,0:07:18.93,0:07:21.67,Default,,0,0,0,,and we'll relaunch you when
Dialogue: 0,0:07:21.67,0:07:22.61,Default,,0,0,0,,that's interesting for your
Dialogue: 0,0:07:22.61,0:07:23.19,Default,,0,0,0,,application.
Dialogue: 0,0:07:23.97,0:07:25.34,Default,,0,0,0,,So if you had a local service
Dialogue: 0,0:07:25.34,0:07:26.69,Default,,0,0,0,,published in the GATT database
Dialogue: 0,0:07:27.03,0:07:28.68,Default,,0,0,0,,or you're advertising a service,
Dialogue: 0,0:07:28.68,0:07:30.08,Default,,0,0,0,,we can keep those things going
Dialogue: 0,0:07:30.08,0:07:31.14,Default,,0,0,0,,and let you know when something
Dialogue: 0,0:07:31.14,0:07:34.34,Default,,0,0,0,,interesting happens.
Dialogue: 0,0:07:34.45,0:07:35.76,Default,,0,0,0,,Again, you have to start with a
Dialogue: 0,0:07:35.76,0:07:38.48,Default,,0,0,0,,restoration identifier, which
Dialogue: 0,0:07:38.48,0:07:39.91,Default,,0,0,0,,needs to be unique on the system
Dialogue: 0,0:07:40.59,0:07:41.99,Default,,0,0,0,,and we'll tell you the current
Dialogue: 0,0:07:41.99,0:07:43.17,Default,,0,0,0,,state of the system after you
Dialogue: 0,0:07:43.17,0:07:43.54,Default,,0,0,0,,come back.
Dialogue: 0,0:07:44.15,0:07:45.89,Default,,0,0,0,,We'll tell you either through
Dialogue: 0,0:07:45.89,0:07:47.57,Default,,0,0,0,,the restored state services key
Dialogue: 0,0:07:48.87,0:07:51.17,Default,,0,0,0,,what services are still
Dialogue: 0,0:07:51.77,0:07:53.29,Default,,0,0,0,,published on the system for you
Dialogue: 0,0:07:54.11,0:07:56.73,Default,,0,0,0,,and through the state
Dialogue: 0,0:07:56.73,0:07:59.01,Default,,0,0,0,,advertising data key we'll tell
Dialogue: 0,0:07:59.01,0:08:00.41,Default,,0,0,0,,you what we're advertising on
Dialogue: 0,0:08:00.41,0:08:01.00,Default,,0,0,0,,your behalf.
Dialogue: 0,0:08:04.01,0:08:05.36,Default,,0,0,0,,So state preservation and
Dialogue: 0,0:08:05.36,0:08:06.58,Default,,0,0,0,,restoration that has actually
Dialogue: 0,0:08:06.58,0:08:07.61,Default,,0,0,0,,been in the system for a couple
Dialogue: 0,0:08:07.61,0:08:09.80,Default,,0,0,0,,of years, but this year we've
Dialogue: 0,0:08:09.80,0:08:11.46,Default,,0,0,0,,enhanced it to be even more
Dialogue: 0,0:08:11.46,0:08:12.73,Default,,0,0,0,,reliable for your application.
Dialogue: 0,0:08:13.25,0:08:15.51,Default,,0,0,0,,So we're excited to tell you,
Dialogue: 0,0:08:15.91,0:08:17.16,Default,,0,0,0,,even if there are Bluetooth
Dialogue: 0,0:08:17.16,0:08:19.39,Default,,0,0,0,,system level events that
Dialogue: 0,0:08:19.39,0:08:20.57,Default,,0,0,0,,previously would have stopped
Dialogue: 0,0:08:20.57,0:08:22.05,Default,,0,0,0,,these things from occurring on
Dialogue: 0,0:08:22.05,0:08:24.37,Default,,0,0,0,,your behalf, we'll keep doing
Dialogue: 0,0:08:24.37,0:08:25.05,Default,,0,0,0,,them for you now.
Dialogue: 0,0:08:25.37,0:08:26.80,Default,,0,0,0,,And even if a user reboots the
Dialogue: 0,0:08:26.80,0:08:28.58,Default,,0,0,0,,device, we can keep connecting
Dialogue: 0,0:08:28.58,0:08:29.26,Default,,0,0,0,,to your accessory.
Dialogue: 0,0:08:30.52,0:08:33.58,Default,,0,0,0,,[ Applause ]
Dialogue: 0,0:08:34.08,0:08:36.41,Default,,0,0,0,,Thank you.
Dialogue: 0,0:08:36.61,0:08:39.20,Default,,0,0,0,,And one thing we just want to
Dialogue: 0,0:08:39.20,0:08:41.75,Default,,0,0,0,,mention is that in order to keep
Dialogue: 0,0:08:41.87,0:08:43.16,Default,,0,0,0,,the power profile of these
Dialogue: 0,0:08:43.16,0:08:45.03,Default,,0,0,0,,features low, we actually do
Dialogue: 0,0:08:45.03,0:08:46.10,Default,,0,0,0,,have to do a lot of things in
Dialogue: 0,0:08:46.10,0:08:46.62,Default,,0,0,0,,Hardware.
Dialogue: 0,0:08:47.27,0:08:49.61,Default,,0,0,0,,So, we are limited in the number
Dialogue: 0,0:08:49.61,0:08:50.68,Default,,0,0,0,,of things we can look for at a
Dialogue: 0,0:08:50.68,0:08:52.29,Default,,0,0,0,,time, especially the number of
Dialogue: 0,0:08:52.56,0:08:54.01,Default,,0,0,0,,services we can scan for.
Dialogue: 0,0:08:54.48,0:08:55.88,Default,,0,0,0,,So the less things you ask for,
Dialogue: 0,0:08:55.88,0:08:57.93,Default,,0,0,0,,the better the chances that we
Dialogue: 0,0:08:58.35,0:08:59.72,Default,,0,0,0,,can keep your actions running
Dialogue: 0,0:08:59.72,0:09:00.44,Default,,0,0,0,,all the time.
Dialogue: 0,0:09:03.87,0:09:05.57,Default,,0,0,0,,The other thing about this is
Dialogue: 0,0:09:05.57,0:09:08.28,Default,,0,0,0,,there's no UI to control what
Dialogue: 0,0:09:08.28,0:09:09.69,Default,,0,0,0,,applications are allowed to do
Dialogue: 0,0:09:09.69,0:09:11.70,Default,,0,0,0,,what in the background, so we
Dialogue: 0,0:09:11.70,0:09:12.96,Default,,0,0,0,,will stop doing things on your
Dialogue: 0,0:09:12.96,0:09:14.67,Default,,0,0,0,,app's behalf if the user either
Dialogue: 0,0:09:14.91,0:09:16.15,Default,,0,0,0,,force quits the app through the
Dialogue: 0,0:09:16.15,0:09:18.85,Default,,0,0,0,,task switcher or if the user
Dialogue: 0,0:09:18.85,0:09:20.27,Default,,0,0,0,,turns off Bluetooth manually
Dialogue: 0,0:09:20.27,0:09:22.34,Default,,0,0,0,,through Bluetooth settings we'll
Dialogue: 0,0:09:22.34,0:09:23.82,Default,,0,0,0,,stop doing background activities
Dialogue: 0,0:09:23.82,0:09:27.62,Default,,0,0,0,,on your behalf.
Dialogue: 0,0:09:27.62,0:09:28.70,Default,,0,0,0,,Another thing we've enhanced for
Dialogue: 0,0:09:28.70,0:09:29.85,Default,,0,0,0,,this year is Write Without
Dialogue: 0,0:09:29.85,0:09:30.41,Default,,0,0,0,,Response.
Dialogue: 0,0:09:31.09,0:09:32.21,Default,,0,0,0,,So previously you could call
Dialogue: 0,0:09:32.21,0:09:33.98,Default,,0,0,0,,Write Without Response, and as
Dialogue: 0,0:09:33.98,0:09:36.16,Default,,0,0,0,,the name implies you don't hear
Dialogue: 0,0:09:36.16,0:09:37.15,Default,,0,0,0,,anything back from that.
Dialogue: 0,0:09:37.15,0:09:39.74,Default,,0,0,0,,And there are times when your
Dialogue: 0,0:09:39.74,0:09:40.91,Default,,0,0,0,,writes would be dropped if you
Dialogue: 0,0:09:40.91,0:09:42.58,Default,,0,0,0,,pushed too many into the system.
Dialogue: 0,0:09:43.04,0:09:44.23,Default,,0,0,0,,And we had no way to tell you
Dialogue: 0,0:09:44.23,0:09:45.36,Default,,0,0,0,,that those packets were dropped
Dialogue: 0,0:09:45.36,0:09:46.45,Default,,0,0,0,,so if you were trying to send a
Dialogue: 0,0:09:46.45,0:09:48.04,Default,,0,0,0,,large amount of data you had to
Dialogue: 0,0:09:48.04,0:09:49.30,Default,,0,0,0,,come up with schemes to try to
Dialogue: 0,0:09:49.30,0:09:50.28,Default,,0,0,0,,make sure that that data was
Dialogue: 0,0:09:50.28,0:09:50.77,Default,,0,0,0,,reliable.
Dialogue: 0,0:09:51.27,0:09:53.52,Default,,0,0,0,,For this year, we've enhanced
Dialogue: 0,0:09:53.52,0:09:55.92,Default,,0,0,0,,CBPeripheral with a new property
Dialogue: 0,0:09:55.92,0:09:56.19,Default,,0,0,0,,called
Dialogue: 0,0:09:56.19,0:09:57.80,Default,,0,0,0,,canSendWriteWithoutResponse.
Dialogue: 0,0:09:57.90,0:09:59.67,Default,,0,0,0,,So if you call this before you
Dialogue: 0,0:09:59.67,0:10:00.93,Default,,0,0,0,,do a write and it and it returns
Dialogue: 0,0:10:00.93,0:10:02.78,Default,,0,0,0,,yes, that's our promise to you
Dialogue: 0,0:10:02.78,0:10:04.29,Default,,0,0,0,,that your data will not be
Dialogue: 0,0:10:04.29,0:10:05.80,Default,,0,0,0,,dropped in software before we
Dialogue: 0,0:10:05.80,0:10:06.83,Default,,0,0,0,,get a chance to send it to the
Dialogue: 0,0:10:06.83,0:10:07.58,Default,,0,0,0,,remote peripheral.
Dialogue: 0,0:10:08.14,0:10:10.91,Default,,0,0,0,,If that returns no, you'll also
Dialogue: 0,0:10:10.91,0:10:12.03,Default,,0,0,0,,get a delegate callback when
Dialogue: 0,0:10:12.03,0:10:14.13,Default,,0,0,0,,we're ready and we'll call back
Dialogue: 0,0:10:14.13,0:10:15.16,Default,,0,0,0,,peripheralIsReady
Dialogue: 0,0:10:15.16,0:10:16.47,Default,,0,0,0,,(toSendWritewithoutResponse.
Dialogue: 0,0:10:18.52,0:10:23.02,Default,,0,0,0,,[ Applause ]
Dialogue: 0,0:10:23.52,0:10:25.41,Default,,0,0,0,,Thank you.
Dialogue: 0,0:10:25.59,0:10:29.38,Default,,0,0,0,,Okay. So when we first launched
Dialogue: 0,0:10:29.38,0:10:32.11,Default,,0,0,0,,in 2011 we support macOS 10.7
Dialogue: 0,0:10:32.11,0:10:33.01,Default,,0,0,0,,and iOS 5.
Dialogue: 0,0:10:34.08,0:10:35.22,Default,,0,0,0,,We supported those this whole
Dialogue: 0,0:10:35.22,0:10:38.37,Default,,0,0,0,,time, and on tvOS 9 we added
Dialogue: 0,0:10:38.37,0:10:39.59,Default,,0,0,0,,support for tvOS.
Dialogue: 0,0:10:39.90,0:10:41.17,Default,,0,0,0,,This is actually the first time
Dialogue: 0,0:10:41.17,0:10:42.22,Default,,0,0,0,,we've been on stage to talk to
Dialogue: 0,0:10:42.22,0:10:45.13,Default,,0,0,0,,you about that so we'd like to
Dialogue: 0,0:10:45.13,0:10:46.37,Default,,0,0,0,,go over that as well.
Dialogue: 0,0:10:46.78,0:10:47.90,Default,,0,0,0,,And new for this year, we're
Dialogue: 0,0:10:47.90,0:10:49.11,Default,,0,0,0,,supporting watchOS.
Dialogue: 0,0:10:49.43,0:10:50.90,Default,,0,0,0,,We think this opens a lot of
Dialogue: 0,0:10:50.90,0:10:52.71,Default,,0,0,0,,cool opportunities, especially
Dialogue: 0,0:10:52.71,0:10:53.92,Default,,0,0,0,,in the health and fitness space
Dialogue: 0,0:10:53.92,0:10:55.48,Default,,0,0,0,,for places where it was
Dialogue: 0,0:10:55.48,0:10:56.93,Default,,0,0,0,,unpractical to bring your phone
Dialogue: 0,0:10:56.93,0:10:57.51,Default,,0,0,0,,previously.
Dialogue: 0,0:11:00.52,0:11:02.43,Default,,0,0,0,,So iOS and macOS were the first
Dialogue: 0,0:11:02.43,0:11:03.58,Default,,0,0,0,,platforms that we supported.
Dialogue: 0,0:11:04.43,0:11:05.93,Default,,0,0,0,,They support both foreground and
Dialogue: 0,0:11:05.93,0:11:07.62,Default,,0,0,0,,background applications, and
Dialogue: 0,0:11:07.62,0:11:08.90,Default,,0,0,0,,both central and peripheral mode
Dialogue: 0,0:11:08.90,0:11:09.46,Default,,0,0,0,,operation.
Dialogue: 0,0:11:13.37,0:11:15.74,Default,,0,0,0,,We allow you to go down to 15 ms
Dialogue: 0,0:11:15.74,0:11:16.87,Default,,0,0,0,,starting this year for your
Dialogue: 0,0:11:16.87,0:11:17.61,Default,,0,0,0,,connection interval.
Dialogue: 0,0:11:17.84,0:11:18.69,Default,,0,0,0,,So if you're trying to get the
Dialogue: 0,0:11:18.69,0:11:19.72,Default,,0,0,0,,most throughput to your
Dialogue: 0,0:11:19.72,0:11:21.32,Default,,0,0,0,,accessories or the lowest
Dialogue: 0,0:11:21.32,0:11:23.17,Default,,0,0,0,,latency, these are the platforms
Dialogue: 0,0:11:23.17,0:11:24.56,Default,,0,0,0,,that provide you the most
Dialogue: 0,0:11:24.56,0:11:25.56,Default,,0,0,0,,opportunities there.
Dialogue: 0,0:11:26.13,0:11:28.52,Default,,0,0,0,,And as I mentioned, state
Dialogue: 0,0:11:28.52,0:11:30.24,Default,,0,0,0,,preservation and restoration are
Dialogue: 0,0:11:30.24,0:11:32.30,Default,,0,0,0,,supported on iOS so you can try
Dialogue: 0,0:11:32.62,0:11:33.79,Default,,0,0,0,,-- maintain connections to your
Dialogue: 0,0:11:33.79,0:11:35.14,Default,,0,0,0,,accessories throughout the day
Dialogue: 0,0:11:35.35,0:11:36.69,Default,,0,0,0,,and even across major device
Dialogue: 0,0:11:36.73,0:11:38.16,Default,,0,0,0,,events like a system reboot.
Dialogue: 0,0:11:41.64,0:11:44.17,Default,,0,0,0,,tvOS was supported as of tvOS 9,
Dialogue: 0,0:11:44.17,0:11:46.13,Default,,0,0,0,,and it was interesting for us
Dialogue: 0,0:11:46.13,0:11:47.52,Default,,0,0,0,,because it was the first that we
Dialogue: 0,0:11:47.52,0:11:49.56,Default,,0,0,0,,wanted to support third party
Dialogue: 0,0:11:49.56,0:11:51.35,Default,,0,0,0,,accessories on a platform that
Dialogue: 0,0:11:51.35,0:11:52.78,Default,,0,0,0,,relies on Bluetooth as the main
Dialogue: 0,0:11:52.78,0:11:53.47,Default,,0,0,0,,system input.
Dialogue: 0,0:11:53.47,0:11:54.75,Default,,0,0,0,,So we have to coexist between
Dialogue: 0,0:11:54.75,0:11:56.35,Default,,0,0,0,,those two opportunities or those
Dialogue: 0,0:11:56.35,0:11:57.11,Default,,0,0,0,,two activities.
Dialogue: 0,0:11:58.30,0:11:59.86,Default,,0,0,0,,So in this case we had to put
Dialogue: 0,0:12:00.07,0:12:01.83,Default,,0,0,0,,some restrictions into the
Dialogue: 0,0:12:01.83,0:12:02.84,Default,,0,0,0,,system to make sure that we
Dialogue: 0,0:12:02.84,0:12:04.84,Default,,0,0,0,,don't interfere with core
Dialogue: 0,0:12:04.84,0:12:05.94,Default,,0,0,0,,operating things like the Apple
Dialogue: 0,0:12:05.94,0:12:06.56,Default,,0,0,0,,Siri Remote.
Dialogue: 0,0:12:07.07,0:12:09.93,Default,,0,0,0,,So we decided for accessory or
Dialogue: 0,0:12:09.93,0:12:12.94,Default,,0,0,0,,for tvOS, you can only act as a
Dialogue: 0,0:12:12.94,0:12:16.11,Default,,0,0,0,,Central device, and you can only
Dialogue: 0,0:12:16.11,0:12:18.69,Default,,0,0,0,,connect to two simultaneous
Dialogue: 0,0:12:18.69,0:12:19.23,Default,,0,0,0,,devices.
Dialogue: 0,0:12:20.36,0:12:21.27,Default,,0,0,0,,You can be paired with an
Dialogue: 0,0:12:21.27,0:12:22.91,Default,,0,0,0,,unlimited amount but you can
Dialogue: 0,0:12:22.91,0:12:24.01,Default,,0,0,0,,only use two at a time.
Dialogue: 0,0:12:24.56,0:12:28.99,Default,,0,0,0,,And we don't allow 15 ms
Dialogue: 0,0:12:28.99,0:12:30.65,Default,,0,0,0,,connection intervals on tvOS, we
Dialogue: 0,0:12:30.65,0:12:32.75,Default,,0,0,0,,set the minimum at 30 ms. So
Dialogue: 0,0:12:33.26,0:12:34.94,Default,,0,0,0,,this still allows you to get low
Dialogue: 0,0:12:35.27,0:12:37.38,Default,,0,0,0,,latency for your accessories and
Dialogue: 0,0:12:37.38,0:12:39.29,Default,,0,0,0,,good user interaction but it
Dialogue: 0,0:12:39.29,0:12:40.70,Default,,0,0,0,,leaves more system resources
Dialogue: 0,0:12:40.70,0:12:40.98,Default,,0,0,0,,available.
Dialogue: 0,0:12:44.38,0:12:45.74,Default,,0,0,0,,And when your application is
Dialogue: 0,0:12:46.06,0:12:47.68,Default,,0,0,0,,suspended or moved to the
Dialogue: 0,0:12:47.68,0:12:48.96,Default,,0,0,0,,background, we're going to
Dialogue: 0,0:12:48.96,0:12:50.21,Default,,0,0,0,,automatically disconnect those
Dialogue: 0,0:12:50.21,0:12:50.83,Default,,0,0,0,,accessories.
Dialogue: 0,0:12:54.58,0:12:56.76,Default,,0,0,0,,And similarly, to watch OS, tvOS
Dialogue: 0,0:12:56.76,0:12:58.59,Default,,0,0,0,,is a platform that relies on
Dialogue: 0,0:12:58.59,0:13:00.22,Default,,0,0,0,,Bluetooth for its core system
Dialogue: 0,0:13:00.22,0:13:00.92,Default,,0,0,0,,functionality.
Dialogue: 0,0:13:02.44,0:13:03.97,Default,,0,0,0,,So we are allowing access to
Dialogue: 0,0:13:03.97,0:13:06.04,Default,,0,0,0,,Core Bluetooth whenever the
Dialogue: 0,0:13:06.04,0:13:07.60,Default,,0,0,0,,system allows your application
Dialogue: 0,0:13:07.60,0:13:08.09,Default,,0,0,0,,to be run.
Dialogue: 0,0:13:08.56,0:13:09.65,Default,,0,0,0,,So if a user is in your
Dialogue: 0,0:13:09.65,0:13:11.54,Default,,0,0,0,,application and directly
Dialogue: 0,0:13:11.54,0:13:12.97,Default,,0,0,0,,interacting with it, you can use
Dialogue: 0,0:13:12.97,0:13:13.58,Default,,0,0,0,,Core Bluetooth.
Dialogue: 0,0:13:13.63,0:13:14.29,Default,,0,0,0,,You can connect your
Dialogue: 0,0:13:14.29,0:13:16.05,Default,,0,0,0,,accessories, you can interact
Dialogue: 0,0:13:16.05,0:13:17.98,Default,,0,0,0,,with them, but this also means
Dialogue: 0,0:13:17.98,0:13:18.89,Default,,0,0,0,,that if you're allowed to run
Dialogue: 0,0:13:18.89,0:13:19.96,Default,,0,0,0,,for other reasons, like
Dialogue: 0,0:13:19.96,0:13:21.71,Default,,0,0,0,,complication updates or a
Dialogue: 0,0:13:21.71,0:13:24.08,Default,,0,0,0,,workout session, you can stay
Dialogue: 0,0:13:24.08,0:13:25.17,Default,,0,0,0,,connected to your accessories
Dialogue: 0,0:13:25.17,0:13:26.43,Default,,0,0,0,,and continue getting that data.
Dialogue: 0,0:13:28.67,0:13:31.33,Default,,0,0,0,,Similarly, if the tvOS -- you
Dialogue: 0,0:13:31.33,0:13:32.64,Default,,0,0,0,,can only act as a Central,
Dialogue: 0,0:13:32.70,0:13:33.91,Default,,0,0,0,,meaning that you can connect out
Dialogue: 0,0:13:33.91,0:13:35.99,Default,,0,0,0,,tier accessories but you can't
Dialogue: 0,0:13:35.99,0:13:38.02,Default,,0,0,0,,act as a peripheral to other
Dialogue: 0,0:13:38.02,0:13:38.60,Default,,0,0,0,,devices.
Dialogue: 0,0:13:41.72,0:13:45.08,Default,,0,0,0,,And the same two simultaneous
Dialogue: 0,0:13:45.08,0:13:47.25,Default,,0,0,0,,connection limitation is in
Dialogue: 0,0:13:47.25,0:13:50.63,Default,,0,0,0,,place on watchOS as on tvOS, and
Dialogue: 0,0:13:50.67,0:13:52.09,Default,,0,0,0,,the same connection interval
Dialogue: 0,0:13:52.09,0:13:52.74,Default,,0,0,0,,limitation.
Dialogue: 0,0:13:56.46,0:13:58.38,Default,,0,0,0,,Also, when the system decides
Dialogue: 0,0:13:58.38,0:13:59.66,Default,,0,0,0,,that your application needs to
Dialogue: 0,0:13:59.66,0:14:01.20,Default,,0,0,0,,be suspended, that's the
Dialogue: 0,0:14:01.20,0:14:02.41,Default,,0,0,0,,indication to Core Bluetooth
Dialogue: 0,0:14:02.68,0:14:05.50,Default,,0,0,0,,that the accessories connected
Dialogue: 0,0:14:05.50,0:14:06.94,Default,,0,0,0,,on that application's behalf
Dialogue: 0,0:14:08.00,0:14:08.99,Default,,0,0,0,,should be disconnected.
Dialogue: 0,0:14:12.60,0:14:13.95,Default,,0,0,0,,And this is supported on Apple
Dialogue: 0,0:14:13.95,0:14:14.89,Default,,0,0,0,,Watch Series 2.
Dialogue: 0,0:14:15.99,0:14:18.29,Default,,0,0,0,,As I mentioned, we think this is
Dialogue: 0,0:14:18.29,0:14:20.39,Default,,0,0,0,,a really cool opportunity to see
Dialogue: 0,0:14:20.39,0:14:21.73,Default,,0,0,0,,accessories connected to Apple
Dialogue: 0,0:14:21.73,0:14:24.10,Default,,0,0,0,,Watch and can be used all day.
Dialogue: 0,0:14:24.82,0:14:26.81,Default,,0,0,0,,You can be in places where you
Dialogue: 0,0:14:26.81,0:14:28.00,Default,,0,0,0,,don't want to bring your phone
Dialogue: 0,0:14:28.25,0:14:31.34,Default,,0,0,0,,or places where it's just more
Dialogue: 0,0:14:31.34,0:14:32.50,Default,,0,0,0,,convenient to have data
Dialogue: 0,0:14:32.50,0:14:33.53,Default,,0,0,0,,available on your wrist.
Dialogue: 0,0:14:33.53,0:14:34.86,Default,,0,0,0,,So if you want things like
Dialogue: 0,0:14:34.86,0:14:35.90,Default,,0,0,0,,battery updates throughout the
Dialogue: 0,0:14:35.90,0:14:37.52,Default,,0,0,0,,day, your complication can
Dialogue: 0,0:14:37.52,0:14:38.98,Default,,0,0,0,,connect your accessory, get a
Dialogue: 0,0:14:38.98,0:14:40.62,Default,,0,0,0,,quick bit of data, and always be
Dialogue: 0,0:14:40.62,0:14:41.73,Default,,0,0,0,,up to date on the home screen.
Dialogue: 0,0:14:46.22,0:14:47.47,Default,,0,0,0,,New for this year, we're
Dialogue: 0,0:14:47.47,0:14:48.95,Default,,0,0,0,,allowing access to L2CAP
Dialogue: 0,0:14:49.06,0:14:49.49,Default,,0,0,0,,Channels.
Dialogue: 0,0:14:51.54,0:14:54.40,Default,,0,0,0,,So, an L2CAP channel at the
Dialogue: 0,0:14:54.40,0:14:56.60,Default,,0,0,0,,lowest level is just this stream
Dialogue: 0,0:14:56.60,0:14:59.47,Default,,0,0,0,,of data between two devices, and
Dialogue: 0,0:14:59.47,0:15:01.48,Default,,0,0,0,,it's actually the protocol that
Dialogue: 0,0:15:01.48,0:15:03.27,Default,,0,0,0,,we use under the covers for all
Dialogue: 0,0:15:03.27,0:15:04.35,Default,,0,0,0,,communication between these
Dialogue: 0,0:15:04.35,0:15:04.84,Default,,0,0,0,,devices.
Dialogue: 0,0:15:05.27,0:15:06.71,Default,,0,0,0,,So L2CAP Channels have been used
Dialogue: 0,0:15:06.71,0:15:08.11,Default,,0,0,0,,on the platform.
Dialogue: 0,0:15:08.21,0:15:09.90,Default,,0,0,0,,Since day one of Bluetooth this
Dialogue: 0,0:15:09.90,0:15:10.79,Default,,0,0,0,,is the first time that we're
Dialogue: 0,0:15:10.79,0:15:12.70,Default,,0,0,0,,opening up for your applications
Dialogue: 0,0:15:12.70,0:15:14.02,Default,,0,0,0,,to directly talk over these
Dialogue: 0,0:15:14.02,0:15:14.52,Default,,0,0,0,,channels.
Dialogue: 0,0:15:17.58,0:15:18.94,Default,,0,0,0,,It actually stands for the
Dialogue: 0,0:15:18.94,0:15:20.39,Default,,0,0,0,,Logical Link Control and
Dialogue: 0,0:15:20.39,0:15:23.86,Default,,0,0,0,,Adaptation Protocol, and the
Dialogue: 0,0:15:23.86,0:15:25.23,Default,,0,0,0,,support for dynamically
Dialogue: 0,0:15:25.23,0:15:26.99,Default,,0,0,0,,allocated connection or into
Dialogue: 0,0:15:26.99,0:15:28.87,Default,,0,0,0,,channels is new for Bluetooth
Dialogue: 0,0:15:28.87,0:15:30.64,Default,,0,0,0,,Core Spec 4.1.
Dialogue: 0,0:15:34.43,0:15:35.95,Default,,0,0,0,,So unlike all the other
Dialogue: 0,0:15:35.95,0:15:36.79,Default,,0,0,0,,interactions that you've done
Dialogue: 0,0:15:36.79,0:15:37.89,Default,,0,0,0,,with your accessories before
Dialogue: 0,0:15:37.89,0:15:39.55,Default,,0,0,0,,where you have to work through
Dialogue: 0,0:15:39.55,0:15:41.75,Default,,0,0,0,,the GATT Database to get your
Dialogue: 0,0:15:42.53,0:15:43.95,Default,,0,0,0,,data, L2CAP Channels allow you
Dialogue: 0,0:15:43.95,0:15:45.51,Default,,0,0,0,,to open a side channel and
Dialogue: 0,0:15:45.51,0:15:48.23,Default,,0,0,0,,directly read and write without
Dialogue: 0,0:15:48.59,0:15:50.74,Default,,0,0,0,,any framing limitations, packet
Dialogue: 0,0:15:50.74,0:15:51.83,Default,,0,0,0,,size limitations.
Dialogue: 0,0:15:52.17,0:15:53.38,Default,,0,0,0,,It's a direct way to talk
Dialogue: 0,0:15:53.38,0:15:55.96,Default,,0,0,0,,between your device and your
Dialogue: 0,0:15:55.96,0:15:56.55,Default,,0,0,0,,accessory.
Dialogue: 0,0:16:00.24,0:16:02.23,Default,,0,0,0,,So we think this API is very
Dialogue: 0,0:16:02.55,0:16:03.54,Default,,0,0,0,,simple to use.
Dialogue: 0,0:16:04.03,0:16:05.65,Default,,0,0,0,,If you have already connected to
Dialogue: 0,0:16:05.65,0:16:07.24,Default,,0,0,0,,a peripheral, all you have to do
Dialogue: 0,0:16:07.24,0:16:08.87,Default,,0,0,0,,is call openL2CAPChannel and
Dialogue: 0,0:16:08.87,0:16:11.08,Default,,0,0,0,,specify as the PSM, and you'll
Dialogue: 0,0:16:11.56,0:16:12.84,Default,,0,0,0,,get a callback data
Dialogue: 0,0:16:12.84,0:16:14.67,Default,,0,0,0,,openL2CAPChannel will hand you
Dialogue: 0,0:16:14.67,0:16:15.98,Default,,0,0,0,,back the object that represents
Dialogue: 0,0:16:15.98,0:16:16.44,Default,,0,0,0,,this channel.
Dialogue: 0,0:16:19.09,0:16:21.98,Default,,0,0,0,,So the PSM is a -- it's the
Dialogue: 0,0:16:22.04,0:16:24.95,Default,,0,0,0,,Protocol Service Multiplexer but
Dialogue: 0,0:16:25.33,0:16:26.64,Default,,0,0,0,,you should think of it as
Dialogue: 0,0:16:26.64,0:16:28.51,Default,,0,0,0,,analogous to say TCP port.
Dialogue: 0,0:16:28.89,0:16:30.12,Default,,0,0,0,,It's just a number that you give
Dialogue: 0,0:16:30.12,0:16:32.25,Default,,0,0,0,,to us that uniquely identifies
Dialogue: 0,0:16:32.25,0:16:34.10,Default,,0,0,0,,the service you want to open on
Dialogue: 0,0:16:34.10,0:16:35.13,Default,,0,0,0,,the peripheral side of the
Dialogue: 0,0:16:35.13,0:16:35.62,Default,,0,0,0,,connection.
Dialogue: 0,0:16:37.93,0:16:39.23,Default,,0,0,0,,And what's interesting about
Dialogue: 0,0:16:39.23,0:16:41.20,Default,,0,0,0,,this is that there are some
Dialogue: 0,0:16:41.20,0:16:43.03,Default,,0,0,0,,profiles that are published by
Dialogue: 0,0:16:43.03,0:16:44.69,Default,,0,0,0,,the Bluetooth SIG that have a
Dialogue: 0,0:16:44.69,0:16:45.93,Default,,0,0,0,,hard coded PSM.
Dialogue: 0,0:16:46.14,0:16:48.00,Default,,0,0,0,,So if you're trying to do things
Dialogue: 0,0:16:48.00,0:16:49.07,Default,,0,0,0,,like the Object Transfer
Dialogue: 0,0:16:49.07,0:16:51.29,Default,,0,0,0,,Protocol, the PSM will be known
Dialogue: 0,0:16:51.29,0:16:52.58,Default,,0,0,0,,to you even before you connect
Dialogue: 0,0:16:52.58,0:16:53.25,Default,,0,0,0,,to the device.
Dialogue: 0,0:16:53.62,0:16:56.68,Default,,0,0,0,,But in every other case, the PSM
Dialogue: 0,0:16:56.81,0:16:58.16,Default,,0,0,0,,is unique to the device you're
Dialogue: 0,0:16:58.16,0:16:59.79,Default,,0,0,0,,talking to, which means it's
Dialogue: 0,0:16:59.79,0:17:01.46,Default,,0,0,0,,locally assigned and can even be
Dialogue: 0,0:17:01.46,0:17:03.23,Default,,0,0,0,,reused by other applications.
Dialogue: 0,0:17:04.30,0:17:05.28,Default,,0,0,0,,So it's important that you
Dialogue: 0,0:17:05.28,0:17:07.20,Default,,0,0,0,,discover what PSM to connect to
Dialogue: 0,0:17:07.42,0:17:09.15,Default,,0,0,0,,before you try to open it.
Dialogue: 0,0:17:10.49,0:17:12.13,Default,,0,0,0,,What we've done to make this a
Dialogue: 0,0:17:12.13,0:17:13.94,Default,,0,0,0,,little bit simpler is we're
Dialogue: 0,0:17:13.94,0:17:15.47,Default,,0,0,0,,publishing a UUID that you can
Dialogue: 0,0:17:15.47,0:17:16.99,Default,,0,0,0,,use and put within your service
Dialogue: 0,0:17:18.04,0:17:20.03,Default,,0,0,0,,to help you specify what PSM to
Dialogue: 0,0:17:20.03,0:17:23.49,Default,,0,0,0,,open that's associated with your
Dialogue: 0,0:17:23.49,0:17:24.36,Default,,0,0,0,,CB service.
Dialogue: 0,0:17:27.74,0:17:29.35,Default,,0,0,0,,We're also opening L2CAP
Dialogue: 0,0:17:29.35,0:17:30.73,Default,,0,0,0,,Channels if you're acting as a
Dialogue: 0,0:17:30.73,0:17:31.25,Default,,0,0,0,,peripheral.
Dialogue: 0,0:17:31.73,0:17:34.29,Default,,0,0,0,,So if you want to have a L2CAP
Dialogue: 0,0:17:34.40,0:17:35.54,Default,,0,0,0,,Channel that's associated with
Dialogue: 0,0:17:35.54,0:17:37.29,Default,,0,0,0,,your service, you can call
Dialogue: 0,0:17:37.29,0:17:39.31,Default,,0,0,0,,publishL2CAPChannel and we will
Dialogue: 0,0:17:39.31,0:17:41.77,Default,,0,0,0,,return you what PSM was assigned
Dialogue: 0,0:17:41.77,0:17:43.52,Default,,0,0,0,,by the system in the callback
Dialogue: 0,0:17:43.52,0:17:44.47,Default,,0,0,0,,peripheralManger
Dialogue: 0,0:17:44.47,0:17:46.72,Default,,0,0,0,,didPublishL2CAPChannel.
Dialogue: 0,0:17:48.46,0:17:50.84,Default,,0,0,0,,Another thing we've allowed is
Dialogue: 0,0:17:50.84,0:17:52.55,Default,,0,0,0,,we allow you to specify whether
Dialogue: 0,0:17:52.55,0:17:54.52,Default,,0,0,0,,your L2CAP Channel requires
Dialogue: 0,0:17:54.52,0:17:56.25,Default,,0,0,0,,encryption or not.
Dialogue: 0,0:17:56.39,0:17:58.55,Default,,0,0,0,,So most of the time, the safe
Dialogue: 0,0:17:58.55,0:18:00.04,Default,,0,0,0,,bet is to say yes, I want
Dialogue: 0,0:18:00.04,0:18:00.55,Default,,0,0,0,,encryption.
Dialogue: 0,0:18:00.62,0:18:01.77,Default,,0,0,0,,It protects you from things like
Dialogue: 0,0:18:01.77,0:18:03.28,Default,,0,0,0,,man-in-the-middle attacks, it
Dialogue: 0,0:18:03.28,0:18:04.59,Default,,0,0,0,,protects you from things like
Dialogue: 0,0:18:04.59,0:18:05.70,Default,,0,0,0,,people eavesdropping on the
Dialogue: 0,0:18:05.70,0:18:06.54,Default,,0,0,0,,packets that you're sending
Dialogue: 0,0:18:06.54,0:18:07.65,Default,,0,0,0,,between your two devices.
Dialogue: 0,0:18:08.13,0:18:10.00,Default,,0,0,0,,But there are time when you
Dialogue: 0,0:18:10.00,0:18:11.68,Default,,0,0,0,,might want to build more
Dialogue: 0,0:18:11.68,0:18:12.62,Default,,0,0,0,,advanced types of
Dialogue: 0,0:18:12.62,0:18:14.16,Default,,0,0,0,,authentication, like using
Dialogue: 0,0:18:14.43,0:18:16.49,Default,,0,0,0,,public key cryptography you
Dialogue: 0,0:18:16.49,0:18:17.87,Default,,0,0,0,,could build your own account
Dialogue: 0,0:18:17.87,0:18:20.71,Default,,0,0,0,,system and protect your data
Dialogue: 0,0:18:20.71,0:18:21.08,Default,,0,0,0,,that way.
Dialogue: 0,0:18:24.06,0:18:25.43,Default,,0,0,0,,So let's go through an example
Dialogue: 0,0:18:25.43,0:18:26.49,Default,,0,0,0,,of how you would actually
Dialogue: 0,0:18:26.68,0:18:27.94,Default,,0,0,0,,negotiate an L2CAP Channel
Dialogue: 0,0:18:27.94,0:18:29.03,Default,,0,0,0,,between two devices.
Dialogue: 0,0:18:29.87,0:18:31.10,Default,,0,0,0,,If you're acting as a
Dialogue: 0,0:18:31.10,0:18:34.08,Default,,0,0,0,,peripheral, you would ask the
Dialogue: 0,0:18:34.08,0:18:36.79,Default,,0,0,0,,system to publish an L2CAP
Dialogue: 0,0:18:36.88,0:18:37.20,Default,,0,0,0,,Channel.
Dialogue: 0,0:18:38.26,0:18:39.75,Default,,0,0,0,,Again you get to specify whether
Dialogue: 0,0:18:39.75,0:18:41.07,Default,,0,0,0,,this channel requires encryption
Dialogue: 0,0:18:41.07,0:18:41.54,Default,,0,0,0,,or not.
Dialogue: 0,0:18:41.85,0:18:42.84,Default,,0,0,0,,In this case we're going to say
Dialogue: 0,0:18:42.84,0:18:43.13,Default,,0,0,0,,true.
Dialogue: 0,0:18:43.52,0:18:44.84,Default,,0,0,0,,And when that's successful,
Dialogue: 0,0:18:45.60,0:18:46.39,Default,,0,0,0,,you'll get a callback
Dialogue: 0,0:18:46.39,0:18:47.12,Default,,0,0,0,,peripheralManager
Dialogue: 0,0:18:47.12,0:18:48.75,Default,,0,0,0,,didPublishL2CAPChannel.
Dialogue: 0,0:18:48.75,0:18:50.68,Default,,0,0,0,,And as I mentioned, we'll tell
Dialogue: 0,0:18:50.68,0:18:52.05,Default,,0,0,0,,you what PSM has been locally
Dialogue: 0,0:18:52.05,0:18:53.11,Default,,0,0,0,,assigned for your service.
Dialogue: 0,0:18:54.22,0:18:57.28,Default,,0,0,0,,So this is your opportunity to
Dialogue: 0,0:18:57.28,0:18:59.13,Default,,0,0,0,,make the PSM known to incoming
Dialogue: 0,0:18:59.13,0:19:01.49,Default,,0,0,0,,connections so that they can
Dialogue: 0,0:19:01.49,0:19:03.96,Default,,0,0,0,,discover what channel to open
Dialogue: 0,0:19:03.96,0:19:04.84,Default,,0,0,0,,that's associated with your
Dialogue: 0,0:19:04.84,0:19:05.35,Default,,0,0,0,,service.
Dialogue: 0,0:19:09.70,0:19:11.52,Default,,0,0,0,,As a Central, you can read the
Dialogue: 0,0:19:11.52,0:19:12.96,Default,,0,0,0,,PSM and that's all the
Dialogue: 0,0:19:12.96,0:19:14.18,Default,,0,0,0,,information you need to actually
Dialogue: 0,0:19:14.18,0:19:14.82,Default,,0,0,0,,open that channel.
Dialogue: 0,0:19:14.82,0:19:15.80,Default,,0,0,0,,So now you can call
Dialogue: 0,0:19:15.80,0:19:17.87,Default,,0,0,0,,openL2CAPChannel with the PSM
Dialogue: 0,0:19:17.87,0:19:19.14,Default,,0,0,0,,that you read from the remote
Dialogue: 0,0:19:19.14,0:19:22.92,Default,,0,0,0,,device and you'll get the
Dialogue: 0,0:19:22.92,0:19:25.11,Default,,0,0,0,,callback didOpenL2CAPChannel.
Dialogue: 0,0:19:28.73,0:19:31.95,Default,,0,0,0,,So CB L2CAP Channel encapsulates
Dialogue: 0,0:19:31.95,0:19:33.82,Default,,0,0,0,,all the information you need to
Dialogue: 0,0:19:33.82,0:19:35.79,Default,,0,0,0,,know who you're talking to and
Dialogue: 0,0:19:35.79,0:19:37.29,Default,,0,0,0,,how you can talk to it.
Dialogue: 0,0:19:37.49,0:19:38.47,Default,,0,0,0,,In this case we tell you the
Dialogue: 0,0:19:38.47,0:19:39.54,Default,,0,0,0,,peer, which is either the
Dialogue: 0,0:19:39.54,0:19:40.79,Default,,0,0,0,,central or the peripheral on the
Dialogue: 0,0:19:40.79,0:19:41.88,Default,,0,0,0,,remote side of the connection.
Dialogue: 0,0:19:42.45,0:19:43.84,Default,,0,0,0,,We tell you what PSM was
Dialogue: 0,0:19:43.84,0:19:45.07,Default,,0,0,0,,connected in case you have
Dialogue: 0,0:19:45.07,0:19:47.36,Default,,0,0,0,,multiple services that you've
Dialogue: 0,0:19:47.36,0:19:47.85,Default,,0,0,0,,published.
Dialogue: 0,0:19:47.85,0:19:49.88,Default,,0,0,0,,And then we just give you an
Dialogue: 0,0:19:49.88,0:19:51.16,Default,,0,0,0,,InputStream and OutputStream.
Dialogue: 0,0:19:52.19,0:19:53.63,Default,,0,0,0,,We didn't want to build our own
Dialogue: 0,0:19:53.63,0:19:55.46,Default,,0,0,0,,API and make you have to learn
Dialogue: 0,0:19:55.46,0:19:57.47,Default,,0,0,0,,how to use a new Read Write API.
Dialogue: 0,0:19:58.06,0:19:59.48,Default,,0,0,0,,We didn't want you to have to
Dialogue: 0,0:19:59.61,0:20:00.88,Default,,0,0,0,,adapt your code to deal
Dialogue: 0,0:20:00.88,0:20:02.02,Default,,0,0,0,,specifically with Bluetooth
Dialogue: 0,0:20:02.02,0:20:02.63,Default,,0,0,0,,connections.
Dialogue: 0,0:20:02.96,0:20:04.03,Default,,0,0,0,,If you already know how to deal
Dialogue: 0,0:20:04.03,0:20:05.07,Default,,0,0,0,,with the socket and an
Dialogue: 0,0:20:05.07,0:20:06.24,Default,,0,0,0,,InputStream and OutputStream,
Dialogue: 0,0:20:06.24,0:20:08.28,Default,,0,0,0,,you can deal with an L2CAP
Dialogue: 0,0:20:08.36,0:20:08.63,Default,,0,0,0,,Channel.
Dialogue: 0,0:20:11.13,0:20:13.07,Default,,0,0,0,,So we use all the same stream
Dialogue: 0,0:20:13.07,0:20:14.13,Default,,0,0,0,,events that you would get off
Dialogue: 0,0:20:14.13,0:20:16.15,Default,,0,0,0,,of, say, a socket after you're
Dialogue: 0,0:20:16.15,0:20:18.04,Default,,0,0,0,,connected, and there's bytes
Dialogue: 0,0:20:18.04,0:20:19.07,Default,,0,0,0,,available to be read.
Dialogue: 0,0:20:19.37,0:20:20.25,Default,,0,0,0,,You'll get the callback
Dialogue: 0,0:20:20.25,0:20:21.36,Default,,0,0,0,,hasBytesAvailable.
Dialogue: 0,0:20:22.38,0:20:23.98,Default,,0,0,0,,If you're writing data and you
Dialogue: 0,0:20:23.98,0:20:25.13,Default,,0,0,0,,fill all those queues, you get
Dialogue: 0,0:20:25.13,0:20:26.35,Default,,0,0,0,,the same callback you would on a
Dialogue: 0,0:20:26.35,0:20:28.02,Default,,0,0,0,,socket of hasSpaceAvailable.
Dialogue: 0,0:20:29.24,0:20:30.49,Default,,0,0,0,,We think this is really powerful
Dialogue: 0,0:20:30.49,0:20:31.97,Default,,0,0,0,,because if you already have code
Dialogue: 0,0:20:31.97,0:20:33.16,Default,,0,0,0,,that knows how to talk over
Dialogue: 0,0:20:33.38,0:20:34.92,Default,,0,0,0,,other network interfaces like
Dialogue: 0,0:20:34.92,0:20:35.91,Default,,0,0,0,,Ethernet or Wi-Fi.
Dialogue: 0,0:20:36.36,0:20:37.44,Default,,0,0,0,,That code can be directly
Dialogue: 0,0:20:37.44,0:20:39.05,Default,,0,0,0,,adapted to run on top of L2CAP
Dialogue: 0,0:20:39.17,0:20:39.65,Default,,0,0,0,,Channels.
Dialogue: 0,0:20:41.14,0:20:42.38,Default,,0,0,0,,And when the channel has been
Dialogue: 0,0:20:42.38,0:20:43.64,Default,,0,0,0,,closed, you get the same
Dialogue: 0,0:20:43.64,0:20:44.80,Default,,0,0,0,,endEncountered.Event that you
Dialogue: 0,0:20:44.80,0:20:44.98,Default,,0,0,0,,would get.
Dialogue: 0,0:20:48.31,0:20:49.30,Default,,0,0,0,,So after you've opened your
Dialogue: 0,0:20:49.30,0:20:51.38,Default,,0,0,0,,connection, you can read data to
Dialogue: 0,0:20:51.38,0:20:52.75,Default,,0,0,0,,that connection, you can write
Dialogue: 0,0:20:52.75,0:20:53.15,Default,,0,0,0,,to it.
Dialogue: 0,0:20:53.35,0:20:55.15,Default,,0,0,0,,Eventually when it's closed you
Dialogue: 0,0:20:55.15,0:20:57.81,Default,,0,0,0,,get the endEncounterd.Event, and
Dialogue: 0,0:20:57.90,0:20:59.04,Default,,0,0,0,,it can be closed for a couple of
Dialogue: 0,0:20:59.04,0:20:59.45,Default,,0,0,0,,reasons.
Dialogue: 0,0:20:59.59,0:21:01.59,Default,,0,0,0,,So if the overall Bluetooth link
Dialogue: 0,0:21:01.59,0:21:04.07,Default,,0,0,0,,is lost we'll tell you that the
Dialogue: 0,0:21:04.07,0:21:05.43,Default,,0,0,0,,L2CAP Channel has been closed.
Dialogue: 0,0:21:06.14,0:21:08.15,Default,,0,0,0,,As the Central side, you can
Dialogue: 0,0:21:08.15,0:21:09.65,Default,,0,0,0,,manually ask to close that
Dialogue: 0,0:21:09.65,0:21:10.16,Default,,0,0,0,,connection.
Dialogue: 0,0:21:11.26,0:21:12.58,Default,,0,0,0,,Now on the peripheral side, you
Dialogue: 0,0:21:12.58,0:21:13.70,Default,,0,0,0,,can either un-publish the
Dialogue: 0,0:21:13.70,0:21:18.13,Default,,0,0,0,,service or if you drop the
Dialogue: 0,0:21:18.13,0:21:19.51,Default,,0,0,0,,object and allow it to be
Dialogue: 0,0:21:20.01,0:21:22.36,Default,,0,0,0,,deallocated that's an implicit
Dialogue: 0,0:21:22.36,0:21:23.12,Default,,0,0,0,,sign to us through Core
Dialogue: 0,0:21:23.12,0:21:24.16,Default,,0,0,0,,Bluetooth that you're no longer
Dialogue: 0,0:21:24.16,0:21:24.72,Default,,0,0,0,,interested.
Dialogue: 0,0:21:24.72,0:21:26.33,Default,,0,0,0,,That will also close the L2CAP
Dialogue: 0,0:21:26.33,0:21:26.63,Default,,0,0,0,,Channel.
Dialogue: 0,0:21:33.05,0:21:34.37,Default,,0,0,0,,So when should you use L2CAP
Dialogue: 0,0:21:34.37,0:21:34.72,Default,,0,0,0,,Channels?
Dialogue: 0,0:21:36.34,0:21:38.18,Default,,0,0,0,,In general, if you're already
Dialogue: 0,0:21:38.18,0:21:39.75,Default,,0,0,0,,doing well with GATT and your
Dialogue: 0,0:21:39.75,0:21:41.71,Default,,0,0,0,,data model fits well into a GATT
Dialogue: 0,0:21:41.71,0:21:43.45,Default,,0,0,0,,database, you should continue
Dialogue: 0,0:21:43.45,0:21:44.02,Default,,0,0,0,,using that.
Dialogue: 0,0:21:44.50,0:21:46.05,Default,,0,0,0,,GATT makes it very simple to
Dialogue: 0,0:21:46.05,0:21:47.96,Default,,0,0,0,,discover your data, to get quick
Dialogue: 0,0:21:47.96,0:21:48.58,Default,,0,0,0,,updates.
Dialogue: 0,0:21:48.58,0:21:50.98,Default,,0,0,0,,You don't have to frame any of
Dialogue: 0,0:21:50.98,0:21:51.61,Default,,0,0,0,,your data.
Dialogue: 0,0:21:52.15,0:21:53.51,Default,,0,0,0,,So keep using that if that
Dialogue: 0,0:21:53.51,0:21:54.01,Default,,0,0,0,,worked for you.
Dialogue: 0,0:21:54.99,0:21:56.66,Default,,0,0,0,,But if there are times where it
Dialogue: 0,0:21:56.66,0:21:58.00,Default,,0,0,0,,was previously hard to make your
Dialogue: 0,0:21:58.00,0:22:00.53,Default,,0,0,0,,data fit into the GATT database,
Dialogue: 0,0:22:00.64,0:22:01.98,Default,,0,0,0,,either because you had more data
Dialogue: 0,0:22:01.98,0:22:02.81,Default,,0,0,0,,that you could fit into a
Dialogue: 0,0:22:02.81,0:22:05.27,Default,,0,0,0,,characteristic, or you're
Dialogue: 0,0:22:05.27,0:22:06.40,Default,,0,0,0,,finding that GATT is kind of
Dialogue: 0,0:22:06.40,0:22:07.84,Default,,0,0,0,,getting in the way, L2CAP
Dialogue: 0,0:22:07.94,0:22:09.23,Default,,0,0,0,,Channels are a great opportunity
Dialogue: 0,0:22:09.23,0:22:10.91,Default,,0,0,0,,to get the lowest overhead best
Dialogue: 0,0:22:10.91,0:22:12.55,Default,,0,0,0,,performance when talking between
Dialogue: 0,0:22:12.55,0:22:13.21,Default,,0,0,0,,your accessories.
Dialogue: 0,0:22:14.39,0:22:15.55,Default,,0,0,0,,And if you're doing large data
Dialogue: 0,0:22:15.55,0:22:17.33,Default,,0,0,0,,transfers, say like a firmware
Dialogue: 0,0:22:17.33,0:22:19.23,Default,,0,0,0,,update, L2CAP Channels are a
Dialogue: 0,0:22:19.23,0:22:20.62,Default,,0,0,0,,good opportunity to help you get
Dialogue: 0,0:22:20.62,0:22:21.37,Default,,0,0,0,,it there faster.
Dialogue: 0,0:22:22.62,0:22:24.15,Default,,0,0,0,,And if you have a streaming
Dialogue: 0,0:22:24.15,0:22:25.61,Default,,0,0,0,,protocol that's already defined
Dialogue: 0,0:22:25.61,0:22:26.68,Default,,0,0,0,,somewhere that you want to run
Dialogue: 0,0:22:26.68,0:22:28.52,Default,,0,0,0,,between your two devices, L2CAP
Dialogue: 0,0:22:28.60,0:22:29.54,Default,,0,0,0,,Channels make that a really
Dialogue: 0,0:22:29.54,0:22:29.98,Default,,0,0,0,,natural fit.
Dialogue: 0,0:22:33.55,0:22:34.80,Default,,0,0,0,,I'd like to talk to you about
Dialogue: 0,0:22:34.80,0:22:36.29,Default,,0,0,0,,some of the best practices that
Dialogue: 0,0:22:36.29,0:22:37.39,Default,,0,0,0,,we've learned over the years.
Dialogue: 0,0:22:37.91,0:22:41.26,Default,,0,0,0,,So the first one I have, please
Dialogue: 0,0:22:41.26,0:22:42.52,Default,,0,0,0,,follow the Bluetooth Accessory
Dialogue: 0,0:22:42.52,0:22:43.57,Default,,0,0,0,,Design Guidelines.
Dialogue: 0,0:22:44.26,0:22:45.72,Default,,0,0,0,,We have a great set of
Dialogue: 0,0:22:46.10,0:22:47.80,Default,,0,0,0,,guidelines that are published
Dialogue: 0,0:22:47.80,0:22:50.27,Default,,0,0,0,,that give you lots of data to
Dialogue: 0,0:22:50.27,0:22:51.56,Default,,0,0,0,,help you build the best
Dialogue: 0,0:22:51.56,0:22:52.18,Default,,0,0,0,,accessories.
Dialogue: 0,0:22:52.57,0:22:55.80,Default,,0,0,0,,They're not mandatory but they
Dialogue: 0,0:22:55.80,0:22:56.67,Default,,0,0,0,,are things we've learned over
Dialogue: 0,0:22:56.67,0:22:57.80,Default,,0,0,0,,the year that help you build
Dialogue: 0,0:22:58.08,0:23:00.17,Default,,0,0,0,,accessories without running into
Dialogue: 0,0:23:00.34,0:23:01.95,Default,,0,0,0,,the same pitfalls and problems
Dialogue: 0,0:23:01.95,0:23:03.08,Default,,0,0,0,,that we've seen across the
Dialogue: 0,0:23:03.08,0:23:03.47,Default,,0,0,0,,years.
Dialogue: 0,0:23:06.10,0:23:07.72,Default,,0,0,0,,And if possible, use existing
Dialogue: 0,0:23:07.72,0:23:08.84,Default,,0,0,0,,profiles and services.
Dialogue: 0,0:23:09.52,0:23:11.98,Default,,0,0,0,,We've defined our own protocols
Dialogue: 0,0:23:11.98,0:23:13.23,Default,,0,0,0,,for things like Notification
Dialogue: 0,0:23:13.23,0:23:15.98,Default,,0,0,0,,Center and Apple Media, and the
Dialogue: 0,0:23:15.98,0:23:17.19,Default,,0,0,0,,Bluetooth site has a bunch of
Dialogue: 0,0:23:17.19,0:23:18.47,Default,,0,0,0,,really good profiles for things
Dialogue: 0,0:23:18.47,0:23:20.35,Default,,0,0,0,,like batter updates and device
Dialogue: 0,0:23:20.35,0:23:20.96,Default,,0,0,0,,information.
Dialogue: 0,0:23:21.50,0:23:23.13,Default,,0,0,0,,So if there's already a profile
Dialogue: 0,0:23:23.13,0:23:23.98,Default,,0,0,0,,that does what you need,
Dialogue: 0,0:23:24.51,0:23:25.77,Default,,0,0,0,,implement that and it will help
Dialogue: 0,0:23:25.77,0:23:27.49,Default,,0,0,0,,you get a head start on getting
Dialogue: 0,0:23:27.49,0:23:28.35,Default,,0,0,0,,the data you want.
Dialogue: 0,0:23:31.73,0:23:33.10,Default,,0,0,0,,A common question we get is,
Dialogue: 0,0:23:33.10,0:23:34.22,Default,,0,0,0,,"Why does it take so long to
Dialogue: 0,0:23:34.22,0:23:35.50,Default,,0,0,0,,connect to my accessory?"
Dialogue: 0,0:23:37.63,0:23:39.45,Default,,0,0,0,,So before your two devices are
Dialogue: 0,0:23:39.45,0:23:41.60,Default,,0,0,0,,connected, they're each running
Dialogue: 0,0:23:41.60,0:23:42.61,Default,,0,0,0,,on their own timelines.
Dialogue: 0,0:23:42.86,0:23:43.92,Default,,0,0,0,,Your peripheral is going to be
Dialogue: 0,0:23:43.92,0:23:45.34,Default,,0,0,0,,advertising things to the world,
Dialogue: 0,0:23:46.19,0:23:47.30,Default,,0,0,0,,and your Central is going to be
Dialogue: 0,0:23:47.30,0:23:48.61,Default,,0,0,0,,looking for devices that are
Dialogue: 0,0:23:48.61,0:23:49.11,Default,,0,0,0,,around.
Dialogue: 0,0:23:49.50,0:23:51.60,Default,,0,0,0,,But each one of these uses small
Dialogue: 0,0:23:51.60,0:23:52.89,Default,,0,0,0,,windows, and until those two
Dialogue: 0,0:23:52.89,0:23:54.49,Default,,0,0,0,,events line up you can't
Dialogue: 0,0:23:54.49,0:23:55.55,Default,,0,0,0,,discover your accessory.
Dialogue: 0,0:23:56.09,0:23:58.55,Default,,0,0,0,,So the easiest way you can get a
Dialogue: 0,0:23:58.55,0:23:59.59,Default,,0,0,0,,quick connection between your
Dialogue: 0,0:23:59.59,0:24:01.40,Default,,0,0,0,,two devices or a quick discovery
Dialogue: 0,0:24:01.40,0:24:03.65,Default,,0,0,0,,when you're scanning is to use
Dialogue: 0,0:24:03.65,0:24:04.73,Default,,0,0,0,,the shortest advertising
Dialogue: 0,0:24:04.73,0:24:05.57,Default,,0,0,0,,interval possible.
Dialogue: 0,0:24:06.52,0:24:08.04,Default,,0,0,0,,That ensures that no matter what
Dialogue: 0,0:24:08.04,0:24:09.55,Default,,0,0,0,,state your central is in,
Dialogue: 0,0:24:09.63,0:24:11.38,Default,,0,0,0,,whether it's screen on, screen
Dialogue: 0,0:24:11.38,0:24:12.97,Default,,0,0,0,,off, directly in the app, in the
Dialogue: 0,0:24:12.97,0:24:14.74,Default,,0,0,0,,background, it will get you the
Dialogue: 0,0:24:14.74,0:24:18.65,Default,,0,0,0,,shortest time to find.
Dialogue: 0,0:24:18.65,0:24:19.94,Default,,0,0,0,,Now using a short advertising
Dialogue: 0,0:24:19.94,0:24:22.30,Default,,0,0,0,,interval takes extra battery for
Dialogue: 0,0:24:22.30,0:24:24.43,Default,,0,0,0,,your accessory, so you can't do
Dialogue: 0,0:24:24.43,0:24:26.56,Default,,0,0,0,,that all the time but what we
Dialogue: 0,0:24:26.56,0:24:27.94,Default,,0,0,0,,strongly recommend is if you
Dialogue: 0,0:24:27.94,0:24:30.28,Default,,0,0,0,,know through any means
Dialogue: 0,0:24:30.28,0:24:32.33,Default,,0,0,0,,necessary, through the user
Dialogue: 0,0:24:32.33,0:24:34.03,Default,,0,0,0,,touching the accessory, user
Dialogue: 0,0:24:34.03,0:24:36.11,Default,,0,0,0,,picking it up, accelerometer,
Dialogue: 0,0:24:36.36,0:24:37.59,Default,,0,0,0,,buttons, use that as an
Dialogue: 0,0:24:37.59,0:24:38.75,Default,,0,0,0,,indication to start doing
Dialogue: 0,0:24:38.75,0:24:40.36,Default,,0,0,0,,aggressive advertising and then
Dialogue: 0,0:24:40.36,0:24:41.32,Default,,0,0,0,,you can go into a lower
Dialogue: 0,0:24:41.32,0:24:43.69,Default,,0,0,0,,advertising interval later when
Dialogue: 0,0:24:43.69,0:24:44.69,Default,,0,0,0,,you're trying to save battery.
Dialogue: 0,0:24:47.54,0:24:48.59,Default,,0,0,0,,If you're trying to save
Dialogue: 0,0:24:48.59,0:24:49.71,Default,,0,0,0,,battery, you can go to the
Dialogue: 0,0:24:49.71,0:24:50.92,Default,,0,0,0,,Bluetooth Accessory Design
Dialogue: 0,0:24:50.92,0:24:51.52,Default,,0,0,0,,Guidelines.
Dialogue: 0,0:24:51.52,0:24:55.10,Default,,0,0,0,,We have a whole bunch of power
Dialogue: 0,0:24:55.10,0:24:56.70,Default,,0,0,0,,optimized but also discovery
Dialogue: 0,0:24:56.70,0:24:58.02,Default,,0,0,0,,time optimize advertising
Dialogue: 0,0:24:58.02,0:24:59.04,Default,,0,0,0,,intervals you can use.
Dialogue: 0,0:25:06.06,0:25:07.12,Default,,0,0,0,,Another thing that we see is
Dialogue: 0,0:25:07.12,0:25:09.39,Default,,0,0,0,,that if you've previously used
Dialogue: 0,0:25:09.39,0:25:11.16,Default,,0,0,0,,an accessory and you want to
Dialogue: 0,0:25:11.16,0:25:13.15,Default,,0,0,0,,reconnect to that accessory you
Dialogue: 0,0:25:13.15,0:25:14.53,Default,,0,0,0,,don't have to scan every time.
Dialogue: 0,0:25:14.88,0:25:16.68,Default,,0,0,0,,If you know that the device is
Dialogue: 0,0:25:16.68,0:25:18.31,Default,,0,0,0,,advertising or you just want to
Dialogue: 0,0:25:18.31,0:25:19.59,Default,,0,0,0,,connect as quickly as possible,
Dialogue: 0,0:25:20.11,0:25:21.04,Default,,0,0,0,,connect directly to the
Dialogue: 0,0:25:21.04,0:25:21.59,Default,,0,0,0,,accessory.
Dialogue: 0,0:25:22.96,0:25:24.68,Default,,0,0,0,,If you have the identifier, you
Dialogue: 0,0:25:24.68,0:25:26.45,Default,,0,0,0,,can call retrievePeripherals
Dialogue: 0,0:25:26.45,0:25:28.32,Default,,0,0,0,,(WithIdentifiers) and directly
Dialogue: 0,0:25:28.32,0:25:30.25,Default,,0,0,0,,get a CBPeripheral object that
Dialogue: 0,0:25:30.25,0:25:31.97,Default,,0,0,0,,you can connect to.
Dialogue: 0,0:25:31.97,0:25:33.53,Default,,0,0,0,,If you were to scan for your
Dialogue: 0,0:25:33.53,0:25:35.03,Default,,0,0,0,,accessory and then connect to it
Dialogue: 0,0:25:35.48,0:25:36.53,Default,,0,0,0,,it's actually going to take us
Dialogue: 0,0:25:36.53,0:25:38.24,Default,,0,0,0,,twice as long to do that
Dialogue: 0,0:25:38.24,0:25:39.92,Default,,0,0,0,,operation as if we could have
Dialogue: 0,0:25:39.92,0:25:40.94,Default,,0,0,0,,connected the first time we
Dialogue: 0,0:25:40.94,0:25:41.95,Default,,0,0,0,,found it.
Dialogue: 0,0:25:47.55,0:25:48.80,Default,,0,0,0,,Something we get asked a lot is
Dialogue: 0,0:25:48.80,0:25:50.39,Default,,0,0,0,,why does it take so long to
Dialogue: 0,0:25:50.39,0:25:51.85,Default,,0,0,0,,discover the GATT database after
Dialogue: 0,0:25:51.85,0:25:53.13,Default,,0,0,0,,I've connected to my accessory?
Dialogue: 0,0:25:54.23,0:25:55.14,Default,,0,0,0,,And in this case there's a
Dialogue: 0,0:25:55.14,0:25:56.70,Default,,0,0,0,,couple of things you can do to
Dialogue: 0,0:25:56.70,0:25:58.05,Default,,0,0,0,,speed that up.
Dialogue: 0,0:25:59.00,0:26:00.55,Default,,0,0,0,,The first recommendation we have
Dialogue: 0,0:26:00.88,0:26:02.23,Default,,0,0,0,,is use as few services or
Dialogue: 0,0:26:02.23,0:26:03.74,Default,,0,0,0,,characteristics as possible.
Dialogue: 0,0:26:04.23,0:26:05.51,Default,,0,0,0,,Every time you add a service to
Dialogue: 0,0:26:05.51,0:26:07.15,Default,,0,0,0,,your GATT Database, that takes
Dialogue: 0,0:26:07.15,0:26:08.61,Default,,0,0,0,,extra time over the air that we
Dialogue: 0,0:26:08.61,0:26:10.09,Default,,0,0,0,,have to ask for those services
Dialogue: 0,0:26:10.36,0:26:11.21,Default,,0,0,0,,and discover those.
Dialogue: 0,0:26:11.51,0:26:13.48,Default,,0,0,0,,So by getting rid of services
Dialogue: 0,0:26:13.48,0:26:15.73,Default,,0,0,0,,that you don't need, or packing
Dialogue: 0,0:26:15.73,0:26:16.98,Default,,0,0,0,,multiple characteristics into
Dialogue: 0,0:26:16.98,0:26:18.86,Default,,0,0,0,,one service, that speeds up your
Dialogue: 0,0:26:18.86,0:26:20.13,Default,,0,0,0,,service discovery every time
Dialogue: 0,0:26:20.13,0:26:20.98,Default,,0,0,0,,your user connects to your
Dialogue: 0,0:26:20.98,0:26:21.46,Default,,0,0,0,,accessory.
Dialogue: 0,0:26:25.06,0:26:26.99,Default,,0,0,0,,Another one that's a really
Dialogue: 0,0:26:26.99,0:26:28.34,Default,,0,0,0,,simple thing you can do but that
Dialogue: 0,0:26:28.39,0:26:31.05,Default,,0,0,0,,helps is group your services by
Dialogue: 0,0:26:31.05,0:26:32.03,Default,,0,0,0,,the UUID size.
Dialogue: 0,0:26:33.38,0:26:34.91,Default,,0,0,0,,So if you have multiple 16 bit
Dialogue: 0,0:26:34.91,0:26:37.23,Default,,0,0,0,,UUIDs and then a service with
Dialogue: 0,0:26:37.23,0:26:40.06,Default,,0,0,0,,128 bit UUID we can discover all
Dialogue: 0,0:26:40.06,0:26:42.11,Default,,0,0,0,,the 16 bit services in one
Dialogue: 0,0:26:42.11,0:26:44.84,Default,,0,0,0,,roundtrip instead of having to
Dialogue: 0,0:26:44.84,0:26:45.91,Default,,0,0,0,,go back and forth for every
Dialogue: 0,0:26:45.91,0:26:46.37,Default,,0,0,0,,service.
Dialogue: 0,0:26:50.32,0:26:51.89,Default,,0,0,0,,And then finally to speed up
Dialogue: 0,0:26:51.89,0:26:54.04,Default,,0,0,0,,your service discovery, if we
Dialogue: 0,0:26:54.04,0:26:55.46,Default,,0,0,0,,can cash your GATT database we
Dialogue: 0,0:26:55.46,0:26:56.36,Default,,0,0,0,,actually will, so that on
Dialogue: 0,0:26:56.36,0:26:57.36,Default,,0,0,0,,reconnect we don't have to
Dialogue: 0,0:26:57.36,0:26:58.23,Default,,0,0,0,,discover anything.
Dialogue: 0,0:26:59.12,0:27:00.38,Default,,0,0,0,,If you're in an Accessory that
Dialogue: 0,0:27:00.61,0:27:02.25,Default,,0,0,0,,requires pairing or bonding,
Dialogue: 0,0:27:02.90,0:27:04.27,Default,,0,0,0,,that means that you have to have
Dialogue: 0,0:27:04.27,0:27:05.09,Default,,0,0,0,,the service change
Dialogue: 0,0:27:05.09,0:27:06.70,Default,,0,0,0,,characteristic in your GATT
Dialogue: 0,0:27:06.70,0:27:07.17,Default,,0,0,0,,database.
Dialogue: 0,0:27:07.93,0:27:08.61,Default,,0,0,0,,The Service Change
Dialogue: 0,0:27:08.61,0:27:09.56,Default,,0,0,0,,Characteristic is part of the
Dialogue: 0,0:27:09.56,0:27:11.82,Default,,0,0,0,,Bluetooth Spec that allows you
Dialogue: 0,0:27:11.82,0:27:15.05,Default,,0,0,0,,to tell us when the services and
Dialogue: 0,0:27:15.05,0:27:16.14,Default,,0,0,0,,characteristics on your device
Dialogue: 0,0:27:16.14,0:27:17.55,Default,,0,0,0,,have changed and when it's safe
Dialogue: 0,0:27:17.80,0:27:19.54,Default,,0,0,0,,for us to reuse the last known
Dialogue: 0,0:27:19.54,0:27:20.72,Default,,0,0,0,,version of the GATT Database.
Dialogue: 0,0:27:22.18,0:27:23.75,Default,,0,0,0,,And if you're an Accessory that
Dialogue: 0,0:27:23.75,0:27:25.46,Default,,0,0,0,,does not allow pairing or
Dialogue: 0,0:27:25.46,0:27:27.72,Default,,0,0,0,,bonding, this means that if you
Dialogue: 0,0:27:27.72,0:27:28.71,Default,,0,0,0,,have the Service Changed
Dialogue: 0,0:27:28.71,0:27:30.55,Default,,0,0,0,,characteristic we can't cache
Dialogue: 0,0:27:30.55,0:27:31.46,Default,,0,0,0,,your database anymore.
Dialogue: 0,0:27:32.54,0:27:35.17,Default,,0,0,0,,So in those cases, if you do not
Dialogue: 0,0:27:35.17,0:27:37.05,Default,,0,0,0,,have a Serviced Changed
Dialogue: 0,0:27:37.05,0:27:39.45,Default,,0,0,0,,characteristic, we will cache
Dialogue: 0,0:27:39.83,0:27:41.34,Default,,0,0,0,,your entire service database
Dialogue: 0,0:27:41.34,0:27:42.08,Default,,0,0,0,,which gives you quick
Dialogue: 0,0:27:42.08,0:27:43.23,Default,,0,0,0,,reconnections to your device.
Dialogue: 0,0:27:43.81,0:27:45.00,Default,,0,0,0,,But you have to be careful if
Dialogue: 0,0:27:45.00,0:27:47.01,Default,,0,0,0,,you do not support pairing and
Dialogue: 0,0:27:47.01,0:27:47.80,Default,,0,0,0,,you want to do things like
Dialogue: 0,0:27:47.80,0:27:48.60,Default,,0,0,0,,firmware update.
Dialogue: 0,0:27:48.60,0:27:50.41,Default,,0,0,0,,Even if it's a rare event,
Dialogue: 0,0:27:50.98,0:27:52.31,Default,,0,0,0,,there's no way for you tell us
Dialogue: 0,0:27:52.31,0:27:54.91,Default,,0,0,0,,that the services have changed
Dialogue: 0,0:27:54.91,0:27:55.71,Default,,0,0,0,,on your peripheral.
Dialogue: 0,0:28:01.25,0:28:02.86,Default,,0,0,0,,And then, finally, if you are
Dialogue: 0,0:28:02.86,0:28:05.39,Default,,0,0,0,,building a new accessory we
Dialogue: 0,0:28:05.39,0:28:06.66,Default,,0,0,0,,recommend that you always look
Dialogue: 0,0:28:06.66,0:28:08.57,Default,,0,0,0,,and see the newest chipsets that
Dialogue: 0,0:28:08.57,0:28:10.24,Default,,0,0,0,,are available to you.
Dialogue: 0,0:28:10.34,0:28:11.59,Default,,0,0,0,,Since we came out with Core
Dialogue: 0,0:28:11.59,0:28:13.99,Default,,0,0,0,,Bluetooth, Bluetooth 4.2 and now
Dialogue: 0,0:28:13.99,0:28:15.34,Default,,0,0,0,,5.0 have been released.
Dialogue: 0,0:28:15.83,0:28:17.50,Default,,0,0,0,,All the features in those
Dialogue: 0,0:28:17.50,0:28:18.49,Default,,0,0,0,,releases are backwards
Dialogue: 0,0:28:18.49,0:28:19.06,Default,,0,0,0,,compatible.
Dialogue: 0,0:28:19.06,0:28:20.31,Default,,0,0,0,,So even if you build an
Dialogue: 0,0:28:20.31,0:28:21.93,Default,,0,0,0,,accessory that's Bluetooth 5.0,
Dialogue: 0,0:28:22.13,0:28:23.74,Default,,0,0,0,,it will work with all the Apple
Dialogue: 0,0:28:23.74,0:28:26.29,Default,,0,0,0,,devices that you want to connect
Dialogue: 0,0:28:26.29,0:28:27.96,Default,,0,0,0,,to that are 4.0 only.
Dialogue: 0,0:28:28.49,0:28:31.93,Default,,0,0,0,,And then, like I said, follow
Dialogue: 0,0:28:31.93,0:28:33.42,Default,,0,0,0,,the Accessory Design Guidelines.
Dialogue: 0,0:28:33.83,0:28:35.11,Default,,0,0,0,,If you read through those
Dialogue: 0,0:28:35.11,0:28:36.93,Default,,0,0,0,,upfront it can save you a lot of
Dialogue: 0,0:28:36.93,0:28:38.38,Default,,0,0,0,,hassle later in your project.
Dialogue: 0,0:28:42.68,0:28:44.04,Default,,0,0,0,,Now I'd like to hand it to Duy,
Dialogue: 0,0:28:44.04,0:28:45.67,Default,,0,0,0,,who's going to walk through how
Dialogue: 0,0:28:45.67,0:28:46.76,Default,,0,0,0,,to get the most out of Core
Dialogue: 0,0:28:46.76,0:28:47.17,Default,,0,0,0,,Bluetooth.
Dialogue: 0,0:28:47.47,0:28:48.55,Default,,0,0,0,,>> Thank you, Craig.
Dialogue: 0,0:28:49.52,0:28:54.67,Default,,0,0,0,,[ Applause ]
Dialogue: 0,0:28:55.17,0:28:56.07,Default,,0,0,0,,>> I am Duy.
Dialogue: 0,0:28:56.07,0:28:57.16,Default,,0,0,0,,Today I'll talk about getting
Dialogue: 0,0:28:57.16,0:28:58.18,Default,,0,0,0,,the most out of Core Bluetooth.
Dialogue: 0,0:28:59.30,0:29:00.58,Default,,0,0,0,,Let's walk through a scenario
Dialogue: 0,0:29:00.58,0:29:02.11,Default,,0,0,0,,where we have a lot of data to
Dialogue: 0,0:29:02.11,0:29:03.78,Default,,0,0,0,,send from where updating a
Dialogue: 0,0:29:03.78,0:29:04.34,Default,,0,0,0,,device.
Dialogue: 0,0:29:04.75,0:29:06.43,Default,,0,0,0,,Today it takes about 3,000
Dialogue: 0,0:29:06.43,0:29:08.55,Default,,0,0,0,,seconds to transfer 1MB of data
Dialogue: 0,0:29:08.66,0:29:12.71,Default,,0,0,0,,at about 2.5kbps if we use Write
Dialogue: 0,0:29:12.77,0:29:15.29,Default,,0,0,0,,With Response and all defaults.
Dialogue: 0,0:29:15.57,0:29:17.51,Default,,0,0,0,,So this is obviously very slow.
Dialogue: 0,0:29:17.78,0:29:20.05,Default,,0,0,0,,What are the problems?
Dialogue: 0,0:29:20.05,0:29:21.10,Default,,0,0,0,,There's two main problems.
Dialogue: 0,0:29:21.10,0:29:22.58,Default,,0,0,0,,The first is all of the protocol
Dialogue: 0,0:29:22.58,0:29:23.43,Default,,0,0,0,,overhead in LE.
Dialogue: 0,0:29:24.00,0:29:25.49,Default,,0,0,0,,The Bluetooth Specification
Dialogue: 0,0:29:25.49,0:29:26.82,Default,,0,0,0,,defines the LE maximum
Dialogue: 0,0:29:26.82,0:29:28.79,Default,,0,0,0,,application datalink to be 27
Dialogue: 0,0:29:28.79,0:29:31.35,Default,,0,0,0,,Bytes, but we lose 7 of that
Dialogue: 0,0:29:31.48,0:29:33.33,Default,,0,0,0,,because your data has to
Dialogue: 0,0:29:33.33,0:29:34.68,Default,,0,0,0,,traverse from the application
Dialogue: 0,0:29:34.68,0:29:36.00,Default,,0,0,0,,through GATT, through ATT and
Dialogue: 0,0:29:36.00,0:29:38.29,Default,,0,0,0,,through L2CAP, so you lose about
Dialogue: 0,0:29:38.29,0:29:40.73,Default,,0,0,0,,25% of the packet, and in the
Dialogue: 0,0:29:40.73,0:29:42.28,Default,,0,0,0,,end the useable data length is
Dialogue: 0,0:29:42.28,0:29:43.12,Default,,0,0,0,,only 20 Bytes.
Dialogue: 0,0:29:43.77,0:29:46.54,Default,,0,0,0,,And in addition, once your data
Dialogue: 0,0:29:46.54,0:29:48.27,Default,,0,0,0,,gets through the controller the
Dialogue: 0,0:29:48.68,0:29:50.91,Default,,0,0,0,,hardware also adds link layer
Dialogue: 0,0:29:50.91,0:29:53.22,Default,,0,0,0,,security and CRC which adds even
Dialogue: 0,0:29:53.22,0:29:55.57,Default,,0,0,0,,more time to transmit a packet.
Dialogue: 0,0:29:56.21,0:29:59.41,Default,,0,0,0,,So in order to improve
Dialogue: 0,0:29:59.41,0:30:00.34,Default,,0,0,0,,performance, we'll have to
Dialogue: 0,0:30:00.34,0:30:01.51,Default,,0,0,0,,reduce both the software and
Dialogue: 0,0:30:01.51,0:30:02.79,Default,,0,0,0,,hardware overhead.
Dialogue: 0,0:30:03.56,0:30:05.70,Default,,0,0,0,,The second problem is previously
Dialogue: 0,0:30:05.70,0:30:08.45,Default,,0,0,0,,in GATT the only way to reliably
Dialogue: 0,0:30:08.45,0:30:10.01,Default,,0,0,0,,write is to use Write With
Dialogue: 0,0:30:10.01,0:30:11.92,Default,,0,0,0,,Response which take two
Dialogue: 0,0:30:11.92,0:30:14.11,Default,,0,0,0,,intervals to complete, one to
Dialogue: 0,0:30:14.11,0:30:15.35,Default,,0,0,0,,write and one to wait for the
Dialogue: 0,0:30:15.35,0:30:15.97,Default,,0,0,0,,response.
Dialogue: 0,0:30:16.32,0:30:17.83,Default,,0,0,0,,So your writes are actually very
Dialogue: 0,0:30:17.83,0:30:18.39,Default,,0,0,0,,sparse.
Dialogue: 0,0:30:18.39,0:30:19.91,Default,,0,0,0,,You're not fully utilizing the
Dialogue: 0,0:30:19.91,0:30:22.92,Default,,0,0,0,,available bandwidth because, as
Dialogue: 0,0:30:22.92,0:30:24.38,Default,,0,0,0,,you know, there's multiple
Dialogue: 0,0:30:24.38,0:30:26.16,Default,,0,0,0,,opportunities to transmit per
Dialogue: 0,0:30:26.16,0:30:28.14,Default,,0,0,0,,interval and we want to pack as
Dialogue: 0,0:30:28.14,0:30:30.63,Default,,0,0,0,,many writes as we can into all
Dialogue: 0,0:30:30.63,0:30:31.70,Default,,0,0,0,,of the connection events.
Dialogue: 0,0:30:32.08,0:30:33.13,Default,,0,0,0,,So how do we do this?
Dialogue: 0,0:30:33.71,0:30:36.45,Default,,0,0,0,,As Craig mentioned, we've
Dialogue: 0,0:30:36.45,0:30:37.96,Default,,0,0,0,,improved Write Without Response.
Dialogue: 0,0:30:38.29,0:30:39.77,Default,,0,0,0,,You can now write and continue
Dialogue: 0,0:30:39.77,0:30:41.19,Default,,0,0,0,,to write into Core Bluetooth
Dialogue: 0,0:30:41.19,0:30:42.49,Default,,0,0,0,,sets can send holds write
Dialogue: 0,0:30:43.23,0:30:45.85,Default,,0,0,0,,without response to false, in
Dialogue: 0,0:30:45.85,0:30:47.45,Default,,0,0,0,,which case then your application
Dialogue: 0,0:30:47.45,0:30:48.89,Default,,0,0,0,,can wait for a delegate to
Dialogue: 0,0:30:48.89,0:30:50.22,Default,,0,0,0,,signal when it's safe to resume
Dialogue: 0,0:30:50.22,0:30:50.57,Default,,0,0,0,,writing.
Dialogue: 0,0:30:51.08,0:30:52.38,Default,,0,0,0,,And when you follow the APIs the
Dialogue: 0,0:30:52.38,0:30:53.65,Default,,0,0,0,,write will be reliable.
Dialogue: 0,0:30:54.36,0:30:55.95,Default,,0,0,0,,And you can use the Write
Dialogue: 0,0:30:55.95,0:30:57.77,Default,,0,0,0,,Without Response to make sure
Dialogue: 0,0:30:57.77,0:30:58.81,Default,,0,0,0,,that Core Bluetooth is
Dialogue: 0,0:30:58.81,0:31:01.26,Default,,0,0,0,,sufficiently buffered so we can
Dialogue: 0,0:31:01.26,0:31:02.30,Default,,0,0,0,,use all of the available
Dialogue: 0,0:31:02.30,0:31:03.79,Default,,0,0,0,,connection events to send all of
Dialogue: 0,0:31:03.79,0:31:04.82,Default,,0,0,0,,your application data.
Dialogue: 0,0:31:06.02,0:31:09.80,Default,,0,0,0,,And in iOS 10, we also enlarged
Dialogue: 0,0:31:09.80,0:31:11.72,Default,,0,0,0,,the Connection Event Length so
Dialogue: 0,0:31:11.72,0:31:13.21,Default,,0,0,0,,now you have even more room to
Dialogue: 0,0:31:13.21,0:31:14.73,Default,,0,0,0,,write using Write For That
Dialogue: 0,0:31:14.73,0:31:15.21,Default,,0,0,0,,Response.
Dialogue: 0,0:31:17.10,0:31:18.63,Default,,0,0,0,,And when you pack all of the
Dialogue: 0,0:31:18.63,0:31:19.79,Default,,0,0,0,,connection events in all of the
Dialogue: 0,0:31:19.79,0:31:21.62,Default,,0,0,0,,interval, your throughput will
Dialogue: 0,0:31:21.62,0:31:24.12,Default,,0,0,0,,improve from 2.5 to 37 kbps.
Dialogue: 0,0:31:24.66,0:31:27.41,Default,,0,0,0,,And coming back to reducing
Dialogue: 0,0:31:27.41,0:31:31.51,Default,,0,0,0,,software protocol overhead, all
Dialogue: 0,0:31:31.51,0:31:32.72,Default,,0,0,0,,of the discussion thus far
Dialogue: 0,0:31:32.72,0:31:34.98,Default,,0,0,0,,assumes an ATT MTU of 23 Bytes,
Dialogue: 0,0:31:35.33,0:31:37.28,Default,,0,0,0,,this is why there are red
Dialogue: 0,0:31:37.28,0:31:38.96,Default,,0,0,0,,portion overhead in each viewer
Dialogue: 0,0:31:38.96,0:31:41.93,Default,,0,0,0,,packets but we can enlarge the
Dialogue: 0,0:31:41.93,0:31:44.15,Default,,0,0,0,,MTU and enlarge the writes to
Dialogue: 0,0:31:44.15,0:31:45.35,Default,,0,0,0,,align to the MTU.
Dialogue: 0,0:31:45.94,0:31:47.43,Default,,0,0,0,,This will improve your
Dialogue: 0,0:31:47.43,0:31:49.02,Default,,0,0,0,,throughput because L2CAP will
Dialogue: 0,0:31:49.02,0:31:50.40,Default,,0,0,0,,now fragment your data for you.
Dialogue: 0,0:31:50.90,0:31:53.11,Default,,0,0,0,,You only have to pay in overhead
Dialogue: 0,0:31:53.15,0:31:54.40,Default,,0,0,0,,on the first fragment of your
Dialogue: 0,0:31:54.43,0:31:54.85,Default,,0,0,0,,MTU.
Dialogue: 0,0:31:55.27,0:31:58.31,Default,,0,0,0,,The rest of the fragments can be
Dialogue: 0,0:31:58.31,0:32:00.94,Default,,0,0,0,,as the full 27 Bytes, so when
Dialogue: 0,0:32:00.94,0:32:02.27,Default,,0,0,0,,you do this your throughput
Dialogue: 0,0:32:02.27,0:32:04.32,Default,,0,0,0,,should improve to 48 kbps.
Dialogue: 0,0:32:05.09,0:32:08.94,Default,,0,0,0,,And so how do you configure MTU
Dialogue: 0,0:32:09.74,0:32:12.45,Default,,0,0,0,,in Core Bluetooth?
Dialogue: 0,0:32:12.45,0:32:13.84,Default,,0,0,0,,If you're running Core Bluetooth
Dialogue: 0,0:32:13.84,0:32:15.20,Default,,0,0,0,,to Core Bluetooth, there's
Dialogue: 0,0:32:15.20,0:32:16.17,Default,,0,0,0,,nothing much you have to do.
Dialogue: 0,0:32:16.17,0:32:18.57,Default,,0,0,0,,We will calculate the MTU for
Dialogue: 0,0:32:18.57,0:32:19.89,Default,,0,0,0,,you based on the connection
Dialogue: 0,0:32:19.89,0:32:21.29,Default,,0,0,0,,event length and other system
Dialogue: 0,0:32:21.29,0:32:23.86,Default,,0,0,0,,configurations but in this
Dialogue: 0,0:32:23.86,0:32:25.67,Default,,0,0,0,,example we're from we're
Dialogue: 0,0:32:25.67,0:32:26.78,Default,,0,0,0,,updating an accessory.
Dialogue: 0,0:32:27.26,0:32:30.00,Default,,0,0,0,,So if you recall the ATT MTU
Dialogue: 0,0:32:30.00,0:32:31.46,Default,,0,0,0,,exchange as a transaction
Dialogue: 0,0:32:31.46,0:32:32.73,Default,,0,0,0,,between the client and the
Dialogue: 0,0:32:32.73,0:32:35.92,Default,,0,0,0,,server, so the two minimum of
Dialogue: 0,0:32:35.92,0:32:37.26,Default,,0,0,0,,the -- the minimum of the two
Dialogue: 0,0:32:37.26,0:32:38.67,Default,,0,0,0,,proposed value is actually the
Dialogue: 0,0:32:38.67,0:32:40.76,Default,,0,0,0,,ATT MTU, so your accessory
Dialogue: 0,0:32:40.76,0:32:42.82,Default,,0,0,0,,should also use a large MTU to
Dialogue: 0,0:32:42.82,0:32:44.68,Default,,0,0,0,,take advantage of this more
Dialogue: 0,0:32:44.68,0:32:47.33,Default,,0,0,0,,optimized behavior.
Dialogue: 0,0:32:47.56,0:32:49.58,Default,,0,0,0,,And to use a large MTU that's
Dialogue: 0,0:32:49.58,0:32:51.51,Default,,0,0,0,,aligned to the -- to use a
Dialogue: 0,0:32:51.51,0:32:53.19,Default,,0,0,0,,larger attribute write that is
Dialogue: 0,0:32:53.19,0:32:55.46,Default,,0,0,0,,aligned to the MTU, you can use
Dialogue: 0,0:32:55.46,0:32:58.75,Default,,0,0,0,,the below interfaces to look at
Dialogue: 0,0:32:58.75,0:33:00.90,Default,,0,0,0,,what is the maximum write length
Dialogue: 0,0:33:01.05,0:33:01.98,Default,,0,0,0,,aligned to the MTU.
Dialogue: 0,0:33:05.90,0:33:08.37,Default,,0,0,0,,So thus far we've talked about
Dialogue: 0,0:33:08.37,0:33:11.52,Default,,0,0,0,,how to pack as much writes as we
Dialogue: 0,0:33:11.52,0:33:13.31,Default,,0,0,0,,can into the intervals and how
Dialogue: 0,0:33:13.31,0:33:16.23,Default,,0,0,0,,to utilize -- fully utilize all
Dialogue: 0,0:33:16.23,0:33:17.43,Default,,0,0,0,,of the bandwidth available.
Dialogue: 0,0:33:17.72,0:33:20.36,Default,,0,0,0,,We talked about how to reduce
Dialogue: 0,0:33:20.36,0:33:21.80,Default,,0,0,0,,overhead, software overhead.
Dialogue: 0,0:33:22.34,0:33:27.47,Default,,0,0,0,,But the fact that LE is 27 Bytes
Dialogue: 0,0:33:27.54,0:33:29.75,Default,,0,0,0,,per packet and we have to pay
Dialogue: 0,0:33:29.75,0:33:30.88,Default,,0,0,0,,the hardware overhead per
Dialogue: 0,0:33:30.88,0:33:33.22,Default,,0,0,0,,packet, this really limits how
Dialogue: 0,0:33:33.22,0:33:35.31,Default,,0,0,0,,much further we can improve LE
Dialogue: 0,0:33:35.31,0:33:37.83,Default,,0,0,0,,performance using just software.
Dialogue: 0,0:33:39.08,0:33:40.82,Default,,0,0,0,,So we've added extended data
Dialogue: 0,0:33:40.82,0:33:41.41,Default,,0,0,0,,length support.
Dialogue: 0,0:33:42.25,0:33:44.34,Default,,0,0,0,,Extended data length is a 4.2
Dialogue: 0,0:33:44.34,0:33:46.11,Default,,0,0,0,,feature that increases the
Dialogue: 0,0:33:46.11,0:33:48.96,Default,,0,0,0,,maximum application data length
Dialogue: 0,0:33:48.96,0:33:50.89,Default,,0,0,0,,from 27 to 251.
Dialogue: 0,0:33:52.50,0:33:55.05,Default,,0,0,0,,This means that per packet now
Dialogue: 0,0:33:55.05,0:33:56.42,Default,,0,0,0,,you can send 10 times the amount
Dialogue: 0,0:33:56.42,0:33:58.54,Default,,0,0,0,,of data so you've eliminated all
Dialogue: 0,0:33:58.54,0:33:59.60,Default,,0,0,0,,of the hardware overhead and
Dialogue: 0,0:33:59.60,0:34:02.82,Default,,0,0,0,,software overhead previously and
Dialogue: 0,0:34:03.85,0:34:05.55,Default,,0,0,0,,we can now use more of the
Dialogue: 0,0:34:05.55,0:34:07.24,Default,,0,0,0,,available time to transmit your
Dialogue: 0,0:34:07.24,0:34:07.96,Default,,0,0,0,,application data.
Dialogue: 0,0:34:09.11,0:34:12.70,Default,,0,0,0,,And in fact, we can send a full
Dialogue: 0,0:34:12.70,0:34:16.44,Default,,0,0,0,,-- an entire maximum GATTs write
Dialogue: 0,0:34:16.44,0:34:18.10,Default,,0,0,0,,of 512 Bytes in a single
Dialogue: 0,0:34:18.10,0:34:20.61,Default,,0,0,0,,interval using Extended Data
Dialogue: 0,0:34:20.61,0:34:22.40,Default,,0,0,0,,Length, and this should be about
Dialogue: 0,0:34:22.40,0:34:23.88,Default,,0,0,0,,3 times the throughput of your
Dialogue: 0,0:34:23.88,0:34:24.93,Default,,0,0,0,,normal performance.
Dialogue: 0,0:34:26.52,0:34:32.04,Default,,0,0,0,,[ Applause ]
Dialogue: 0,0:34:32.54,0:34:33.99,Default,,0,0,0,,Extended Data Length is the new
Dialogue: 0,0:34:33.99,0:34:35.45,Default,,0,0,0,,feature in Bluetooth 4.2.
Dialogue: 0,0:34:35.87,0:34:37.00,Default,,0,0,0,,It extends the maximum
Dialogue: 0,0:34:37.00,0:34:38.77,Default,,0,0,0,,application data length from 27
Dialogue: 0,0:34:38.77,0:34:40.45,Default,,0,0,0,,to 251.
Dialogue: 0,0:34:40.45,0:34:42.12,Default,,0,0,0,,It's completely transparent to
Dialogue: 0,0:34:42.12,0:34:42.85,Default,,0,0,0,,your application.
Dialogue: 0,0:34:42.97,0:34:44.40,Default,,0,0,0,,If you're running Core Bluetooth
Dialogue: 0,0:34:44.40,0:34:46.42,Default,,0,0,0,,to Core Bluetooth we've done
Dialogue: 0,0:34:46.42,0:34:47.07,Default,,0,0,0,,everything for you.
Dialogue: 0,0:34:47.07,0:34:48.68,Default,,0,0,0,,We'll negotiate the write data
Dialogue: 0,0:34:48.68,0:34:50.50,Default,,0,0,0,,length and MTU appropriate to
Dialogue: 0,0:34:50.50,0:34:52.59,Default,,0,0,0,,your hardware configuration, but
Dialogue: 0,0:34:52.59,0:34:54.31,Default,,0,0,0,,in this example again we're
Dialogue: 0,0:34:54.31,0:34:57.19,Default,,0,0,0,,updating a firmware device so
Dialogue: 0,0:34:57.19,0:34:58.65,Default,,0,0,0,,remember you have to also add
Dialogue: 0,0:34:58.65,0:35:00.71,Default,,0,0,0,,support for extended data length
Dialogue: 0,0:35:00.71,0:35:02.06,Default,,0,0,0,,in the accessory for this to
Dialogue: 0,0:35:02.06,0:35:02.35,Default,,0,0,0,,work.
Dialogue: 0,0:35:03.23,0:35:05.79,Default,,0,0,0,,And it has four times the
Dialogue: 0,0:35:05.79,0:35:07.13,Default,,0,0,0,,throughput in the same amount of
Dialogue: 0,0:35:07.13,0:35:08.86,Default,,0,0,0,,radio time so it's also very
Dialogue: 0,0:35:08.86,0:35:09.63,Default,,0,0,0,,power efficient.
Dialogue: 0,0:35:09.97,0:35:12.45,Default,,0,0,0,,It's now available on iPhone 7
Dialogue: 0,0:35:12.45,0:35:14.27,Default,,0,0,0,,and Apple Watch Series 2, and
Dialogue: 0,0:35:14.27,0:35:16.62,Default,,0,0,0,,the newly announced iPad Pro.
Dialogue: 0,0:35:17.01,0:35:19.35,Default,,0,0,0,,So please try it out and use
Dialogue: 0,0:35:19.35,0:35:20.83,Default,,0,0,0,,this as a reference to develop
Dialogue: 0,0:35:20.83,0:35:22.61,Default,,0,0,0,,your new Extended Data Length
Dialogue: 0,0:35:22.61,0:35:23.28,Default,,0,0,0,,Accessory.
Dialogue: 0,0:35:24.52,0:35:29.82,Default,,0,0,0,,[ Applause ]
Dialogue: 0,0:35:30.32,0:35:34.02,Default,,0,0,0,,And because we're -- the example
Dialogue: 0,0:35:34.02,0:35:35.41,Default,,0,0,0,,is from we're updating a device,
Dialogue: 0,0:35:35.76,0:35:38.25,Default,,0,0,0,,this is a good example of where
Dialogue: 0,0:35:38.25,0:35:39.63,Default,,0,0,0,,you should use L2CAP Connection
Dialogue: 0,0:35:39.63,0:35:40.46,Default,,0,0,0,,Oriented Channel.
Dialogue: 0,0:35:40.99,0:35:42.58,Default,,0,0,0,,This will eliminate all of the
Dialogue: 0,0:35:42.58,0:35:45.05,Default,,0,0,0,,overhead previously in GATT and
Dialogue: 0,0:35:45.05,0:35:47.04,Default,,0,0,0,,ATTs, but more importantly it
Dialogue: 0,0:35:47.04,0:35:49.50,Default,,0,0,0,,eliminates limitations and
Dialogue: 0,0:35:49.50,0:35:50.74,Default,,0,0,0,,restriction in GATT like the
Dialogue: 0,0:35:50.74,0:35:53.70,Default,,0,0,0,,maximum attribute size of 512,
Dialogue: 0,0:35:54.14,0:35:57.11,Default,,0,0,0,,so we can now write much larger
Dialogue: 0,0:35:57.11,0:35:58.99,Default,,0,0,0,,values and use much larger MTU.
Dialogue: 0,0:35:59.64,0:36:01.15,Default,,0,0,0,,When we do that the throughput
Dialogue: 0,0:36:01.15,0:36:03.52,Default,,0,0,0,,will increase to almost 200
Dialogue: 0,0:36:04.37,0:36:04.83,Default,,0,0,0,,kbps.
Dialogue: 0,0:36:05.65,0:36:08.42,Default,,0,0,0,,This really shows how powerful
Dialogue: 0,0:36:08.49,0:36:10.46,Default,,0,0,0,,Extended Data Length can be if
Dialogue: 0,0:36:10.46,0:36:12.06,Default,,0,0,0,,it is not limited by software
Dialogue: 0,0:36:12.06,0:36:12.54,Default,,0,0,0,,protocol.
Dialogue: 0,0:36:15.62,0:36:17.09,Default,,0,0,0,,As you know, another way to
Dialogue: 0,0:36:17.09,0:36:19.54,Default,,0,0,0,,improve performance is to ask
Dialogue: 0,0:36:19.54,0:36:20.48,Default,,0,0,0,,for a faster connection
Dialogue: 0,0:36:20.48,0:36:21.05,Default,,0,0,0,,interval.
Dialogue: 0,0:36:21.40,0:36:23.94,Default,,0,0,0,,All of the discussion thus far
Dialogue: 0,0:36:23.94,0:36:26.63,Default,,0,0,0,,assumes a connection interval of
Dialogue: 0,0:36:26.63,0:36:28.99,Default,,0,0,0,,30 ms, but in Core Bluetooth we
Dialogue: 0,0:36:28.99,0:36:30.41,Default,,0,0,0,,made a change to lower the
Dialogue: 0,0:36:30.41,0:36:32.03,Default,,0,0,0,,connection interval minimum for
Dialogue: 0,0:36:32.03,0:36:35.63,Default,,0,0,0,,iOS to 15 ms, so when your
Dialogue: 0,0:36:35.63,0:36:36.83,Default,,0,0,0,,firmware is updating your device
Dialogue: 0,0:36:36.83,0:36:38.40,Default,,0,0,0,,you can ask for a parameter
Dialogue: 0,0:36:38.68,0:36:40.82,Default,,0,0,0,,update request and set the
Dialogue: 0,0:36:40.82,0:36:43.54,Default,,0,0,0,,interval min and max to 15 ms in
Dialogue: 0,0:36:43.85,0:36:44.73,Default,,0,0,0,,which we will honor.
Dialogue: 0,0:36:45.62,0:36:47.05,Default,,0,0,0,,And when you do that, your
Dialogue: 0,0:36:47.05,0:36:50.48,Default,,0,0,0,,throughput can double to 394,
Dialogue: 0,0:36:50.48,0:36:52.91,Default,,0,0,0,,almost 400 kbps.
Dialogue: 0,0:36:53.52,0:36:57.74,Default,,0,0,0,,[ Applause ]
Dialogue: 0,0:36:58.24,0:37:00.31,Default,,0,0,0,,So this is a summary of where we
Dialogue: 0,0:37:00.31,0:37:01.75,Default,,0,0,0,,were and where we are now.
Dialogue: 0,0:37:02.12,0:37:04.36,Default,,0,0,0,,We started with Write With
Dialogue: 0,0:37:04.36,0:37:06.48,Default,,0,0,0,,Response at 2.5 kbps.
Dialogue: 0,0:37:07.71,0:37:09.68,Default,,0,0,0,,Then we did Write Without
Dialogue: 0,0:37:09.68,0:37:11.65,Default,,0,0,0,,Response but writing only once
Dialogue: 0,0:37:11.69,0:37:14.60,Default,,0,0,0,,per interval, which only doubles
Dialogue: 0,0:37:14.60,0:37:15.28,Default,,0,0,0,,the performance.
Dialogue: 0,0:37:16.01,0:37:17.99,Default,,0,0,0,,But if you packed all of the
Dialogue: 0,0:37:17.99,0:37:19.79,Default,,0,0,0,,opportunities to transmit with
Dialogue: 0,0:37:20.53,0:37:21.76,Default,,0,0,0,,writes your throughput can
Dialogue: 0,0:37:21.76,0:37:23.00,Default,,0,0,0,,improve to 37.
Dialogue: 0,0:37:23.00,0:37:25.50,Default,,0,0,0,,And if you reduce overhead using
Dialogue: 0,0:37:25.50,0:37:28.24,Default,,0,0,0,,larger MTU, your performance can
Dialogue: 0,0:37:28.24,0:37:29.73,Default,,0,0,0,,go up to 48 kbps.
Dialogue: 0,0:37:30.39,0:37:31.99,Default,,0,0,0,,And we made a major leap forward
Dialogue: 0,0:37:31.99,0:37:33.34,Default,,0,0,0,,with Extended Data Length and
Dialogue: 0,0:37:33.60,0:37:36.91,Default,,0,0,0,,tripled that which will yield
Dialogue: 0,0:37:36.91,0:37:38.45,Default,,0,0,0,,135 kbps.
Dialogue: 0,0:37:39.20,0:37:40.97,Default,,0,0,0,,And if we eliminate the software
Dialogue: 0,0:37:41.02,0:37:43.08,Default,,0,0,0,,limitations using L2CAP plus
Dialogue: 0,0:37:43.08,0:37:44.94,Default,,0,0,0,,Extended Data Length, it can
Dialogue: 0,0:37:44.94,0:37:47.44,Default,,0,0,0,,improve to almost 200 kbps.
Dialogue: 0,0:37:48.72,0:37:51.81,Default,,0,0,0,,And we increase the -- made the
Dialogue: 0,0:37:51.81,0:37:53.77,Default,,0,0,0,,connection interval faster which
Dialogue: 0,0:37:53.77,0:37:55.36,Default,,0,0,0,,allows you to transmit more
Dialogue: 0,0:37:55.36,0:37:57.82,Default,,0,0,0,,often, then the throughput will
Dialogue: 0,0:37:57.82,0:37:59.59,Default,,0,0,0,,improve to 400 kbps.
Dialogue: 0,0:37:59.96,0:38:02.40,Default,,0,0,0,,So we started with about 3,000
Dialogue: 0,0:38:02.51,0:38:04.21,Default,,0,0,0,,seconds to download 1 MB of data
Dialogue: 0,0:38:04.21,0:38:06.58,Default,,0,0,0,,and we end it with 20 seconds to
Dialogue: 0,0:38:06.58,0:38:07.67,Default,,0,0,0,,download 1 MB of data.
Dialogue: 0,0:38:08.52,0:38:12.80,Default,,0,0,0,,[ Applause ]
Dialogue: 0,0:38:13.30,0:38:14.95,Default,,0,0,0,,So in summary, please request a
Dialogue: 0,0:38:14.95,0:38:16.62,Default,,0,0,0,,shorter connection interval.
Dialogue: 0,0:38:16.89,0:38:20.23,Default,,0,0,0,,The new minimum is 15 MS on iOS
Dialogue: 0,0:38:20.23,0:38:20.76,Default,,0,0,0,,if you need it.
Dialogue: 0,0:38:21.35,0:38:23.07,Default,,0,0,0,,Take advantage of all the GATT
Dialogue: 0,0:38:23.07,0:38:24.69,Default,,0,0,0,,optimizations we have like Write
Dialogue: 0,0:38:24.69,0:38:26.23,Default,,0,0,0,,Without Response.
Dialogue: 0,0:38:26.23,0:38:27.71,Default,,0,0,0,,Use L2CAP Channel for larger
Dialogue: 0,0:38:27.71,0:38:28.29,Default,,0,0,0,,transfer.
Dialogue: 0,0:38:28.94,0:38:30.83,Default,,0,0,0,,All of this is free and all in
Dialogue: 0,0:38:30.83,0:38:33.81,Default,,0,0,0,,software, and also update your
Dialogue: 0,0:38:33.81,0:38:34.84,Default,,0,0,0,,hardware with the latest
Dialogue: 0,0:38:34.84,0:38:36.75,Default,,0,0,0,,specification of Bluetooth
Dialogue: 0,0:38:36.75,0:38:38.75,Default,,0,0,0,,Specification and Hardware for
Dialogue: 0,0:38:38.75,0:38:40.21,Default,,0,0,0,,best performance and best
Dialogue: 0,0:38:40.21,0:38:40.82,Default,,0,0,0,,battery life.
Dialogue: 0,0:38:41.65,0:38:41.98,Default,,0,0,0,,Thank you.
Dialogue: 0,0:38:42.52,0:38:49.46,Default,,0,0,0,,[ Applause ]
Dialogue: 0,0:38:49.96,0:38:52.94,Default,,0,0,0,,>> Thank you, Duy.
Dialogue: 0,0:38:53.07,0:38:54.07,Default,,0,0,0,,So we've talked about a lot of
Dialogue: 0,0:38:54.07,0:38:55.12,Default,,0,0,0,,really exciting stuff here.
Dialogue: 0,0:38:55.51,0:38:59.01,Default,,0,0,0,,There's a lot to go over, but if
Dialogue: 0,0:38:59.01,0:39:00.16,Default,,0,0,0,,you're the type of Application
Dialogue: 0,0:39:00.16,0:39:01.22,Default,,0,0,0,,that wants to be connected
Dialogue: 0,0:39:01.22,0:39:02.81,Default,,0,0,0,,throughout the day, look into
Dialogue: 0,0:39:02.81,0:39:04.43,Default,,0,0,0,,the new optimizations we've put
Dialogue: 0,0:39:04.43,0:39:05.52,Default,,0,0,0,,in for State Restoration.
Dialogue: 0,0:39:05.62,0:39:07.01,Default,,0,0,0,,Try to build more reliable
Dialogue: 0,0:39:07.01,0:39:08.47,Default,,0,0,0,,experiences for your customers.
Dialogue: 0,0:39:09.39,0:39:11.06,Default,,0,0,0,,If it makes sense, you can now
Dialogue: 0,0:39:11.06,0:39:12.59,Default,,0,0,0,,take your existing applications
Dialogue: 0,0:39:12.94,0:39:13.91,Default,,0,0,0,,and make them available to
Dialogue: 0,0:39:13.91,0:39:15.74,Default,,0,0,0,,people on tvOS and watchOS.
Dialogue: 0,0:39:17.17,0:39:19.04,Default,,0,0,0,,If you're trying to do things
Dialogue: 0,0:39:19.04,0:39:20.64,Default,,0,0,0,,like streaming protocols or
Dialogue: 0,0:39:20.64,0:39:22.68,Default,,0,0,0,,transfer a large amount of data,
Dialogue: 0,0:39:22.68,0:39:24.04,Default,,0,0,0,,L2CAP Channels are a great fit
Dialogue: 0,0:39:24.04,0:39:25.19,Default,,0,0,0,,for that and we think that's a
Dialogue: 0,0:39:25.19,0:39:26.39,Default,,0,0,0,,really powerful feature that's
Dialogue: 0,0:39:26.39,0:39:27.36,Default,,0,0,0,,going to help you build even
Dialogue: 0,0:39:27.36,0:39:28.28,Default,,0,0,0,,better accessories.
Dialogue: 0,0:39:28.78,0:39:30.86,Default,,0,0,0,,And then if you're building new
Dialogue: 0,0:39:30.86,0:39:32.86,Default,,0,0,0,,accessories, always look for the
Dialogue: 0,0:39:32.86,0:39:34.58,Default,,0,0,0,,newest Bluetooth specifications
Dialogue: 0,0:39:34.58,0:39:36.24,Default,,0,0,0,,and chipsets available and
Dialogue: 0,0:39:36.24,0:39:37.39,Default,,0,0,0,,follow the Accessory Design
Dialogue: 0,0:39:37.39,0:39:38.00,Default,,0,0,0,,Guidelines.
Dialogue: 0,0:39:40.62,0:39:42.81,Default,,0,0,0,,For more information, we have a
Dialogue: 0,0:39:42.81,0:39:43.98,Default,,0,0,0,,website up here that will have
Dialogue: 0,0:39:43.98,0:39:45.11,Default,,0,0,0,,links to the Core Bluetooth
Dialogue: 0,0:39:45.11,0:39:47.48,Default,,0,0,0,,Developer Documentation Sample
Dialogue: 0,0:39:47.48,0:39:49.22,Default,,0,0,0,,Code and other great resources
Dialogue: 0,0:39:49.22,0:39:50.18,Default,,0,0,0,,to help you get started.
Dialogue: 0,0:39:51.92,0:39:53.55,Default,,0,0,0,,We also have two historical
Dialogue: 0,0:39:53.55,0:39:54.66,Default,,0,0,0,,sessions that we've done at WWDC
Dialogue: 0,0:39:54.66,0:39:56.41,Default,,0,0,0,,that are available online, so
Dialogue: 0,0:39:56.41,0:39:57.26,Default,,0,0,0,,you can go back and watch the
Dialogue: 0,0:39:57.26,0:39:59.16,Default,,0,0,0,,videos and get a bunch of great
Dialogue: 0,0:39:59.16,0:40:01.46,Default,,0,0,0,,information about Core Bluetooth
Dialogue: 0,0:40:01.50,0:40:02.54,Default,,0,0,0,,both as a Central and a
Dialogue: 0,0:40:02.54,0:40:02.99,Default,,0,0,0,,Peripheral.
Dialogue: 0,0:40:03.83,0:40:04.35,Default,,0,0,0,,Thank you.
Dialogue: 0,0:40:04.66,0:40:06.17,Default,,0,0,0,,We can't wait to see build with
Dialogue: 0,0:40:06.17,0:40:07.25,Default,,0,0,0,,all these new enhancements.
Dialogue: 0,0:40:08.52,0:40:14.50,Default,,0,0,0,,[ Applause ]
