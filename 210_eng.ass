[Script Info]
; Script generated by FFmpeg/Lavc57.89.100
ScriptType: v4.00+
PlayResX: 384
PlayResY: 288

[V4+ Styles]
Format: Name, Fontname, Fontsize, PrimaryColour, SecondaryColour, OutlineColour, BackColour, Bold, Italic, Underline, StrikeOut, ScaleX, ScaleY, Spacing, Angle, BorderStyle, Outline, Shadow, Alignment, MarginL, MarginR, MarginV, Encoding
Style: Default,Arial,16,&Hffffff,&Hffffff,&H0,&H0,0,0,0,0,100,100,0,0,1,1,0,2,10,10,10,0

[Events]
Format: Layer, Start, End, Style, Name, MarginL, MarginR, MarginV, Effect, Text
Dialogue: 0,0:00:23.52,0:00:25.64,Default,,0,0,0,,[ Applause ]
Dialogue: 0,0:00:26.14,0:00:28.05,Default,,0,0,0,,>> Hello, welcome to Session
Dialogue: 0,0:00:28.05,0:00:29.73,Default,,0,0,0,,2010, What's New in Core Data.
Dialogue: 0,0:00:30.40,0:00:31.34,Default,,0,0,0,,I'm Melissa.
Dialogue: 0,0:00:31.44,0:00:32.18,Default,,0,0,0,,I'm one of the Core Data
Dialogue: 0,0:00:32.18,0:00:32.98,Default,,0,0,0,,engineers.
Dialogue: 0,0:00:33.06,0:00:34.48,Default,,0,0,0,,And I will be joined on stage
Dialogue: 0,0:00:34.48,0:00:35.82,Default,,0,0,0,,later by Rishi, one of my
Dialogue: 0,0:00:35.82,0:00:36.44,Default,,0,0,0,,co-workers.
Dialogue: 0,0:00:37.14,0:00:39.01,Default,,0,0,0,,And we're here to talk about all
Dialogue: 0,0:00:39.01,0:00:40.20,Default,,0,0,0,,of the stuff that we've been
Dialogue: 0,0:00:40.20,0:00:41.49,Default,,0,0,0,,working on for the last year
Dialogue: 0,0:00:41.62,0:00:43.06,Default,,0,0,0,,because it's been fun for us.
Dialogue: 0,0:00:43.06,0:00:44.06,Default,,0,0,0,,And we're hoping that you'll
Dialogue: 0,0:00:44.06,0:00:46.08,Default,,0,0,0,,find it fun and useful to work
Dialogue: 0,0:00:46.08,0:00:47.35,Default,,0,0,0,,with in your applications.
Dialogue: 0,0:00:48.17,0:00:49.26,Default,,0,0,0,,And we will hope all of the
Dialogue: 0,0:00:49.26,0:00:50.29,Default,,0,0,0,,technical problems for this
Dialogue: 0,0:00:50.29,0:00:51.26,Default,,0,0,0,,presentation have already
Dialogue: 0,0:00:51.26,0:00:51.68,Default,,0,0,0,,happened.
Dialogue: 0,0:00:52.95,0:00:56.13,Default,,0,0,0,,So what have we been up to?
Dialogue: 0,0:00:56.13,0:00:57.05,Default,,0,0,0,,We've been doing some Core
Dialogue: 0,0:00:57.05,0:00:58.03,Default,,0,0,0,,Spotlight Integration.
Dialogue: 0,0:00:58.34,0:00:59.89,Default,,0,0,0,,We've added a bunch of new
Dialogue: 0,0:00:59.89,0:01:00.97,Default,,0,0,0,,indexing APIs.
Dialogue: 0,0:01:00.97,0:01:02.18,Default,,0,0,0,,And we've added a big new
Dialogue: 0,0:01:02.18,0:01:03.19,Default,,0,0,0,,feature called Persistent
Dialogue: 0,0:01:03.19,0:01:03.89,Default,,0,0,0,,history tracking.
Dialogue: 0,0:01:03.89,0:01:04.94,Default,,0,0,0,,That is what Rishi's going to
Dialogue: 0,0:01:04.94,0:01:05.45,Default,,0,0,0,,talk about.
Dialogue: 0,0:01:05.94,0:01:07.26,Default,,0,0,0,,And it's really cool and I'm
Dialogue: 0,0:01:07.26,0:01:08.23,Default,,0,0,0,,really excited to see it
Dialogue: 0,0:01:08.23,0:01:08.84,Default,,0,0,0,,presented here.
Dialogue: 0,0:01:09.90,0:01:11.05,Default,,0,0,0,,But first Alphonse says "Hi".
Dialogue: 0,0:01:11.21,0:01:11.95,Default,,0,0,0,,He's my mascot.
Dialogue: 0,0:01:11.95,0:01:14.32,Default,,0,0,0,,I couldn't do this without him.
Dialogue: 0,0:01:14.54,0:01:15.36,Default,,0,0,0,,So CoreSpotlight.
Dialogue: 0,0:01:16.35,0:01:17.49,Default,,0,0,0,,What is Core Spotlight?
Dialogue: 0,0:01:17.64,0:01:19.24,Default,,0,0,0,,Before I talk about Core
Dialogue: 0,0:01:19.24,0:01:20.10,Default,,0,0,0,,Spotlight I want to talk a
Dialogue: 0,0:01:20.10,0:01:21.24,Default,,0,0,0,,little bit about Spotlight.
Dialogue: 0,0:01:21.50,0:01:22.87,Default,,0,0,0,,Spotlight was the original
Dialogue: 0,0:01:22.87,0:01:23.99,Default,,0,0,0,,search API, and search
Dialogue: 0,0:01:23.99,0:01:25.45,Default,,0,0,0,,technology on Mac OS 10.
Dialogue: 0,0:01:25.45,0:01:26.97,Default,,0,0,0,,It was very document centric,
Dialogue: 0,0:01:27.50,0:01:29.05,Default,,0,0,0,,which meant that the search
Dialogue: 0,0:01:29.05,0:01:30.17,Default,,0,0,0,,results that you would get back
Dialogue: 0,0:01:30.50,0:01:33.49,Default,,0,0,0,,from a customer doing a search
Dialogue: 0,0:01:33.49,0:01:34.92,Default,,0,0,0,,in the Spotlight menu would
Dialogue: 0,0:01:34.92,0:01:37.26,Default,,0,0,0,,identify the document that had
Dialogue: 0,0:01:37.26,0:01:38.59,Default,,0,0,0,,been retrieved by Spotlight, but
Dialogue: 0,0:01:38.59,0:01:39.82,Default,,0,0,0,,wouldn't actually tell you where
Dialogue: 0,0:01:39.82,0:01:40.98,Default,,0,0,0,,in the document that hit came
Dialogue: 0,0:01:40.98,0:01:41.23,Default,,0,0,0,,from.
Dialogue: 0,0:01:42.06,0:01:43.32,Default,,0,0,0,,And it was not really ideal for
Dialogue: 0,0:01:43.32,0:01:44.60,Default,,0,0,0,,databases, which as we know can
Dialogue: 0,0:01:44.60,0:01:45.97,Default,,0,0,0,,have lots and lots of records in
Dialogue: 0,0:01:46.58,0:01:46.67,Default,,0,0,0,,them.
Dialogue: 0,0:01:47.60,0:01:48.39,Default,,0,0,0,,Which brings us to Core
Dialogue: 0,0:01:48.39,0:01:48.88,Default,,0,0,0,,Spotlight.
Dialogue: 0,0:01:49.40,0:01:50.79,Default,,0,0,0,,Core Spotlight was the original
Dialogue: 0,0:01:50.79,0:01:52.12,Default,,0,0,0,,search technology on iOS.
Dialogue: 0,0:01:52.52,0:01:53.67,Default,,0,0,0,,And it was much more
Dialogue: 0,0:01:53.67,0:01:54.37,Default,,0,0,0,,database-friendly.
Dialogue: 0,0:01:54.84,0:01:56.49,Default,,0,0,0,,It would return not only the
Dialogue: 0,0:01:56.49,0:01:58.75,Default,,0,0,0,,application and the document
Dialogue: 0,0:01:59.00,0:02:00.57,Default,,0,0,0,,that the user had selected, but
Dialogue: 0,0:02:00.82,0:02:02.02,Default,,0,0,0,,it would also tell you where in
Dialogue: 0,0:02:02.02,0:02:02.68,Default,,0,0,0,,that document.
Dialogue: 0,0:02:03.18,0:02:04.41,Default,,0,0,0,,It allowed for deep linking into
Dialogue: 0,0:02:04.45,0:02:05.60,Default,,0,0,0,,your application so you could
Dialogue: 0,0:02:05.60,0:02:07.27,Default,,0,0,0,,bring up exactly the results
Dialogue: 0,0:02:07.52,0:02:09.25,Default,,0,0,0,,that your user was interested in
Dialogue: 0,0:02:09.25,0:02:09.52,Default,,0,0,0,,seeing.
Dialogue: 0,0:02:09.75,0:02:11.51,Default,,0,0,0,,Now it ships on Mac OS, as well
Dialogue: 0,0:02:11.51,0:02:12.00,Default,,0,0,0,,as on iOS.
Dialogue: 0,0:02:12.00,0:02:13.29,Default,,0,0,0,,And we thought this is a great
Dialogue: 0,0:02:13.29,0:02:14.61,Default,,0,0,0,,time to integrate with it in
Dialogue: 0,0:02:14.61,0:02:14.98,Default,,0,0,0,,Core Data.
Dialogue: 0,0:02:16.54,0:02:17.85,Default,,0,0,0,,So how does Core Spotlight work?
Dialogue: 0,0:02:18.08,0:02:19.20,Default,,0,0,0,,Well it's a lot like Spotlight.
Dialogue: 0,0:02:19.61,0:02:20.64,Default,,0,0,0,,You've got an application.
Dialogue: 0,0:02:20.88,0:02:21.86,Default,,0,0,0,,It has a bunch of data in it.
Dialogue: 0,0:02:22.64,0:02:24.25,Default,,0,0,0,,The user goes into the Spotlight
Dialogue: 0,0:02:24.25,0:02:25.60,Default,,0,0,0,,menu and looks for something
Dialogue: 0,0:02:25.60,0:02:26.32,Default,,0,0,0,,that's going to be in your
Dialogue: 0,0:02:26.32,0:02:27.00,Default,,0,0,0,,application.
Dialogue: 0,0:02:27.21,0:02:29.11,Default,,0,0,0,,For example, you know, photo
Dialogue: 0,0:02:29.21,0:02:29.66,Default,,0,0,0,,from India.
Dialogue: 0,0:02:30.47,0:02:33.55,Default,,0,0,0,,And Spotlight launch services
Dialogue: 0,0:02:33.55,0:02:35.01,Default,,0,0,0,,launches your application and
Dialogue: 0,0:02:35.01,0:02:36.45,Default,,0,0,0,,you're given a user activity
Dialogue: 0,0:02:36.63,0:02:39.85,Default,,0,0,0,,that you can use to retrieve the
Dialogue: 0,0:02:39.85,0:02:41.67,Default,,0,0,0,,information about what the user
Dialogue: 0,0:02:41.67,0:02:42.32,Default,,0,0,0,,was searching for.
Dialogue: 0,0:02:43.05,0:02:44.52,Default,,0,0,0,,Popup, you know, that specific
Dialogue: 0,0:02:44.52,0:02:47.26,Default,,0,0,0,,view so your user could see it.
Dialogue: 0,0:02:47.88,0:02:49.23,Default,,0,0,0,,As I said, it's now shipping on
Dialogue: 0,0:02:49.23,0:02:51.40,Default,,0,0,0,,Mac OS as well as iOS.
Dialogue: 0,0:02:51.52,0:02:52.60,Default,,0,0,0,,And at this point the Core
Dialogue: 0,0:02:52.60,0:02:53.86,Default,,0,0,0,,Spotlight team wants me to tell
Dialogue: 0,0:02:53.86,0:02:55.36,Default,,0,0,0,,you that you can also use the
Dialogue: 0,0:02:55.36,0:02:56.86,Default,,0,0,0,,Core Spotlight API's to access
Dialogue: 0,0:02:56.86,0:02:58.15,Default,,0,0,0,,the Spotlight search indexes
Dialogue: 0,0:02:58.23,0:02:59.89,Default,,0,0,0,,from your application, which is
Dialogue: 0,0:02:59.89,0:03:00.15,Default,,0,0,0,,cool.
Dialogue: 0,0:03:01.00,0:03:02.67,Default,,0,0,0,,And it does all of this without
Dialogue: 0,0:03:02.67,0:03:03.98,Default,,0,0,0,,scattering zero-length files all
Dialogue: 0,0:03:03.98,0:03:04.72,Default,,0,0,0,,over the file system.
Dialogue: 0,0:03:05.13,0:03:06.09,Default,,0,0,0,,And I'm really hoping that at
Dialogue: 0,0:03:06.09,0:03:07.22,Default,,0,0,0,,least some of you are mentally
Dialogue: 0,0:03:07.22,0:03:08.54,Default,,0,0,0,,cheering about this because I
Dialogue: 0,0:03:08.54,0:03:09.02,Default,,0,0,0,,sure was.
Dialogue: 0,0:03:09.73,0:03:12.55,Default,,0,0,0,,So how does it work?
Dialogue: 0,0:03:12.55,0:03:13.99,Default,,0,0,0,,There's three basic components
Dialogue: 0,0:03:13.99,0:03:14.73,Default,,0,0,0,,to the Core Spotlight
Dialogue: 0,0:03:14.73,0:03:15.23,Default,,0,0,0,,integration.
Dialogue: 0,0:03:15.23,0:03:17.49,Default,,0,0,0,,First there's -- we've
Dialogue: 0,0:03:17.49,0:03:18.76,Default,,0,0,0,,repurposed the index by
Dialogue: 0,0:03:18.76,0:03:20.06,Default,,0,0,0,,Spotlight property on NS
Dialogue: 0,0:03:20.06,0:03:21.58,Default,,0,0,0,,Property Description to indicate
Dialogue: 0,0:03:21.58,0:03:22.79,Default,,0,0,0,,that a property should be pushed
Dialogue: 0,0:03:22.79,0:03:23.94,Default,,0,0,0,,into Core Spotlight.
Dialogue: 0,0:03:24.05,0:03:26.51,Default,,0,0,0,,But we need a way to specify
Dialogue: 0,0:03:26.51,0:03:27.63,Default,,0,0,0,,what should be showing up in the
Dialogue: 0,0:03:27.63,0:03:28.76,Default,,0,0,0,,Spotlight results menu.
Dialogue: 0,0:03:29.02,0:03:30.42,Default,,0,0,0,,And that is NS Entity
Dialogue: 0,0:03:30.42,0:03:31.61,Default,,0,0,0,,Description Core Spotlight
Dialogue: 0,0:03:31.61,0:03:32.61,Default,,0,0,0,,Display Name Expression.
Dialogue: 0,0:03:33.02,0:03:34.16,Default,,0,0,0,,And of course there's an
Dialogue: 0,0:03:34.21,0:03:34.73,Default,,0,0,0,,Exporter.
Dialogue: 0,0:03:34.73,0:03:35.88,Default,,0,0,0,,That whenever you do save in
Dialogue: 0,0:03:35.88,0:03:37.83,Default,,0,0,0,,your application pushes whatever
Dialogue: 0,0:03:37.83,0:03:39.27,Default,,0,0,0,,change the user has made into
Dialogue: 0,0:03:39.34,0:03:41.11,Default,,0,0,0,,the Core Spotlight Index.
Dialogue: 0,0:03:41.66,0:03:43.15,Default,,0,0,0,,Core Spotlight Display Name
Dialogue: 0,0:03:43.15,0:03:45.01,Default,,0,0,0,,Expression is kind of the
Dialogue: 0,0:03:45.01,0:03:45.88,Default,,0,0,0,,trickiest piece of this to
Dialogue: 0,0:03:45.88,0:03:46.49,Default,,0,0,0,,understand.
Dialogue: 0,0:03:46.49,0:03:47.68,Default,,0,0,0,,It's actually an instance of NS
Dialogue: 0,0:03:47.68,0:03:49.26,Default,,0,0,0,,Expression that you set as a
Dialogue: 0,0:03:49.26,0:03:50.94,Default,,0,0,0,,property on NS Entity
Dialogue: 0,0:03:50.94,0:03:51.43,Default,,0,0,0,,Description.
Dialogue: 0,0:03:52.01,0:03:53.96,Default,,0,0,0,,And it's evaluated during the
Dialogue: 0,0:03:53.96,0:03:55.37,Default,,0,0,0,,Core Spotlight index update.
Dialogue: 0,0:03:56.00,0:03:57.48,Default,,0,0,0,,With the object -- the managed
Dialogue: 0,0:03:57.48,0:03:59.11,Default,,0,0,0,,object that's being updated as
Dialogue: 0,0:03:59.11,0:04:00.42,Default,,0,0,0,,the evaluated object parameter.
Dialogue: 0,0:04:00.95,0:04:01.97,Default,,0,0,0,,And this allows you to return
Dialogue: 0,0:04:01.97,0:04:03.44,Default,,0,0,0,,anything that can be pushed in
Dialogue: 0,0:04:03.44,0:04:04.22,Default,,0,0,0,,to Core Spotlight.
Dialogue: 0,0:04:04.22,0:04:05.35,Default,,0,0,0,,Even something that's not one of
Dialogue: 0,0:04:05.35,0:04:06.40,Default,,0,0,0,,the base Core Data types.
Dialogue: 0,0:04:06.53,0:04:08.13,Default,,0,0,0,,Like for example an instance of
Dialogue: 0,0:04:08.17,0:04:09.05,Default,,0,0,0,,CS Localized String.
Dialogue: 0,0:04:09.73,0:04:11.22,Default,,0,0,0,,By and large, these expressions
Dialogue: 0,0:04:11.22,0:04:12.57,Default,,0,0,0,,are going to evaluate Keypaths
Dialogue: 0,0:04:12.57,0:04:13.52,Default,,0,0,0,,but they could be, you know,
Dialogue: 0,0:04:13.52,0:04:14.44,Default,,0,0,0,,much more interesting.
Dialogue: 0,0:04:14.44,0:04:15.28,Default,,0,0,0,,They could be built in
Dialogue: 0,0:04:15.28,0:04:17.22,Default,,0,0,0,,functions, lowercase, uppercase,
Dialogue: 0,0:04:17.22,0:04:17.98,Default,,0,0,0,,stuff like that.
Dialogue: 0,0:04:18.41,0:04:19.94,Default,,0,0,0,,Or if you're somebody like me
Dialogue: 0,0:04:19.94,0:04:21.15,Default,,0,0,0,,they could be completely random
Dialogue: 0,0:04:21.15,0:04:23.20,Default,,0,0,0,,functions that go often dig
Dialogue: 0,0:04:23.20,0:04:24.58,Default,,0,0,0,,around in your runtime to find
Dialogue: 0,0:04:24.69,0:04:26.52,Default,,0,0,0,,instances of classes and call
Dialogue: 0,0:04:26.52,0:04:27.98,Default,,0,0,0,,just random methods on them to
Dialogue: 0,0:04:27.98,0:04:28.61,Default,,0,0,0,,get their stuff back.
Dialogue: 0,0:04:28.82,0:04:30.54,Default,,0,0,0,,I think that's cool too.
Dialogue: 0,0:04:31.33,0:04:33.54,Default,,0,0,0,,And of course, there's the NS
Dialogue: 0,0:04:33.54,0:04:34.57,Default,,0,0,0,,Core Data Spotlight Delegate,
Dialogue: 0,0:04:34.57,0:04:35.68,Default,,0,0,0,,which is like the big and
Dialogue: 0,0:04:35.68,0:04:36.91,Default,,0,0,0,,complicated piece that we wrote
Dialogue: 0,0:04:36.91,0:04:37.72,Default,,0,0,0,,that does all the work.
Dialogue: 0,0:04:38.09,0:04:40.64,Default,,0,0,0,,It implements CS Searchable
Dialogue: 0,0:04:40.64,0:04:41.33,Default,,0,0,0,,Index Delegate.
Dialogue: 0,0:04:41.42,0:04:42.39,Default,,0,0,0,,It provides default
Dialogue: 0,0:04:42.39,0:04:44.09,Default,,0,0,0,,implementation of all methods,
Dialogue: 0,0:04:44.09,0:04:45.09,Default,,0,0,0,,so you can use it straight out
Dialogue: 0,0:04:45.09,0:04:46.63,Default,,0,0,0,,of the box.
Dialogue: 0,0:04:46.63,0:04:47.81,Default,,0,0,0,,It uses separate store on a
Dialogue: 0,0:04:47.81,0:04:48.94,Default,,0,0,0,,background thread so you don't
Dialogue: 0,0:04:48.94,0:04:49.93,Default,,0,0,0,,need to worry about any of the
Dialogue: 0,0:04:49.93,0:04:51.23,Default,,0,0,0,,work that's being done by the
Dialogue: 0,0:04:51.23,0:04:52.98,Default,,0,0,0,,Spotlight Exporter blocking your
Dialogue: 0,0:04:52.98,0:04:54.93,Default,,0,0,0,,main view context from getting
Dialogue: 0,0:04:54.93,0:04:55.60,Default,,0,0,0,,its work done.
Dialogue: 0,0:04:56.52,0:04:57.69,Default,,0,0,0,,You initialize it with a NS
Dialogue: 0,0:04:57.69,0:04:59.41,Default,,0,0,0,,Persistent Store Description and
Dialogue: 0,0:04:59.41,0:05:00.68,Default,,0,0,0,,a model since it needs to know
Dialogue: 0,0:05:00.68,0:05:02.98,Default,,0,0,0,,what it's working with.
Dialogue: 0,0:05:02.98,0:05:04.34,Default,,0,0,0,,And basically you tell a
Dialogue: 0,0:05:04.34,0:05:05.96,Default,,0,0,0,,Persistent Store that it should
Dialogue: 0,0:05:05.96,0:05:08.61,Default,,0,0,0,,be exporting its data to Core
Dialogue: 0,0:05:08.61,0:05:10.59,Default,,0,0,0,,Spotlight by setting the
Dialogue: 0,0:05:10.59,0:05:12.83,Default,,0,0,0,,exporter as an option when in
Dialogue: 0,0:05:12.83,0:05:13.62,Default,,0,0,0,,when you're calling NS
Dialogue: 0,0:05:13.62,0:05:15.66,Default,,0,0,0,,Persistent Store with type on
Dialogue: 0,0:05:15.66,0:05:16.25,Default,,0,0,0,,the Persistent Store
Dialogue: 0,0:05:16.25,0:05:16.71,Default,,0,0,0,,Coordinator.
Dialogue: 0,0:05:17.52,0:05:19.26,Default,,0,0,0,,The override point on the
Dialogue: 0,0:05:19.26,0:05:20.25,Default,,0,0,0,,delegate if you don't like the
Dialogue: 0,0:05:20.25,0:05:22.96,Default,,0,0,0,,default behavior is NS Data Core
Dialogue: 0,0:05:22.96,0:05:25.24,Default,,0,0,0,,Spotlight delegate attribute set
Dialogue: 0,0:05:25.24,0:05:25.83,Default,,0,0,0,,for object.
Dialogue: 0,0:05:26.24,0:05:27.68,Default,,0,0,0,,And an override might look
Dialogue: 0,0:05:27.68,0:05:28.94,Default,,0,0,0,,something like this.
Dialogue: 0,0:05:28.97,0:05:30.15,Default,,0,0,0,,Here we've got a basic method
Dialogue: 0,0:05:30.15,0:05:31.82,Default,,0,0,0,,that goes through and gets the
Dialogue: 0,0:05:31.82,0:05:32.81,Default,,0,0,0,,attribute set return by the
Dialogue: 0,0:05:32.81,0:05:33.55,Default,,0,0,0,,super class.
Dialogue: 0,0:05:34.69,0:05:36.10,Default,,0,0,0,,It looks at the object, realizes
Dialogue: 0,0:05:36.10,0:05:37.01,Default,,0,0,0,,that this is an instance of a
Dialogue: 0,0:05:37.01,0:05:38.45,Default,,0,0,0,,photo because I've got like the
Dialogue: 0,0:05:38.45,0:05:40.05,Default,,0,0,0,,photo app and those photos have
Dialogue: 0,0:05:40.05,0:05:40.72,Default,,0,0,0,,tags.
Dialogue: 0,0:05:40.80,0:05:42.32,Default,,0,0,0,,And when somebody searches for
Dialogue: 0,0:05:42.32,0:05:44.37,Default,,0,0,0,,something-- when the user
Dialogue: 0,0:05:44.37,0:05:45.31,Default,,0,0,0,,searches for something, that
Dialogue: 0,0:05:45.31,0:05:46.61,Default,,0,0,0,,returns a hit on one of those
Dialogue: 0,0:05:46.61,0:05:47.90,Default,,0,0,0,,tags, I actually want to return
Dialogue: 0,0:05:47.90,0:05:49.19,Default,,0,0,0,,the photo that has that tag
Dialogue: 0,0:05:49.19,0:05:50.68,Default,,0,0,0,,because the tag itself is not
Dialogue: 0,0:05:50.68,0:05:51.40,Default,,0,0,0,,terribly interesting.
Dialogue: 0,0:05:51.52,0:05:53.21,Default,,0,0,0,,So I go and collapse all of the
Dialogue: 0,0:05:53.21,0:05:54.75,Default,,0,0,0,,tag information on to the photo
Dialogue: 0,0:05:54.75,0:05:56.52,Default,,0,0,0,,objects itself so that the photo
Dialogue: 0,0:05:56.52,0:05:58.19,Default,,0,0,0,,will be returned when there's a
Dialogue: 0,0:05:58.19,0:05:59.24,Default,,0,0,0,,match in Spotlight.
Dialogue: 0,0:05:59.24,0:06:01.45,Default,,0,0,0,,And then I just return the
Dialogue: 0,0:06:01.45,0:06:01.96,Default,,0,0,0,,attribute set.
Dialogue: 0,0:06:01.96,0:06:04.02,Default,,0,0,0,,And that's as much code as we
Dialogue: 0,0:06:04.02,0:06:05.17,Default,,0,0,0,,expect most of you to ever have
Dialogue: 0,0:06:05.17,0:06:05.93,Default,,0,0,0,,to write for this.
Dialogue: 0,0:06:06.40,0:06:08.99,Default,,0,0,0,,So now I'm going to do a demo.
Dialogue: 0,0:06:16.45,0:06:17.21,Default,,0,0,0,,And I've got a little
Dialogue: 0,0:06:17.21,0:06:17.93,Default,,0,0,0,,application here.
Dialogue: 0,0:06:19.12,0:06:21.33,Default,,0,0,0,,Please ignore the x Code in the
Dialogue: 0,0:06:21.33,0:06:23.16,Default,,0,0,0,,background, we'll get there.
Dialogue: 0,0:06:23.96,0:06:25.45,Default,,0,0,0,,It displays photos.
Dialogue: 0,0:06:26.21,0:06:28.33,Default,,0,0,0,,If you scroll around, look at
Dialogue: 0,0:06:29.26,0:06:31.98,Default,,0,0,0,,stuff, click on things to see,
Dialogue: 0,0:06:32.23,0:06:32.44,Default,,0,0,0,,you know?
Dialogue: 0,0:06:33.82,0:06:34.74,Default,,0,0,0,,Photos of people enjoying
Dialogue: 0,0:06:34.74,0:06:35.64,Default,,0,0,0,,themselves with a little bit of
Dialogue: 0,0:06:35.64,0:06:36.67,Default,,0,0,0,,meta data information.
Dialogue: 0,0:06:37.09,0:06:38.25,Default,,0,0,0,,But here's the interesting part.
Dialogue: 0,0:06:38.86,0:06:40.03,Default,,0,0,0,,I can now come up to Spotlight
Dialogue: 0,0:06:40.97,0:06:44.92,Default,,0,0,0,,and type in for example,
Dialogue: 0,0:06:45.48,0:06:47.34,Default,,0,0,0,,something that I know is in
Dialogue: 0,0:06:48.25,0:06:50.39,Default,,0,0,0,,Spotlight and it automatically
Dialogue: 0,0:06:50.46,0:06:52.17,Default,,0,0,0,,activates my application and
Dialogue: 0,0:06:52.55,0:06:54.17,Default,,0,0,0,,calls the application continue
Dialogue: 0,0:06:54.17,0:06:56.13,Default,,0,0,0,,user activity method with an NS
Dialogue: 0,0:06:56.13,0:06:56.83,Default,,0,0,0,,user activity.
Dialogue: 0,0:06:57.39,0:06:59.01,Default,,0,0,0,,And here I've broken in that
Dialogue: 0,0:06:59.01,0:07:00.37,Default,,0,0,0,,method so let's see what's going
Dialogue: 0,0:07:00.37,0:07:00.61,Default,,0,0,0,,on.
Dialogue: 0,0:07:00.77,0:07:03.54,Default,,0,0,0,,Well, somebody opened something
Dialogue: 0,0:07:03.75,0:07:04.76,Default,,0,0,0,,and I'm going to go dig around
Dialogue: 0,0:07:04.76,0:07:07.11,Default,,0,0,0,,in that user activities user
Dialogue: 0,0:07:07.11,0:07:08.09,Default,,0,0,0,,info because that's where all
Dialogue: 0,0:07:08.09,0:07:10.92,Default,,0,0,0,,the interesting stuff is and dig
Dialogue: 0,0:07:10.92,0:07:11.69,Default,,0,0,0,,out the identifier.
Dialogue: 0,0:07:11.69,0:07:13.75,Default,,0,0,0,,And if I print that identifier
Dialogue: 0,0:07:13.75,0:07:15.21,Default,,0,0,0,,we can see that well, the
Dialogue: 0,0:07:15.21,0:07:16.83,Default,,0,0,0,,identifier and the user info is
Dialogue: 0,0:07:16.83,0:07:18.42,Default,,0,0,0,,something that looks an awful
Dialogue: 0,0:07:18.42,0:07:19.80,Default,,0,0,0,,lot like a managed object ID
Dialogue: 0,0:07:19.80,0:07:21.08,Default,,0,0,0,,string representation.
Dialogue: 0,0:07:21.55,0:07:23.16,Default,,0,0,0,,So I'm going to turn that into a
Dialogue: 0,0:07:23.52,0:07:25.77,Default,,0,0,0,,URI and ask the persistent store
Dialogue: 0,0:07:25.77,0:07:27.39,Default,,0,0,0,,coordinator to turn that into a
Dialogue: 0,0:07:27.39,0:07:28.32,Default,,0,0,0,,managed object ID.
Dialogue: 0,0:07:28.87,0:07:31.61,Default,,0,0,0,,And then I'm just going to
Dialogue: 0,0:07:31.61,0:07:36.86,Default,,0,0,0,,continue and hey wow, I've
Dialogue: 0,0:07:36.86,0:07:39.73,Default,,0,0,0,,opened the photo that my user
Dialogue: 0,0:07:39.77,0:07:41.24,Default,,0,0,0,,requested.
Dialogue: 0,0:07:42.64,0:07:43.84,Default,,0,0,0,,Lovely, relaxing view.
Dialogue: 0,0:07:44.52,0:07:48.35,Default,,0,0,0,,And that sort of how the Core
Dialogue: 0,0:07:48.35,0:07:49.85,Default,,0,0,0,,Spotlight Integration works.
Dialogue: 0,0:07:49.94,0:07:51.33,Default,,0,0,0,,We do most of the work, you need
Dialogue: 0,0:07:51.33,0:07:54.94,Default,,0,0,0,,to implement a method that does
Dialogue: 0,0:07:55.15,0:07:56.20,Default,,0,0,0,,stuff.
Dialogue: 0,0:07:57.05,0:07:57.77,Default,,0,0,0,,So that's the Core Spotlight
Dialogue: 0,0:07:57.77,0:07:58.28,Default,,0,0,0,,Integration.
Dialogue: 0,0:07:59.03,0:08:02.70,Default,,0,0,0,,Some totally non-sharp corners,
Dialogue: 0,0:08:02.70,0:08:03.99,Default,,0,0,0,,stuff we've made easy for you.
Dialogue: 0,0:08:03.99,0:08:05.52,Default,,0,0,0,,If you decide that you want to
Dialogue: 0,0:08:05.52,0:08:06.36,Default,,0,0,0,,enable the Core Spotlight
Dialogue: 0,0:08:06.36,0:08:08.73,Default,,0,0,0,,Integration and pass an exporter
Dialogue: 0,0:08:08.77,0:08:10.32,Default,,0,0,0,,to as one of the options when
Dialogue: 0,0:08:10.32,0:08:11.32,Default,,0,0,0,,you add your store to the
Dialogue: 0,0:08:11.32,0:08:12.27,Default,,0,0,0,,persistent store coordinator.
Dialogue: 0,0:08:12.27,0:08:14.05,Default,,0,0,0,,We will automatically start
Dialogue: 0,0:08:14.05,0:08:15.33,Default,,0,0,0,,exporting to Core Spotlight on
Dialogue: 0,0:08:15.33,0:08:16.64,Default,,0,0,0,,your application's first launch.
Dialogue: 0,0:08:16.85,0:08:18.12,Default,,0,0,0,,And we will continue exporting
Dialogue: 0,0:08:18.12,0:08:19.49,Default,,0,0,0,,until we have exported all of
Dialogue: 0,0:08:19.49,0:08:20.52,Default,,0,0,0,,the data even if your
Dialogue: 0,0:08:20.52,0:08:22.22,Default,,0,0,0,,application is exited, if the
Dialogue: 0,0:08:22.22,0:08:23.35,Default,,0,0,0,,user exits your application in
Dialogue: 0,0:08:23.35,0:08:23.84,Default,,0,0,0,,the meantime.
Dialogue: 0,0:08:24.28,0:08:25.30,Default,,0,0,0,,We use the Persistent History
Dialogue: 0,0:08:25.30,0:08:26.46,Default,,0,0,0,,Tracking feature to ensure that
Dialogue: 0,0:08:26.46,0:08:27.58,Default,,0,0,0,,all of the data is pushed.
Dialogue: 0,0:08:28.12,0:08:28.95,Default,,0,0,0,,Even if your application
Dialogue: 0,0:08:28.95,0:08:31.26,Default,,0,0,0,,crashes, exits, whatever that
Dialogue: 0,0:08:31.32,0:08:32.21,Default,,0,0,0,,doesn't quite work in the seed
Dialogue: 0,0:08:32.21,0:08:33.11,Default,,0,0,0,,but it will eventually.
Dialogue: 0,0:08:33.82,0:08:37.89,Default,,0,0,0,,Some slightly sharper corners,
Dialogue: 0,0:08:37.95,0:08:39.23,Default,,0,0,0,,the Core Spotlight and Spotlight
Dialogue: 0,0:08:39.23,0:08:40.45,Default,,0,0,0,,integration aren't mutually
Dialogue: 0,0:08:40.45,0:08:41.87,Default,,0,0,0,,exclusive, you can't do both.
Dialogue: 0,0:08:41.87,0:08:43.23,Default,,0,0,0,,If you try setting both entities
Dialogue: 0,0:08:43.23,0:08:44.96,Default,,0,0,0,,to Core Spotlight, Display Name
Dialogue: 0,0:08:44.96,0:08:47.27,Default,,0,0,0,,Expression, and the property is
Dialogue: 0,0:08:47.27,0:08:49.78,Default,,0,0,0,,stored in External Record, the
Dialogue: 0,0:08:49.78,0:08:50.74,Default,,0,0,0,,model compiler is going to
Dialogue: 0,0:08:50.74,0:08:51.59,Default,,0,0,0,,complain at you.
Dialogue: 0,0:08:52.16,0:08:53.44,Default,,0,0,0,,And we don't currently track the
Dialogue: 0,0:08:53.44,0:08:54.63,Default,,0,0,0,,results of batch operations.
Dialogue: 0,0:08:56.50,0:08:58.11,Default,,0,0,0,,Some slightly sharp corners.
Dialogue: 0,0:08:58.35,0:08:59.41,Default,,0,0,0,,This first one is something I
Dialogue: 0,0:08:59.41,0:09:00.45,Default,,0,0,0,,discovered while debugging
Dialogue: 0,0:09:00.45,0:09:02.09,Default,,0,0,0,,because I built all of my unit
Dialogue: 0,0:09:02.09,0:09:03.33,Default,,0,0,0,,tests in a separate framework,
Dialogue: 0,0:09:03.40,0:09:05.68,Default,,0,0,0,,which is run by XCTest, which
Dialogue: 0,0:09:05.68,0:09:06.88,Default,,0,0,0,,doesn't have this entitlement,
Dialogue: 0,0:09:06.88,0:09:08.36,Default,,0,0,0,,which made it very confusing as
Dialogue: 0,0:09:08.36,0:09:09.06,Default,,0,0,0,,to why I couldn't talk to
Dialogue: 0,0:09:09.06,0:09:09.49,Default,,0,0,0,,Spotlight.
Dialogue: 0,0:09:10.35,0:09:12.14,Default,,0,0,0,,Whatever application is trying
Dialogue: 0,0:09:12.14,0:09:13.16,Default,,0,0,0,,to talk to Spotlight, needs to
Dialogue: 0,0:09:13.16,0:09:13.49,Default,,0,0,0,,have the
Dialogue: 0,0:09:13.49,0:09:15.69,Default,,0,0,0,,com.apple.application-identifier
Dialogue: 0,0:09:16.25,0:09:16.78,Default,,0,0,0,,entitlement.
Dialogue: 0,0:09:16.78,0:09:17.90,Default,,0,0,0,,Most of you are going to get
Dialogue: 0,0:09:17.90,0:09:19.10,Default,,0,0,0,,this by default, but if you're
Dialogue: 0,0:09:19.10,0:09:20.49,Default,,0,0,0,,writing your unit tests, which
Dialogue: 0,0:09:20.52,0:09:22.83,Default,,0,0,0,,are run by XCTtest be aware of
Dialogue: 0,0:09:22.83,0:09:23.42,Default,,0,0,0,,this.
Dialogue: 0,0:09:23.53,0:09:24.49,Default,,0,0,0,,And of course you're going to
Dialogue: 0,0:09:24.49,0:09:25.32,Default,,0,0,0,,need to handle the search
Dialogue: 0,0:09:25.32,0:09:26.70,Default,,0,0,0,,result.
Dialogue: 0,0:09:27.00,0:09:27.99,Default,,0,0,0,,You need to implement
Dialogue: 0,0:09:27.99,0:09:30.93,Default,,0,0,0,,Application, Continue User
Dialogue: 0,0:09:30.93,0:09:32.22,Default,,0,0,0,,Activity on your application
Dialogue: 0,0:09:32.22,0:09:33.80,Default,,0,0,0,,delegate and you know, put
Dialogue: 0,0:09:33.80,0:09:35.41,Default,,0,0,0,,whatever you'd like in there.
Dialogue: 0,0:09:35.41,0:09:37.74,Default,,0,0,0,,We saw this on screen or the
Dialogue: 0,0:09:37.74,0:09:38.98,Default,,0,0,0,,demo, but I'm just walk through
Dialogue: 0,0:09:38.98,0:09:39.44,Default,,0,0,0,,it here.
Dialogue: 0,0:09:39.92,0:09:40.79,Default,,0,0,0,,This is the method you'd be
Dialogue: 0,0:09:40.79,0:09:41.41,Default,,0,0,0,,implementing.
Dialogue: 0,0:09:41.76,0:09:43.27,Default,,0,0,0,,Pretty simple, grab the User
Dialogue: 0,0:09:43.27,0:09:44.50,Default,,0,0,0,,Activity user info.
Dialogue: 0,0:09:45.37,0:09:47.77,Default,,0,0,0,,The identifier manage object ID
Dialogue: 0,0:09:47.77,0:09:49.49,Default,,0,0,0,,is stashed in there under KCS
Dialogue: 0,0:09:49.49,0:09:50.64,Default,,0,0,0,,Searchable Item Activity
Dialogue: 0,0:09:50.64,0:09:51.27,Default,,0,0,0,,Identifier.
Dialogue: 0,0:09:51.27,0:09:53.30,Default,,0,0,0,,Just turn that into a managed
Dialogue: 0,0:09:53.30,0:09:55.25,Default,,0,0,0,,object ID and then you can do
Dialogue: 0,0:09:55.25,0:09:56.04,Default,,0,0,0,,whatever you'd like.
Dialogue: 0,0:09:57.05,0:09:59.52,Default,,0,0,0,,Watch a new window, zoom to the
Dialogue: 0,0:09:59.52,0:10:00.70,Default,,0,0,0,,correct view, whatever.
Dialogue: 0,0:10:02.00,0:10:03.96,Default,,0,0,0,,There are however some really
Dialogue: 0,0:10:03.96,0:10:04.90,Default,,0,0,0,,sharp corners involved.
Dialogue: 0,0:10:05.19,0:10:06.28,Default,,0,0,0,,Which is that if you were using
Dialogue: 0,0:10:06.28,0:10:07.67,Default,,0,0,0,,the old Spotlight integration,
Dialogue: 0,0:10:07.67,0:10:09.65,Default,,0,0,0,,it's going to be up to you to
Dialogue: 0,0:10:09.65,0:10:12.14,Default,,0,0,0,,delete your old reference files
Dialogue: 0,0:10:12.14,0:10:13.24,Default,,0,0,0,,if you had them on disc, because
Dialogue: 0,0:10:13.24,0:10:14.06,Default,,0,0,0,,we can't know if there was
Dialogue: 0,0:10:14.06,0:10:15.21,Default,,0,0,0,,semantic meaning to those.
Dialogue: 0,0:10:15.21,0:10:18.51,Default,,0,0,0,,And the Core Spotlight API's are
Dialogue: 0,0:10:18.68,0:10:20.16,Default,,0,0,0,,x86 only, which means that this
Dialogue: 0,0:10:20.16,0:10:21.89,Default,,0,0,0,,feature is x86 only.
Dialogue: 0,0:10:21.89,0:10:22.98,Default,,0,0,0,,So it's time to upgrade your
Dialogue: 0,0:10:22.98,0:10:23.71,Default,,0,0,0,,applications people.
Dialogue: 0,0:10:25.28,0:10:27.97,Default,,0,0,0,,And that's Core Spotlight.
Dialogue: 0,0:10:28.30,0:10:30.63,Default,,0,0,0,,We've also added a New Indexing
Dialogue: 0,0:10:30.63,0:10:30.87,Default,,0,0,0,,API.
Dialogue: 0,0:10:32.89,0:10:33.79,Default,,0,0,0,,So what is indexing?
Dialogue: 0,0:10:34.04,0:10:35.27,Default,,0,0,0,,Indexing is a way that allows
Dialogue: 0,0:10:35.27,0:10:36.52,Default,,0,0,0,,you to configure your database
Dialogue: 0,0:10:36.52,0:10:37.43,Default,,0,0,0,,to do faster searching.
Dialogue: 0,0:10:38.46,0:10:40.28,Default,,0,0,0,,You can have multiple indexes,
Dialogue: 0,0:10:40.68,0:10:41.71,Default,,0,0,0,,each of which can have multiple
Dialogue: 0,0:10:41.71,0:10:42.78,Default,,0,0,0,,columns, and a column can
Dialogue: 0,0:10:42.78,0:10:43.86,Default,,0,0,0,,actually belong to multiple
Dialogue: 0,0:10:43.86,0:10:44.43,Default,,0,0,0,,indexes.
Dialogue: 0,0:10:44.43,0:10:45.73,Default,,0,0,0,,So this allows you to set up a
Dialogue: 0,0:10:45.73,0:10:47.51,Default,,0,0,0,,lot of indexes that the database
Dialogue: 0,0:10:47.51,0:10:49.12,Default,,0,0,0,,can use to choose the most
Dialogue: 0,0:10:49.12,0:10:50.64,Default,,0,0,0,,efficient index for whatever
Dialogue: 0,0:10:50.64,0:10:52.35,Default,,0,0,0,,query it's trying to execute.
Dialogue: 0,0:10:52.35,0:10:53.34,Default,,0,0,0,,It will basically look at the
Dialogue: 0,0:10:53.34,0:10:54.72,Default,,0,0,0,,aware clause and say, oh I'm
Dialogue: 0,0:10:54.72,0:10:55.71,Default,,0,0,0,,trying to use these columns I'll
Dialogue: 0,0:10:55.71,0:10:56.90,Default,,0,0,0,,use this index.
Dialogue: 0,0:10:56.90,0:11:00.07,Default,,0,0,0,,And now I'm going to do a little
Dialogue: 0,0:11:00.07,0:11:01.37,Default,,0,0,0,,bit of a digression on indexing
Dialogue: 0,0:11:01.37,0:11:02.42,Default,,0,0,0,,for those of you, you know,
Dialogue: 0,0:11:02.42,0:11:03.26,Default,,0,0,0,,aren't database heads.
Dialogue: 0,0:11:04.14,0:11:05.83,Default,,0,0,0,,The basic form of indexing that
Dialogue: 0,0:11:05.83,0:11:06.77,Default,,0,0,0,,supported everywhere by
Dialogue: 0,0:11:06.77,0:11:08.99,Default,,0,0,0,,everything is a Binary Index.
Dialogue: 0,0:11:09.05,0:11:11.18,Default,,0,0,0,,But these are very strict
Dialogue: 0,0:11:11.18,0:11:11.93,Default,,0,0,0,,comparison only.
Dialogue: 0,0:11:11.93,0:11:13.05,Default,,0,0,0,,They basically look at the bits
Dialogue: 0,0:11:13.05,0:11:14.13,Default,,0,0,0,,and say are these bits the same?
Dialogue: 0,0:11:14.13,0:11:16.12,Default,,0,0,0,,And if not, you know, it's not
Dialogue: 0,0:11:16.12,0:11:18.00,Default,,0,0,0,,an index head.
Dialogue: 0,0:11:18.20,0:11:20.60,Default,,0,0,0,,But over time more types of
Dialogue: 0,0:11:20.60,0:11:22.19,Default,,0,0,0,,indexes have become popular and
Dialogue: 0,0:11:22.19,0:11:22.97,Default,,0,0,0,,something that's really
Dialogue: 0,0:11:22.97,0:11:25.21,Default,,0,0,0,,especially nowadays is super
Dialogue: 0,0:11:25.21,0:11:27.23,Default,,0,0,0,,useful is an RTree Index, which
Dialogue: 0,0:11:27.23,0:11:28.74,Default,,0,0,0,,is a type of index that's
Dialogue: 0,0:11:28.74,0:11:30.22,Default,,0,0,0,,optimized for doing range base
Dialogue: 0,0:11:30.22,0:11:30.60,Default,,0,0,0,,searching.
Dialogue: 0,0:11:30.78,0:11:32.63,Default,,0,0,0,,So a binary index sort of looks
Dialogue: 0,0:11:32.63,0:11:33.05,Default,,0,0,0,,like this.
Dialogue: 0,0:11:33.05,0:11:33.89,Default,,0,0,0,,This is the kind of data you
Dialogue: 0,0:11:33.89,0:11:34.98,Default,,0,0,0,,might have, a bunch of -- you
Dialogue: 0,0:11:34.98,0:11:36.89,Default,,0,0,0,,know, unit dimensional stuff.
Dialogue: 0,0:11:36.89,0:11:38.17,Default,,0,0,0,,And if you build a BTree on it
Dialogue: 0,0:11:38.17,0:11:39.05,Default,,0,0,0,,you end up with something that
Dialogue: 0,0:11:39.05,0:11:40.70,Default,,0,0,0,,looks a lot like this.
Dialogue: 0,0:11:41.53,0:11:43.27,Default,,0,0,0,,You know for every node that all
Dialogue: 0,0:11:43.27,0:11:44.66,Default,,0,0,0,,of the nodes -- child nodes to
Dialogue: 0,0:11:44.66,0:11:47.50,Default,,0,0,0,,the left are smaller valued than
Dialogue: 0,0:11:47.69,0:11:49.56,Default,,0,0,0,,the parent node and all the
Dialogue: 0,0:11:49.86,0:11:51.06,Default,,0,0,0,,nodes to the right are larger
Dialogue: 0,0:11:51.06,0:11:52.35,Default,,0,0,0,,valued and you just navigate
Dialogue: 0,0:11:52.35,0:11:53.29,Default,,0,0,0,,down very, very simply.
Dialogue: 0,0:11:54.06,0:11:55.46,Default,,0,0,0,,But RTree Data often looks a lot
Dialogue: 0,0:11:55.46,0:11:56.33,Default,,0,0,0,,more like this.
Dialogue: 0,0:11:56.33,0:11:57.69,Default,,0,0,0,,You end up having lots of, you
Dialogue: 0,0:11:57.69,0:11:59.37,Default,,0,0,0,,know, odd shapes,
Dialogue: 0,0:11:59.37,0:12:00.70,Default,,0,0,0,,multidimensional things.
Dialogue: 0,0:12:00.91,0:12:02.55,Default,,0,0,0,,They're often overlapping in
Dialogue: 0,0:12:02.55,0:12:03.71,Default,,0,0,0,,weird and odd ways.
Dialogue: 0,0:12:04.10,0:12:05.74,Default,,0,0,0,,And there's no really great way
Dialogue: 0,0:12:05.74,0:12:07.76,Default,,0,0,0,,to organize those in a unit
Dialogue: 0,0:12:07.76,0:12:09.30,Default,,0,0,0,,directional linear Binary tree.
Dialogue: 0,0:12:09.78,0:12:11.72,Default,,0,0,0,,And RTree Data often is stored
Dialogue: 0,0:12:11.72,0:12:12.41,Default,,0,0,0,,more like this.
Dialogue: 0,0:12:12.41,0:12:14.02,Default,,0,0,0,,You have a range zero, which is
Dialogue: 0,0:12:14.02,0:12:15.22,Default,,0,0,0,,the minimum bounding blocks
Dialogue: 0,0:12:15.22,0:12:17.38,Default,,0,0,0,,around all of its subcomponents
Dialogue: 0,0:12:17.46,0:12:19.07,Default,,0,0,0,,or its set elements.
Dialogue: 0,0:12:19.40,0:12:21.11,Default,,0,0,0,,For example range element fully
Dialogue: 0,0:12:21.11,0:12:23.60,Default,,0,0,0,,contains the ranges R6 and R10.
Dialogue: 0,0:12:23.80,0:12:26.51,Default,,0,0,0,,And R6 in turn has a single
Dialogue: 0,0:12:26.51,0:12:28.35,Default,,0,0,0,,child R7, which has more
Dialogue: 0,0:12:28.35,0:12:28.71,Default,,0,0,0,,children.
Dialogue: 0,0:12:28.71,0:12:30.06,Default,,0,0,0,,This is actually a slightly
Dialogue: 0,0:12:30.06,0:12:31.52,Default,,0,0,0,,unbalanced RTree but oh well,
Dialogue: 0,0:12:31.55,0:12:33.68,Default,,0,0,0,,we'll live with it.
Dialogue: 0,0:12:34.52,0:12:36.62,Default,,0,0,0,,The current indexing APIs, well
Dialogue: 0,0:12:36.62,0:12:37.42,Default,,0,0,0,,we have two of them.
Dialogue: 0,0:12:38.05,0:12:40.24,Default,,0,0,0,,You can create a single property
Dialogue: 0,0:12:40.24,0:12:42.49,Default,,0,0,0,,index by calling an NS Attribute
Dialogue: 0,0:12:42.49,0:12:44.02,Default,,0,0,0,,Description is Indexed.
Dialogue: 0,0:12:44.27,0:12:45.65,Default,,0,0,0,,Set that property and we'll
Dialogue: 0,0:12:45.68,0:12:46.61,Default,,0,0,0,,create an index on it.
Dialogue: 0,0:12:46.71,0:12:48.14,Default,,0,0,0,,If you want to do a multi column
Dialogue: 0,0:12:48.14,0:12:49.85,Default,,0,0,0,,index you'll call NS Entity
Dialogue: 0,0:12:49.85,0:12:51.20,Default,,0,0,0,,Description compound Indexes.
Dialogue: 0,0:12:51.57,0:12:52.73,Default,,0,0,0,,And that allows you to create an
Dialogue: 0,0:12:52.73,0:12:53.83,Default,,0,0,0,,index that has, you know, three,
Dialogue: 0,0:12:53.83,0:12:55.02,Default,,0,0,0,,four, five columns in it.
Dialogue: 0,0:12:55.58,0:12:56.79,Default,,0,0,0,,But both of these API's
Dialogue: 0,0:12:56.82,0:12:58.89,Default,,0,0,0,,automatically and only create a
Dialogue: 0,0:12:58.89,0:13:01.54,Default,,0,0,0,,Binary Index in ascending order.
Dialogue: 0,0:13:02.11,0:13:04.38,Default,,0,0,0,,And we kind of wanted to evolve
Dialogue: 0,0:13:04.51,0:13:05.70,Default,,0,0,0,,the Core Data APIs, make them
Dialogue: 0,0:13:05.70,0:13:07.24,Default,,0,0,0,,ore powerful, a lot of them
Dialogue: 0,0:13:07.24,0:13:08.41,Default,,0,0,0,,specifying new and interesting
Dialogue: 0,0:13:08.41,0:13:10.38,Default,,0,0,0,,things, more configurable.
Dialogue: 0,0:13:10.67,0:13:12.40,Default,,0,0,0,,So we've added a bunch of new
Dialogue: 0,0:13:12.40,0:13:13.31,Default,,0,0,0,,model classes.
Dialogue: 0,0:13:14.30,0:13:15.86,Default,,0,0,0,,First is NS Fetch Index
Dialogue: 0,0:13:15.86,0:13:17.92,Default,,0,0,0,,Description, NS Fetch Element
Dialogue: 0,0:13:17.92,0:13:19.52,Default,,0,0,0,,Description, and we've added a
Dialogue: 0,0:13:19.52,0:13:20.76,Default,,0,0,0,,new method on NS Entity
Dialogue: 0,0:13:20.76,0:13:22.65,Default,,0,0,0,,Description indexes which takes
Dialogue: 0,0:13:22.81,0:13:24.39,Default,,0,0,0,,a Fetch Index Description as
Dialogue: 0,0:13:24.39,0:13:26.73,Default,,0,0,0,,it's -- an array of Fetch index
Dialogue: 0,0:13:26.73,0:13:27.92,Default,,0,0,0,,descriptions as its parameter.
Dialogue: 0,0:13:28.77,0:13:29.88,Default,,0,0,0,,And we've added some functions
Dialogue: 0,0:13:29.88,0:13:31.40,Default,,0,0,0,,to control whether the database
Dialogue: 0,0:13:31.40,0:13:32.57,Default,,0,0,0,,should or should not use a
Dialogue: 0,0:13:32.57,0:13:34.32,Default,,0,0,0,,specific index when its
Dialogue: 0,0:13:34.32,0:13:35.58,Default,,0,0,0,,evaluating a given query.
Dialogue: 0,0:13:35.62,0:13:37.77,Default,,0,0,0,,And we've added index by, which
Dialogue: 0,0:13:37.77,0:13:39.09,Default,,0,0,0,,allows you to say, hey really
Dialogue: 0,0:13:39.09,0:13:39.95,Default,,0,0,0,,use this index.
Dialogue: 0,0:13:40.53,0:13:42.41,Default,,0,0,0,,And no index has existed for
Dialogue: 0,0:13:42.41,0:13:43.42,Default,,0,0,0,,awhile and it's a way of saying
Dialogue: 0,0:13:43.92,0:13:45.02,Default,,0,0,0,,I know better than you and I
Dialogue: 0,0:13:45.02,0:13:45.85,Default,,0,0,0,,know better than your query
Dialogue: 0,0:13:45.85,0:13:47.15,Default,,0,0,0,,optimizer, don't use an index
Dialogue: 0,0:13:47.15,0:13:49.35,Default,,0,0,0,,for this specific component of
Dialogue: 0,0:13:49.35,0:13:50.08,Default,,0,0,0,,the where clause.
Dialogue: 0,0:13:50.66,0:13:54.06,Default,,0,0,0,,NS Fetch Index Element
Dialogue: 0,0:13:54.06,0:13:55.46,Default,,0,0,0,,Description is sort of the basic
Dialogue: 0,0:13:55.46,0:13:55.96,Default,,0,0,0,,component.
Dialogue: 0,0:13:55.96,0:13:57.58,Default,,0,0,0,,It allows you to specify an
Dialogue: 0,0:13:58.14,0:13:59.41,Default,,0,0,0,,Index Element, basically a
Dialogue: 0,0:13:59.41,0:14:00.10,Default,,0,0,0,,single property.
Dialogue: 0,0:14:01.01,0:14:02.24,Default,,0,0,0,,You can specify the type of
Dialogue: 0,0:14:02.24,0:14:03.40,Default,,0,0,0,,index that should be created on
Dialogue: 0,0:14:03.40,0:14:04.30,Default,,0,0,0,,that property, whether it's
Dialogue: 0,0:14:04.30,0:14:06.41,Default,,0,0,0,,going to be Binary or an RTree.
Dialogue: 0,0:14:07.07,0:14:08.43,Default,,0,0,0,,And if it's Binary index it also
Dialogue: 0,0:14:08.43,0:14:09.63,Default,,0,0,0,,has you specify a direction,
Dialogue: 0,0:14:09.78,0:14:10.75,Default,,0,0,0,,ascending or descending.
Dialogue: 0,0:14:10.75,0:14:12.66,Default,,0,0,0,,And this can be important if
Dialogue: 0,0:14:12.66,0:14:13.53,Default,,0,0,0,,you're doing certain types of
Dialogue: 0,0:14:13.53,0:14:14.00,Default,,0,0,0,,searches.
Dialogue: 0,0:14:14.00,0:14:14.87,Default,,0,0,0,,For example if you're doing a
Dialogue: 0,0:14:14.87,0:14:16.34,Default,,0,0,0,,male search you want to start
Dialogue: 0,0:14:16.34,0:14:17.72,Default,,0,0,0,,with the most recent data first,
Dialogue: 0,0:14:18.00,0:14:19.15,Default,,0,0,0,,instead of the oldest data
Dialogue: 0,0:14:19.15,0:14:19.60,Default,,0,0,0,,first.
Dialogue: 0,0:14:19.60,0:14:21.64,Default,,0,0,0,,So direction changes the order
Dialogue: 0,0:14:21.64,0:14:24.62,Default,,0,0,0,,in which the database will look
Dialogue: 0,0:14:24.62,0:14:25.87,Default,,0,0,0,,at the contents of the index.
Dialogue: 0,0:14:26.45,0:14:30.44,Default,,0,0,0,,A Fetch Index Description allows
Dialogue: 0,0:14:30.44,0:14:32.07,Default,,0,0,0,,you to combine a bunch of Fetch
Dialogue: 0,0:14:32.07,0:14:33.79,Default,,0,0,0,,Index Elements into a single
Dialogue: 0,0:14:33.79,0:14:35.52,Default,,0,0,0,,index, which you'll give a name
Dialogue: 0,0:14:36.35,0:14:37.96,Default,,0,0,0,,and optionally you can set a
Dialogue: 0,0:14:37.96,0:14:40.49,Default,,0,0,0,,predicate that says only put
Dialogue: 0,0:14:40.49,0:14:41.85,Default,,0,0,0,,rows matching this predicate
Dialogue: 0,0:14:41.85,0:14:42.51,Default,,0,0,0,,into the index.
Dialogue: 0,0:14:43.65,0:14:44.83,Default,,0,0,0,,It also does some validation of
Dialogue: 0,0:14:44.83,0:14:45.96,Default,,0,0,0,,the index composition to make
Dialogue: 0,0:14:45.96,0:14:48.27,Default,,0,0,0,,sure the index you've created is
Dialogue: 0,0:14:48.58,0:14:49.11,Default,,0,0,0,,reasonable.
Dialogue: 0,0:14:49.57,0:14:52.05,Default,,0,0,0,,Some Sharp Corners here, you
Dialogue: 0,0:14:52.05,0:14:53.18,Default,,0,0,0,,can't mix and match element
Dialogue: 0,0:14:53.18,0:14:54.78,Default,,0,0,0,,types right now.
Dialogue: 0,0:14:55.15,0:14:56.38,Default,,0,0,0,,It's either going to be an RTree
Dialogue: 0,0:14:56.56,0:14:57.77,Default,,0,0,0,,or a Binary index.
Dialogue: 0,0:14:58.50,0:15:00.15,Default,,0,0,0,,Range indexes can only be
Dialogue: 0,0:15:00.15,0:15:01.87,Default,,0,0,0,,created on numeric properties
Dialogue: 0,0:15:01.87,0:15:03.41,Default,,0,0,0,,less than or equal to 32 bit.
Dialogue: 0,0:15:03.41,0:15:04.67,Default,,0,0,0,,That's a restriction of the
Dialogue: 0,0:15:04.67,0:15:06.65,Default,,0,0,0,,underlying SQLite database.
Dialogue: 0,0:15:06.87,0:15:08.31,Default,,0,0,0,,If you're creating your own
Dialogue: 0,0:15:08.31,0:15:10.61,Default,,0,0,0,,incremental store and that's a
Dialogue: 0,0:15:10.61,0:15:12.03,Default,,0,0,0,,restriction -- that's a problem
Dialogue: 0,0:15:12.03,0:15:13.01,Default,,0,0,0,,for you, let us know and we'll
Dialogue: 0,0:15:13.01,0:15:13.93,Default,,0,0,0,,see what we can do about it.
Dialogue: 0,0:15:14.42,0:15:17.13,Default,,0,0,0,,But Range -- properties that are
Dialogue: 0,0:15:17.13,0:15:19.31,Default,,0,0,0,,being put in a Ranged Index also
Dialogue: 0,0:15:19.31,0:15:20.03,Default,,0,0,0,,can't be optional.
Dialogue: 0,0:15:20.66,0:15:21.67,Default,,0,0,0,,Range of null is a little bit
Dialogue: 0,0:15:21.67,0:15:23.15,Default,,0,0,0,,undefined right now.
Dialogue: 0,0:15:23.71,0:15:24.68,Default,,0,0,0,,And if you're building your
Dialogue: 0,0:15:24.68,0:15:26.60,Default,,0,0,0,,model in code and we know some
Dialogue: 0,0:15:26.60,0:15:27.50,Default,,0,0,0,,of you do it, and I've helped
Dialogue: 0,0:15:27.50,0:15:29.09,Default,,0,0,0,,some of you at previous WWDC's.
Dialogue: 0,0:15:29.09,0:15:31.64,Default,,0,0,0,,If you change your entities
Dialogue: 0,0:15:31.64,0:15:33.11,Default,,0,0,0,,structurally after you've set
Dialogue: 0,0:15:33.11,0:15:35.14,Default,,0,0,0,,indexes, then we're just going
Dialogue: 0,0:15:35.14,0:15:35.92,Default,,0,0,0,,to drop the index.
Dialogue: 0,0:15:36.13,0:15:37.24,Default,,0,0,0,,And that actually applies for
Dialogue: 0,0:15:37.24,0:15:38.30,Default,,0,0,0,,the entire entity hierarchy.
Dialogue: 0,0:15:38.38,0:15:40.08,Default,,0,0,0,,If you add or remove an entity
Dialogue: 0,0:15:40.08,0:15:41.47,Default,,0,0,0,,in the hierarchy or add or
Dialogue: 0,0:15:41.47,0:15:42.64,Default,,0,0,0,,remove properties on any of
Dialogue: 0,0:15:42.64,0:15:44.28,Default,,0,0,0,,those entities, we can no longer
Dialogue: 0,0:15:44.28,0:15:45.56,Default,,0,0,0,,be sure the index is valid so
Dialogue: 0,0:15:45.56,0:15:46.93,Default,,0,0,0,,we're just going to drop it.
Dialogue: 0,0:15:46.96,0:15:47.53,Default,,0,0,0,,Do it last.
Dialogue: 0,0:15:50.86,0:15:52.54,Default,,0,0,0,,As you may know from previous
Dialogue: 0,0:15:52.67,0:15:55.13,Default,,0,0,0,,versions, changing the indexes
Dialogue: 0,0:15:55.18,0:15:57.41,Default,,0,0,0,,on an entity doesn't actually
Dialogue: 0,0:15:57.41,0:15:58.39,Default,,0,0,0,,change the entities version
Dialogue: 0,0:15:58.39,0:16:00.21,Default,,0,0,0,,Hash, which means that there's
Dialogue: 0,0:16:00.21,0:16:01.99,Default,,0,0,0,,not going to be migration when
Dialogue: 0,0:16:02.61,0:16:05.46,Default,,0,0,0,,the user first launches your new
Dialogue: 0,0:16:05.46,0:16:06.94,Default,,0,0,0,,version of your application with
Dialogue: 0,0:16:07.11,0:16:07.95,Default,,0,0,0,,the new indexes.
Dialogue: 0,0:16:08.44,0:16:09.12,Default,,0,0,0,,So there's not going to be a
Dialogue: 0,0:16:09.12,0:16:09.68,Default,,0,0,0,,performance head.
Dialogue: 0,0:16:09.77,0:16:11.22,Default,,0,0,0,,On the other side it's not going
Dialogue: 0,0:16:11.22,0:16:12.90,Default,,0,0,0,,to cause a migration so they're
Dialogue: 0,0:16:12.90,0:16:13.66,Default,,0,0,0,,not going to get updated
Dialogue: 0,0:16:13.66,0:16:14.08,Default,,0,0,0,,indexes.
Dialogue: 0,0:16:14.08,0:16:16.13,Default,,0,0,0,,If you want to cause the index
Dialogue: 0,0:16:16.19,0:16:17.41,Default,,0,0,0,,of migration to happen and for
Dialogue: 0,0:16:17.41,0:16:18.49,Default,,0,0,0,,the indexes to be updated,
Dialogue: 0,0:16:18.49,0:16:19.73,Default,,0,0,0,,you'll need to call the --
Dialogue: 0,0:16:19.83,0:16:21.24,Default,,0,0,0,,Update the model's version Hash
Dialogue: 0,0:16:21.24,0:16:22.84,Default,,0,0,0,,Identifier and that will trigger
Dialogue: 0,0:16:22.84,0:16:23.41,Default,,0,0,0,,a migration.
Dialogue: 0,0:16:23.45,0:16:25.93,Default,,0,0,0,,The SQL store is going to ignore
Dialogue: 0,0:16:25.93,0:16:26.93,Default,,0,0,0,,any indexes it doesn't
Dialogue: 0,0:16:26.93,0:16:27.51,Default,,0,0,0,,understand.
Dialogue: 0,0:16:27.60,0:16:29.69,Default,,0,0,0,,So what that means is that if
Dialogue: 0,0:16:29.69,0:16:31.01,Default,,0,0,0,,you open your database after you
Dialogue: 0,0:16:31.01,0:16:32.49,Default,,0,0,0,,think you've added indexes and
Dialogue: 0,0:16:32.49,0:16:34.01,Default,,0,0,0,,don't see them, go look at the
Dialogue: 0,0:16:34.01,0:16:35.50,Default,,0,0,0,,application console, it probably
Dialogue: 0,0:16:35.50,0:16:36.49,Default,,0,0,0,,told you why you're not seeing
Dialogue: 0,0:16:36.49,0:16:36.63,Default,,0,0,0,,them.
Dialogue: 0,0:16:37.16,0:16:39.71,Default,,0,0,0,,And I'm going to do another demo
Dialogue: 0,0:16:39.71,0:16:39.96,Default,,0,0,0,,here.
Dialogue: 0,0:16:41.09,0:16:42.04,Default,,0,0,0,,I have a model here.
Dialogue: 0,0:16:42.87,0:16:43.83,Default,,0,0,0,,And I'm actually not going to
Dialogue: 0,0:16:43.83,0:16:46.32,Default,,0,0,0,,work with my live model because
Dialogue: 0,0:16:46.32,0:16:48.13,Default,,0,0,0,,this is a demo and I will
Dialogue: 0,0:16:48.48,0:16:51.31,Default,,0,0,0,,inevitably typo something, but
Dialogue: 0,0:16:51.59,0:16:54.46,Default,,0,0,0,,adding a new index in the new
Dialogue: 0,0:16:54.67,0:16:55.62,Default,,0,0,0,,modeling tools is actually
Dialogue: 0,0:16:55.62,0:16:56.13,Default,,0,0,0,,pretty simple.
Dialogue: 0,0:16:56.25,0:16:57.78,Default,,0,0,0,,You select the entity that you
Dialogue: 0,0:16:57.78,0:16:59.98,Default,,0,0,0,,want to add an index to and just
Dialogue: 0,0:16:59.98,0:17:01.95,Default,,0,0,0,,come down here to add entity and
Dialogue: 0,0:17:01.95,0:17:03.79,Default,,0,0,0,,you can now see that it has an
Dialogue: 0,0:17:03.85,0:17:05.79,Default,,0,0,0,,Add Fetch Index option.
Dialogue: 0,0:17:06.31,0:17:07.84,Default,,0,0,0,,And you just add one, call it by
Dialogue: 0,0:17:07.84,0:17:11.86,Default,,0,0,0,,Location, and I can add a couple
Dialogue: 0,0:17:11.86,0:17:14.34,Default,,0,0,0,,of properties to it here -- the
Dialogue: 0,0:17:14.58,0:17:16.41,Default,,0,0,0,,latitude and longitude
Dialogue: 0,0:17:16.41,0:17:17.01,Default,,0,0,0,,properties.
Dialogue: 0,0:17:18.12,0:17:19.57,Default,,0,0,0,,And if come over here and select
Dialogue: 0,0:17:19.61,0:17:22.29,Default,,0,0,0,,the photo, you'd come in here
Dialogue: 0,0:17:22.29,0:17:23.44,Default,,0,0,0,,and change the Version Hash
Dialogue: 0,0:17:23.56,0:17:24.05,Default,,0,0,0,,Modifier.
Dialogue: 0,0:17:27.05,0:17:29.69,Default,,0,0,0,,And now the next time a user
Dialogue: 0,0:17:29.69,0:17:30.78,Default,,0,0,0,,launches an application that
Dialogue: 0,0:17:30.78,0:17:32.26,Default,,0,0,0,,uses this version of the model,
Dialogue: 0,0:17:32.77,0:17:34.79,Default,,0,0,0,,they're going to be using the
Dialogue: 0,0:17:34.79,0:17:35.70,Default,,0,0,0,,new RTree index.
Dialogue: 0,0:17:35.83,0:17:37.64,Default,,0,0,0,,Of course I am going to just
Dialogue: 0,0:17:37.64,0:17:39.43,Default,,0,0,0,,going to run my demo application
Dialogue: 0,0:17:39.74,0:17:42.73,Default,,0,0,0,,which already had that built in.
Dialogue: 0,0:17:44.62,0:17:44.72,Default,,0,0,0,,And --
Dialogue: 0,0:17:48.59,0:17:49.97,Default,,0,0,0,,-- I'm going to come down here
Dialogue: 0,0:17:50.71,0:17:52.61,Default,,0,0,0,,and grab the Predicate that I
Dialogue: 0,0:17:52.61,0:17:56.96,Default,,0,0,0,,have carefully set aside -- oh I
Dialogue: 0,0:17:56.96,0:17:57.66,Default,,0,0,0,,forgot one thing.
Dialogue: 0,0:17:58.11,0:18:01.56,Default,,0,0,0,,I'm going to come up here and
Dialogue: 0,0:18:01.56,0:18:03.19,Default,,0,0,0,,edit the scheme, because we want
Dialogue: 0,0:18:03.19,0:18:04.62,Default,,0,0,0,,to see what Core Data is sending
Dialogue: 0,0:18:04.62,0:18:05.92,Default,,0,0,0,,to the database.
Dialogue: 0,0:18:06.13,0:18:07.84,Default,,0,0,0,,And I've got the Com Apple SQL
Dialogue: 0,0:18:07.84,0:18:10.07,Default,,0,0,0,,Debug Argument Set.
Dialogue: 0,0:18:10.07,0:18:10.95,Default,,0,0,0,,And you'll notice -- for those
Dialogue: 0,0:18:10.95,0:18:12.49,Default,,0,0,0,,of you who are familiar with SQL
Dialogue: 0,0:18:12.49,0:18:14.80,Default,,0,0,0,,Debug as a feature in Core Data,
Dialogue: 0,0:18:15.45,0:18:16.41,Default,,0,0,0,,you're probably most familiar
Dialogue: 0,0:18:16.41,0:18:19.08,Default,,0,0,0,,with 1 and 2 as the numbers --
Dialogue: 0,0:18:19.18,0:18:20.21,Default,,0,0,0,,the levels you're going to be
Dialogue: 0,0:18:20.21,0:18:20.54,Default,,0,0,0,,setting.
Dialogue: 0,0:18:20.97,0:18:23.07,Default,,0,0,0,,We've added a new level 4, which
Dialogue: 0,0:18:23.07,0:18:24.38,Default,,0,0,0,,will actually print the query
Dialogue: 0,0:18:24.38,0:18:26.54,Default,,0,0,0,,plan that SQLite is using as
Dialogue: 0,0:18:26.54,0:18:27.89,Default,,0,0,0,,well as all of the statements
Dialogue: 0,0:18:28.67,0:18:30.23,Default,,0,0,0,,that Core Data is sending to the
Dialogue: 0,0:18:30.23,0:18:30.82,Default,,0,0,0,,database.
Dialogue: 0,0:18:30.94,0:18:31.89,Default,,0,0,0,,So I'm going to run my
Dialogue: 0,0:18:31.89,0:18:35.21,Default,,0,0,0,,application with that version
Dialogue: 0,0:18:35.21,0:18:35.70,Default,,0,0,0,,set to 4.
Dialogue: 0,0:18:36.96,0:18:42.68,Default,,0,0,0,,Come back, reset that predicate,
Dialogue: 0,0:18:44.42,0:18:45.60,Default,,0,0,0,,and run the search.
Dialogue: 0,0:18:46.22,0:18:49.65,Default,,0,0,0,,And now we can come and we see
Dialogue: 0,0:18:49.74,0:18:50.66,Default,,0,0,0,,the last search.
Dialogue: 0,0:18:51.04,0:18:54.30,Default,,0,0,0,,It's actually kind of more
Dialogue: 0,0:18:54.30,0:18:55.09,Default,,0,0,0,,interesting and I'm going to
Dialogue: 0,0:18:55.09,0:18:57.24,Default,,0,0,0,,come over here and I've actually
Dialogue: 0,0:18:57.37,0:18:58.52,Default,,0,0,0,,copied and pasted an earlier
Dialogue: 0,0:18:58.52,0:19:00.63,Default,,0,0,0,,version into Text Edit, because
Dialogue: 0,0:19:00.63,0:19:01.75,Default,,0,0,0,,I could enlarge the text there.
Dialogue: 0,0:19:03.84,0:19:05.39,Default,,0,0,0,,But you can see I'm now doing a
Dialogue: 0,0:19:05.39,0:19:07.23,Default,,0,0,0,,sub Select against a separate
Dialogue: 0,0:19:07.23,0:19:10.16,Default,,0,0,0,,table, Z Photo by Location.
Dialogue: 0,0:19:11.00,0:19:12.84,Default,,0,0,0,,And if I look down in the query
Dialogue: 0,0:19:12.84,0:19:14.23,Default,,0,0,0,,plan, you can see that this is a
Dialogue: 0,0:19:14.23,0:19:15.41,Default,,0,0,0,,virtual table index.
Dialogue: 0,0:19:15.85,0:19:17.43,Default,,0,0,0,,So that's basically routing the
Dialogue: 0,0:19:17.43,0:19:19.67,Default,,0,0,0,,location query, the latitude
Dialogue: 0,0:19:19.67,0:19:21.59,Default,,0,0,0,,query down onto a separate RTree
Dialogue: 0,0:19:21.59,0:19:21.93,Default,,0,0,0,,table.
Dialogue: 0,0:19:22.93,0:19:24.28,Default,,0,0,0,,And well, we can see up here
Dialogue: 0,0:19:24.28,0:19:26.43,Default,,0,0,0,,that it says it took 0.056
Dialogue: 0,0:19:26.43,0:19:27.84,Default,,0,0,0,,seconds for 16 rows.
Dialogue: 0,0:19:27.92,0:19:29.48,Default,,0,0,0,,And if I go compare this to the
Dialogue: 0,0:19:29.48,0:19:31.87,Default,,0,0,0,,version without the RTree, well
Dialogue: 0,0:19:31.87,0:19:33.55,Default,,0,0,0,,there's the query we were
Dialogue: 0,0:19:33.55,0:19:34.93,Default,,0,0,0,,originally doing, Z Longitude
Dialogue: 0,0:19:34.93,0:19:36.28,Default,,0,0,0,,between this and this.
Dialogue: 0,0:19:37.20,0:19:38.77,Default,,0,0,0,,And we can see that it took
Dialogue: 0,0:19:38.96,0:19:41.91,Default,,0,0,0,,0.062 seconds for 16 rows.
Dialogue: 0,0:19:41.91,0:19:42.93,Default,,0,0,0,,So you got to do about a 10
Dialogue: 0,0:19:42.93,0:19:44.18,Default,,0,0,0,,percent performance improvement
Dialogue: 0,0:19:44.22,0:19:47.10,Default,,0,0,0,,on a laptop with an SSD Fast
Dialogue: 0,0:19:47.10,0:19:48.61,Default,,0,0,0,,Cash, all that kind of stuff.
Dialogue: 0,0:19:48.61,0:19:49.39,Default,,0,0,0,,So it's about a 10 percent
Dialogue: 0,0:19:49.39,0:19:50.71,Default,,0,0,0,,improvement your devices are
Dialogue: 0,0:19:50.71,0:19:51.76,Default,,0,0,0,,actually going to -- and it's
Dialogue: 0,0:19:51.76,0:19:52.93,Default,,0,0,0,,also a very small data set.
Dialogue: 0,0:19:53.21,0:19:54.49,Default,,0,0,0,,Your devices with a larger data
Dialogue: 0,0:19:54.49,0:19:55.36,Default,,0,0,0,,set are really going to
Dialogue: 0,0:19:55.36,0:19:57.30,Default,,0,0,0,,appreciate having RTree's to
Dialogue: 0,0:19:57.30,0:19:58.57,Default,,0,0,0,,search against instead of
Dialogue: 0,0:19:58.73,0:19:59.98,Default,,0,0,0,,regular Binary Indexes.
Dialogue: 0,0:20:01.10,0:20:01.76,Default,,0,0,0,,And --
Dialogue: 0,0:20:04.12,0:20:05.33,Default,,0,0,0,,I think I'm done here.
Dialogue: 0,0:20:06.79,0:20:11.70,Default,,0,0,0,,So that is RTree searching.
Dialogue: 0,0:20:12.82,0:20:14.24,Default,,0,0,0,,I have one more slide before I
Dialogue: 0,0:20:14.24,0:20:15.30,Default,,0,0,0,,hand you over to Rishi.
Dialogue: 0,0:20:15.89,0:20:16.66,Default,,0,0,0,,We've also added some
Dialogue: 0,0:20:16.66,0:20:17.86,Default,,0,0,0,,miscellaneous new stuff.
Dialogue: 0,0:20:19.76,0:20:21.54,Default,,0,0,0,,Basically new attribute types.
Dialogue: 0,0:20:21.54,0:20:23.82,Default,,0,0,0,,We've added NSUUIDA Attribute
Dialogue: 0,0:20:23.82,0:20:25.81,Default,,0,0,0,,Type and a NSURL Attribute type
Dialogue: 0,0:20:25.81,0:20:28.10,Default,,0,0,0,,backed by the UUID and URL value
Dialogue: 0,0:20:28.10,0:20:28.98,Default,,0,0,0,,classes respectively.
Dialogue: 0,0:20:29.52,0:20:33.55,Default,,0,0,0,,[ Applause ]
Dialogue: 0,0:20:34.05,0:20:35.09,Default,,0,0,0,,You appreciate the work we do.
Dialogue: 0,0:20:35.55,0:20:36.20,Default,,0,0,0,,That makes us feel good.
Dialogue: 0,0:20:36.20,0:20:37.84,Default,,0,0,0,,And now I'm going to hand you
Dialogue: 0,0:20:37.84,0:20:38.13,Default,,0,0,0,,over --
Dialogue: 0,0:20:41.23,0:20:41.84,Default,,0,0,0,,>> Thank you.
Dialogue: 0,0:20:42.52,0:20:47.04,Default,,0,0,0,,[ Applause ]
Dialogue: 0,0:20:47.54,0:20:49.05,Default,,0,0,0,,>> Hi everybody I'm Rishi Verma
Dialogue: 0,0:20:49.05,0:20:49.86,Default,,0,0,0,,and I'll be showing you
Dialogue: 0,0:20:49.90,0:20:51.03,Default,,0,0,0,,Persistent History Tracking.
Dialogue: 0,0:20:52.63,0:20:53.94,Default,,0,0,0,,So let's talk a little bit about
Dialogue: 0,0:20:53.94,0:20:54.32,Default,,0,0,0,,your app.
Dialogue: 0,0:20:54.95,0:20:55.78,Default,,0,0,0,,So you've developed these
Dialogue: 0,0:20:55.78,0:20:57.34,Default,,0,0,0,,amazing apps and hopefully
Dialogue: 0,0:20:57.34,0:20:58.71,Default,,0,0,0,,you've adopted the NS Persistent
Dialogue: 0,0:20:58.71,0:21:00.00,Default,,0,0,0,,Container we introduced last
Dialogue: 0,0:21:00.00,0:21:00.31,Default,,0,0,0,,release.
Dialogue: 0,0:21:00.53,0:21:01.83,Default,,0,0,0,,So you've got a View Context set
Dialogue: 0,0:21:01.83,0:21:03.45,Default,,0,0,0,,up and a Background Context.
Dialogue: 0,0:21:04.24,0:21:05.76,Default,,0,0,0,,And you've got a Shared
Dialogue: 0,0:21:05.76,0:21:07.14,Default,,0,0,0,,Container where you've set up
Dialogue: 0,0:21:07.14,0:21:07.91,Default,,0,0,0,,your Persistent Store.
Dialogue: 0,0:21:09.12,0:21:10.42,Default,,0,0,0,,Now your view context is one
Dialogue: 0,0:21:10.42,0:21:11.70,Default,,0,0,0,,connection and your background
Dialogue: 0,0:21:11.70,0:21:12.64,Default,,0,0,0,,context is another.
Dialogue: 0,0:21:13.15,0:21:14.34,Default,,0,0,0,,And maybe you've got your
Dialogue: 0,0:21:14.34,0:21:16.56,Default,,0,0,0,,background context downloading
Dialogue: 0,0:21:16.56,0:21:18.34,Default,,0,0,0,,contend from the remote site
Dialogue: 0,0:21:18.34,0:21:19.10,Default,,0,0,0,,that you have set up.
Dialogue: 0,0:21:20.64,0:21:22.05,Default,,0,0,0,,Now you're a very diligent
Dialogue: 0,0:21:22.05,0:21:23.32,Default,,0,0,0,,developer and you've gone out
Dialogue: 0,0:21:23.32,0:21:24.72,Default,,0,0,0,,and created a Document
Dialogue: 0,0:21:24.72,0:21:26.69,Default,,0,0,0,,Extension, a Shared Extension,
Dialogue: 0,0:21:27.09,0:21:28.37,Default,,0,0,0,,and a Photo Editing Extension.
Dialogue: 0,0:21:28.72,0:21:30.03,Default,,0,0,0,,Now all of these connections to
Dialogue: 0,0:21:30.03,0:21:31.60,Default,,0,0,0,,your persistent store could be
Dialogue: 0,0:21:31.60,0:21:34.07,Default,,0,0,0,,running in any process since
Dialogue: 0,0:21:34.07,0:21:35.46,Default,,0,0,0,,they're extensions, or they
Dialogue: 0,0:21:35.46,0:21:36.51,Default,,0,0,0,,could be coming from our app
Dialogue: 0,0:21:36.51,0:21:37.53,Default,,0,0,0,,from various context.
Dialogue: 0,0:21:37.92,0:21:39.15,Default,,0,0,0,,And you may not know exactly
Dialogue: 0,0:21:39.15,0:21:40.40,Default,,0,0,0,,where this data is coming from.
Dialogue: 0,0:21:40.58,0:21:42.31,Default,,0,0,0,,Well, let's break it down a
Dialogue: 0,0:21:42.31,0:21:44.63,Default,,0,0,0,,little bit and see what happens.
Dialogue: 0,0:21:45.87,0:21:49.96,Default,,0,0,0,,So sorry, so here we are in your
Dialogue: 0,0:21:49.96,0:21:53.43,Default,,0,0,0,,app and the user is looking at
Dialogue: 0,0:21:53.43,0:21:55.10,Default,,0,0,0,,your view context and in the
Dialogue: 0,0:21:55.10,0:21:56.58,Default,,0,0,0,,meantime your background context
Dialogue: 0,0:21:56.58,0:21:58.42,Default,,0,0,0,,is downloading info from some
Dialogue: 0,0:21:58.42,0:21:59.06,Default,,0,0,0,,remote source.
Dialogue: 0,0:21:59.68,0:22:01.41,Default,,0,0,0,,Unfortunately a common thing
Dialogue: 0,0:22:01.41,0:22:02.41,Default,,0,0,0,,that we've seen is that your
Dialogue: 0,0:22:02.41,0:22:03.62,Default,,0,0,0,,Background Context may be
Dialogue: 0,0:22:03.62,0:22:05.69,Default,,0,0,0,,ingesting and your View Context
Dialogue: 0,0:22:06.07,0:22:07.05,Default,,0,0,0,,may not know about these
Dialogue: 0,0:22:07.05,0:22:09.14,Default,,0,0,0,,objects, or it may not even care
Dialogue: 0,0:22:09.14,0:22:09.94,Default,,0,0,0,,about these objects.
Dialogue: 0,0:22:10.42,0:22:11.77,Default,,0,0,0,,But as your Save Notifications
Dialogue: 0,0:22:11.77,0:22:13.27,Default,,0,0,0,,come in, you're ingesting them
Dialogue: 0,0:22:13.27,0:22:13.72,Default,,0,0,0,,anyways.
Dialogue: 0,0:22:14.50,0:22:16.76,Default,,0,0,0,,And so you're going to be
Dialogue: 0,0:22:16.76,0:22:18.09,Default,,0,0,0,,missing some changes, if you
Dialogue: 0,0:22:18.09,0:22:19.32,Default,,0,0,0,,missed out new Background
Dialogue: 0,0:22:19.32,0:22:20.67,Default,,0,0,0,,Context, because they're really
Dialogue: 0,0:22:20.67,0:22:21.74,Default,,0,0,0,,easy to generate at this time
Dialogue: 0,0:22:22.15,0:22:23.52,Default,,0,0,0,,but you may miss out on Batch
Dialogue: 0,0:22:23.52,0:22:25.30,Default,,0,0,0,,Updates, Batch Deletes, which
Dialogue: 0,0:22:25.30,0:22:26.18,Default,,0,0,0,,don't generate a Save
Dialogue: 0,0:22:26.18,0:22:26.83,Default,,0,0,0,,notification.
Dialogue: 0,0:22:27.64,0:22:30.63,Default,,0,0,0,,Now the user's gone into Safari
Dialogue: 0,0:22:31.09,0:22:32.43,Default,,0,0,0,,and decided to share something.
Dialogue: 0,0:22:33.15,0:22:35.36,Default,,0,0,0,,This writes to the database and
Dialogue: 0,0:22:35.36,0:22:36.60,Default,,0,0,0,,when you're developer comes back
Dialogue: 0,0:22:36.60,0:22:38.31,Default,,0,0,0,,to the app -- or when you're
Dialogue: 0,0:22:38.31,0:22:39.56,Default,,0,0,0,,user comes back to the app, you
Dialogue: 0,0:22:39.56,0:22:41.08,Default,,0,0,0,,don't know what's changed.
Dialogue: 0,0:22:41.65,0:22:42.79,Default,,0,0,0,,You know something's changed,
Dialogue: 0,0:22:42.79,0:22:44.73,Default,,0,0,0,,but what exactly you don't know.
Dialogue: 0,0:22:45.12,0:22:46.27,Default,,0,0,0,,And so you have to rescan the
Dialogue: 0,0:22:46.27,0:22:48.02,Default,,0,0,0,,entire database and see what has
Dialogue: 0,0:22:48.11,0:22:49.13,Default,,0,0,0,,changed since you last were
Dialogue: 0,0:22:49.13,0:22:49.31,Default,,0,0,0,,there.
Dialogue: 0,0:22:50.65,0:22:52.43,Default,,0,0,0,,And unfortunately sometimes our
Dialogue: 0,0:22:52.43,0:22:52.99,Default,,0,0,0,,apps crash.
Dialogue: 0,0:22:53.13,0:22:55.51,Default,,0,0,0,,It may be due to the user
Dialogue: 0,0:22:56.12,0:22:57.52,Default,,0,0,0,,quitting your app while a
Dialogue: 0,0:22:57.52,0:22:58.89,Default,,0,0,0,,Background Contact was going.
Dialogue: 0,0:22:59.31,0:23:00.54,Default,,0,0,0,,And when your app comes back up,
Dialogue: 0,0:23:00.99,0:23:02.47,Default,,0,0,0,,your Background Context doesn't
Dialogue: 0,0:23:02.47,0:23:03.78,Default,,0,0,0,,know necessarily where it left
Dialogue: 0,0:23:03.78,0:23:05.18,Default,,0,0,0,,off, scanning your local
Dialogue: 0,0:23:05.18,0:23:05.62,Default,,0,0,0,,database.
Dialogue: 0,0:23:05.79,0:23:07.13,Default,,0,0,0,,So it'll have to check with
Dialogue: 0,0:23:07.13,0:23:08.70,Default,,0,0,0,,remote content and rescan the
Dialogue: 0,0:23:08.70,0:23:10.48,Default,,0,0,0,,entire local database to see
Dialogue: 0,0:23:10.48,0:23:11.70,Default,,0,0,0,,where it needs to be picked up
Dialogue: 0,0:23:11.70,0:23:12.05,Default,,0,0,0,,again.
Dialogue: 0,0:23:12.59,0:23:15.17,Default,,0,0,0,,Let's break this example down
Dialogue: 0,0:23:15.17,0:23:15.92,Default,,0,0,0,,just a little bit more.
Dialogue: 0,0:23:16.65,0:23:18.32,Default,,0,0,0,,So we have an app, and it
Dialogue: 0,0:23:18.32,0:23:19.55,Default,,0,0,0,,decides to load some data.
Dialogue: 0,0:23:19.99,0:23:21.24,Default,,0,0,0,,So the Background Context loads
Dialogue: 0,0:23:21.24,0:23:23.06,Default,,0,0,0,,some data and the View Context
Dialogue: 0,0:23:23.59,0:23:24.21,Default,,0,0,0,,gets updated.
Dialogue: 0,0:23:24.97,0:23:26.18,Default,,0,0,0,,Now when the user suspends the
Dialogue: 0,0:23:26.18,0:23:28.21,Default,,0,0,0,,app, and the document extension
Dialogue: 0,0:23:28.21,0:23:30.51,Default,,0,0,0,,comes up, we'll see that data
Dialogue: 0,0:23:30.51,0:23:31.82,Default,,0,0,0,,inserts two new objects.
Dialogue: 0,0:23:33.07,0:23:34.46,Default,,0,0,0,,And then my Share Extension
Dialogue: 0,0:23:34.46,0:23:36.61,Default,,0,0,0,,comes along, updates an object
Dialogue: 0,0:23:36.61,0:23:37.56,Default,,0,0,0,,and inserts another one.
Dialogue: 0,0:23:38.10,0:23:39.84,Default,,0,0,0,,And so does my Photos Extension.
Dialogue: 0,0:23:41.05,0:23:43.47,Default,,0,0,0,,Once all of these are done I'll
Dialogue: 0,0:23:43.47,0:23:45.61,Default,,0,0,0,,come back to my app and notice
Dialogue: 0,0:23:45.72,0:23:49.57,Default,,0,0,0,,that some of the data is stale.
Dialogue: 0,0:23:50.45,0:23:53.87,Default,,0,0,0,,So our app here only knows about
Dialogue: 0,0:23:53.87,0:23:55.03,Default,,0,0,0,,these original six objects.
Dialogue: 0,0:23:55.48,0:23:56.64,Default,,0,0,0,,The rest of the database is
Dialogue: 0,0:23:56.64,0:23:58.93,Default,,0,0,0,,actually modified or it actually
Dialogue: 0,0:23:58.93,0:23:59.66,Default,,0,0,0,,doesn't know about these
Dialogue: 0,0:23:59.66,0:24:00.11,Default,,0,0,0,,objects.
Dialogue: 0,0:24:00.94,0:24:02.52,Default,,0,0,0,,So it has to go through and scan
Dialogue: 0,0:24:02.52,0:24:03.56,Default,,0,0,0,,everything and see what's
Dialogue: 0,0:24:03.56,0:24:05.79,Default,,0,0,0,,relevant to that View Context or
Dialogue: 0,0:24:05.79,0:24:07.66,Default,,0,0,0,,that Background Context.
Dialogue: 0,0:24:09.68,0:24:11.09,Default,,0,0,0,,Now we've introduced NS
Dialogue: 0,0:24:11.20,0:24:12.05,Default,,0,0,0,,Persistent History.
Dialogue: 0,0:24:12.05,0:24:13.48,Default,,0,0,0,,It's rather simple.
Dialogue: 0,0:24:14.85,0:24:17.00,Default,,0,0,0,,Grab your Container, grab your
Dialogue: 0,0:24:17.00,0:24:21.20,Default,,0,0,0,,Store Description and voila.
Dialogue: 0,0:24:22.86,0:24:24.34,Default,,0,0,0,,Set the option NS Persistent
Dialogue: 0,0:24:24.34,0:24:26.48,Default,,0,0,0,,History Tracking to true and we
Dialogue: 0,0:24:26.48,0:24:28.04,Default,,0,0,0,,will now track all of your
Dialogue: 0,0:24:28.04,0:24:28.95,Default,,0,0,0,,changes to your database.
Dialogue: 0,0:24:29.04,0:24:32.04,Default,,0,0,0,,So let's go back to that
Dialogue: 0,0:24:32.04,0:24:32.94,Default,,0,0,0,,previous-- thank you.
Dialogue: 0,0:24:33.52,0:24:36.86,Default,,0,0,0,,[ Applause ]
Dialogue: 0,0:24:37.36,0:24:38.28,Default,,0,0,0,,So we'll go back to that
Dialogue: 0,0:24:38.28,0:24:39.04,Default,,0,0,0,,previous example.
Dialogue: 0,0:24:39.34,0:24:41.04,Default,,0,0,0,,And now in my View Context and
Dialogue: 0,0:24:41.04,0:24:42.54,Default,,0,0,0,,Background Context load data,
Dialogue: 0,0:24:43.43,0:24:44.98,Default,,0,0,0,,we'll see that it happens within
Dialogue: 0,0:24:45.11,0:24:46.38,Default,,0,0,0,,a transaction.
Dialogue: 0,0:24:46.86,0:24:48.12,Default,,0,0,0,,And this transaction's written
Dialogue: 0,0:24:48.12,0:24:48.78,Default,,0,0,0,,to my database.
Dialogue: 0,0:24:49.22,0:24:50.33,Default,,0,0,0,,And I can see that it was done
Dialogue: 0,0:24:50.33,0:24:52.62,Default,,0,0,0,,by the Background Context and in
Dialogue: 0,0:24:52.62,0:24:52.99,Default,,0,0,0,,my app.
Dialogue: 0,0:24:54.20,0:24:55.92,Default,,0,0,0,,Now when I hop out of my app and
Dialogue: 0,0:24:55.92,0:24:57.45,Default,,0,0,0,,the user goes into a Document
Dialogue: 0,0:24:57.45,0:24:57.93,Default,,0,0,0,,Extension --
Dialogue: 0,0:25:02.04,0:25:03.13,Default,,0,0,0,,We'll see that this also
Dialogue: 0,0:25:03.16,0:25:06.91,Default,,0,0,0,,generates a transaction and so
Dialogue: 0,0:25:06.91,0:25:08.14,Default,,0,0,0,,on with my share extension.
Dialogue: 0,0:25:08.71,0:25:12.88,Default,,0,0,0,,And also the Share Extension
Dialogue: 0,0:25:12.88,0:25:13.91,Default,,0,0,0,,will note that there was a
Dialogue: 0,0:25:13.91,0:25:17.43,Default,,0,0,0,,modification and not an insert
Dialogue: 0,0:25:17.43,0:25:17.62,Default,,0,0,0,,here.
Dialogue: 0,0:25:18.55,0:25:20.27,Default,,0,0,0,,And now with a Photos Extension
Dialogue: 0,0:25:20.37,0:25:21.44,Default,,0,0,0,,we'll also see the fourth
Dialogue: 0,0:25:21.44,0:25:24.11,Default,,0,0,0,,transaction come in and we'll
Dialogue: 0,0:25:24.11,0:25:25.33,Default,,0,0,0,,see that it was done in photos.
Dialogue: 0,0:25:25.33,0:25:28.51,Default,,0,0,0,,So now when my app is being
Dialogue: 0,0:25:28.51,0:25:29.74,Default,,0,0,0,,brought back to the foreground,
Dialogue: 0,0:25:30.36,0:25:31.88,Default,,0,0,0,,I do still have still data, but
Dialogue: 0,0:25:31.88,0:25:33.37,Default,,0,0,0,,now I know where I am in the
Dialogue: 0,0:25:33.37,0:25:35.43,Default,,0,0,0,,history table and can simply go
Dialogue: 0,0:25:35.43,0:25:37.22,Default,,0,0,0,,from transaction 1 to 4.
Dialogue: 0,0:25:37.84,0:25:39.31,Default,,0,0,0,,And voila I've updated.
Dialogue: 0,0:25:42.62,0:25:45.33,Default,,0,0,0,,So we've introduced a new Store
Dialogue: 0,0:25:45.33,0:25:46.51,Default,,0,0,0,,Request for you to fetch your
Dialogue: 0,0:25:46.51,0:25:46.88,Default,,0,0,0,,history.
Dialogue: 0,0:25:47.44,0:25:48.63,Default,,0,0,0,,It's called NS Persistent
Dialogue: 0,0:25:48.69,0:25:49.73,Default,,0,0,0,,History Change Request.
Dialogue: 0,0:25:50.43,0:25:52.23,Default,,0,0,0,,You can simply start it up with
Dialogue: 0,0:25:52.23,0:25:54.80,Default,,0,0,0,,either a date, a token, or a
Dialogue: 0,0:25:54.80,0:25:55.43,Default,,0,0,0,,transaction.
Dialogue: 0,0:25:56.02,0:25:59.04,Default,,0,0,0,,And you can simply set the
Dialogue: 0,0:25:59.04,0:25:59.99,Default,,0,0,0,,result type as well.
Dialogue: 0,0:26:00.52,0:26:02.74,Default,,0,0,0,,As simple as a status, the count
Dialogue: 0,0:26:02.74,0:26:04.02,Default,,0,0,0,,of change is available.
Dialogue: 0,0:26:04.07,0:26:05.62,Default,,0,0,0,,Or you can get nitty-gritty and
Dialogue: 0,0:26:05.62,0:26:07.31,Default,,0,0,0,,get all the transactions and all
Dialogue: 0,0:26:07.31,0:26:07.84,Default,,0,0,0,,the changes.
Dialogue: 0,0:26:09.68,0:26:11.38,Default,,0,0,0,,Also with a change request we
Dialogue: 0,0:26:11.38,0:26:12.94,Default,,0,0,0,,allow you to purge your history.
Dialogue: 0,0:26:13.49,0:26:15.78,Default,,0,0,0,,So we want you to start this off
Dialogue: 0,0:26:15.83,0:26:17.30,Default,,0,0,0,,and you can delete the history
Dialogue: 0,0:26:17.30,0:26:19.72,Default,,0,0,0,,prior to date, a token, or a
Dialogue: 0,0:26:19.72,0:26:20.40,Default,,0,0,0,,transaction.
Dialogue: 0,0:26:21.13,0:26:23.04,Default,,0,0,0,,Now your Persistent History is
Dialogue: 0,0:26:23.04,0:26:25.18,Default,,0,0,0,,linear so this way it will keep
Dialogue: 0,0:26:25.18,0:26:25.64,Default,,0,0,0,,it short.
Dialogue: 0,0:26:26.37,0:26:29.09,Default,,0,0,0,,One of the caveats we want you
Dialogue: 0,0:26:29.09,0:26:30.39,Default,,0,0,0,,to keep in mind when pruning
Dialogue: 0,0:26:30.39,0:26:32.00,Default,,0,0,0,,your history is that you should
Dialogue: 0,0:26:32.00,0:26:33.25,Default,,0,0,0,,have a gatekeeper.
Dialogue: 0,0:26:34.37,0:26:36.04,Default,,0,0,0,,Single place where this should
Dialogue: 0,0:26:36.04,0:26:37.64,Default,,0,0,0,,be done so that it knows that
Dialogue: 0,0:26:37.64,0:26:38.88,Default,,0,0,0,,you've consumed the history you
Dialogue: 0,0:26:38.88,0:26:40.78,Default,,0,0,0,,need, your clients have consumed
Dialogue: 0,0:26:40.78,0:26:43.08,Default,,0,0,0,,it, and you no longer are
Dialogue: 0,0:26:43.08,0:26:44.16,Default,,0,0,0,,removing anything that is
Dialogue: 0,0:26:44.16,0:26:46.04,Default,,0,0,0,,relevant to someone else in your
Dialogue: 0,0:26:46.12,0:26:47.42,Default,,0,0,0,,app, all right?
Dialogue: 0,0:26:47.42,0:26:48.32,Default,,0,0,0,,And then now we have NS
Dialogue: 0,0:26:48.32,0:26:50.03,Default,,0,0,0,,Persistent History Transaction.
Dialogue: 0,0:26:50.77,0:26:52.72,Default,,0,0,0,,This is a large data blob that
Dialogue: 0,0:26:52.80,0:26:55.52,Default,,0,0,0,,covers who did the transaction
Dialogue: 0,0:26:55.52,0:26:56.11,Default,,0,0,0,,to your database.
Dialogue: 0,0:26:56.54,0:26:57.38,Default,,0,0,0,,So as you can see we have a
Dialogue: 0,0:26:57.38,0:27:00.32,Default,,0,0,0,,Store ID, a Bundle ID, a Process
Dialogue: 0,0:27:00.32,0:27:02.21,Default,,0,0,0,,ID, but we also have a Token.
Dialogue: 0,0:27:02.58,0:27:05.61,Default,,0,0,0,,Since your history is linear, we
Dialogue: 0,0:27:05.61,0:27:07.31,Default,,0,0,0,,provide you a Token that you can
Dialogue: 0,0:27:07.31,0:27:08.92,Default,,0,0,0,,encode to disc, so that when
Dialogue: 0,0:27:08.92,0:27:10.58,Default,,0,0,0,,your app exits you can keep
Dialogue: 0,0:27:10.58,0:27:12.28,Default,,0,0,0,,track of where your app was in
Dialogue: 0,0:27:12.28,0:27:12.79,Default,,0,0,0,,the history.
Dialogue: 0,0:27:13.41,0:27:15.06,Default,,0,0,0,,Simply re-launch your app, pull
Dialogue: 0,0:27:15.06,0:27:16.37,Default,,0,0,0,,your token, and fetch your
Dialogue: 0,0:27:16.37,0:27:17.65,Default,,0,0,0,,history based on that and you're
Dialogue: 0,0:27:17.65,0:27:18.15,Default,,0,0,0,,good to go.
Dialogue: 0,0:27:19.52,0:27:21.62,Default,,0,0,0,,Now, also in the transaction we
Dialogue: 0,0:27:21.62,0:27:24.36,Default,,0,0,0,,allow you -- the author, we want
Dialogue: 0,0:27:24.36,0:27:25.68,Default,,0,0,0,,you to go onto your Manage
Dialogue: 0,0:27:25.68,0:27:28.25,Default,,0,0,0,,Object Context and tell us who
Dialogue: 0,0:27:28.25,0:27:30.30,Default,,0,0,0,,is the author of this context
Dialogue: 0,0:27:30.30,0:27:32.46,Default,,0,0,0,,and this Save Batch Update or
Dialogue: 0,0:27:32.46,0:27:33.12,Default,,0,0,0,,Batch Delete.
Dialogue: 0,0:27:34.06,0:27:36.27,Default,,0,0,0,,And so we also allow you to go
Dialogue: 0,0:27:36.27,0:27:37.92,Default,,0,0,0,,onto the Manage Object Context
Dialogue: 0,0:27:38.23,0:27:39.59,Default,,0,0,0,,and set the Transaction Author.
Dialogue: 0,0:27:40.68,0:27:41.97,Default,,0,0,0,,Do this before your save or
Dialogue: 0,0:27:41.97,0:27:43.60,Default,,0,0,0,,executing a request and we'll
Dialogue: 0,0:27:43.60,0:27:45.14,Default,,0,0,0,,take this string, put in a
Dialogue: 0,0:27:45.14,0:27:46.96,Default,,0,0,0,,transaction, so you can identify
Dialogue: 0,0:27:47.37,0:27:48.93,Default,,0,0,0,,who did what to your database at
Dialogue: 0,0:27:48.93,0:27:50.24,Default,,0,0,0,,a later time.
Dialogue: 0,0:27:51.93,0:27:53.52,Default,,0,0,0,,And as part of every transaction
Dialogue: 0,0:27:53.52,0:27:54.59,Default,,0,0,0,,there is a set of changes.
Dialogue: 0,0:27:55.25,0:27:57.01,Default,,0,0,0,,A change represents a single
Dialogue: 0,0:27:57.08,0:27:58.13,Default,,0,0,0,,thing that was done to one
Dialogue: 0,0:27:58.13,0:27:58.64,Default,,0,0,0,,object.
Dialogue: 0,0:27:58.69,0:27:59.98,Default,,0,0,0,,So they'll be many changes for
Dialogue: 0,0:27:59.98,0:28:03.17,Default,,0,0,0,,every transaction and here we'll
Dialogue: 0,0:28:03.17,0:28:05.06,Default,,0,0,0,,have inserts, and updates, and
Dialogue: 0,0:28:05.06,0:28:05.37,Default,,0,0,0,,deletes.
Dialogue: 0,0:28:05.91,0:28:07.37,Default,,0,0,0,,In the case of an update, we'll
Dialogue: 0,0:28:07.41,0:28:08.95,Default,,0,0,0,,tell you which properties were
Dialogue: 0,0:28:08.95,0:28:11.37,Default,,0,0,0,,updated -- either attributes or
Dialogue: 0,0:28:11.37,0:28:13.52,Default,,0,0,0,,relationships, and then in the
Dialogue: 0,0:28:13.52,0:28:17.73,Default,,0,0,0,,case of a delete we'll tell you
Dialogue: 0,0:28:17.73,0:28:18.75,Default,,0,0,0,,what the tombstone is.
Dialogue: 0,0:28:19.28,0:28:20.38,Default,,0,0,0,,It's a set of attributes that
Dialogue: 0,0:28:20.38,0:28:21.88,Default,,0,0,0,,you can set in the model editor
Dialogue: 0,0:28:22.21,0:28:23.47,Default,,0,0,0,,that allow you to identify the
Dialogue: 0,0:28:23.47,0:28:24.61,Default,,0,0,0,,object post mortem.
Dialogue: 0,0:28:25.23,0:28:26.32,Default,,0,0,0,,It's no longer in your database
Dialogue: 0,0:28:26.41,0:28:28.00,Default,,0,0,0,,so the object ID isn't as
Dialogue: 0,0:28:28.06,0:28:30.11,Default,,0,0,0,,relevant anymore, but with a
Dialogue: 0,0:28:30.11,0:28:31.65,Default,,0,0,0,,tombstone you can still identify
Dialogue: 0,0:28:31.65,0:28:34.21,Default,,0,0,0,,that object and be able to
Dialogue: 0,0:28:34.21,0:28:35.38,Default,,0,0,0,,process it later.
Dialogue: 0,0:28:36.53,0:28:38.13,Default,,0,0,0,,Now here we are in the model
Dialogue: 0,0:28:38.13,0:28:38.57,Default,,0,0,0,,editor.
Dialogue: 0,0:28:42.45,0:28:44.09,Default,,0,0,0,,And I have a unique identifier
Dialogue: 0,0:28:44.09,0:28:44.66,Default,,0,0,0,,for this entity.
Dialogue: 0,0:28:44.66,0:28:45.90,Default,,0,0,0,,And it would be great if I could
Dialogue: 0,0:28:45.90,0:28:46.44,Default,,0,0,0,,tombstone it.
Dialogue: 0,0:28:46.71,0:28:49.24,Default,,0,0,0,,So we simply go in and mark it
Dialogue: 0,0:28:49.37,0:28:50.49,Default,,0,0,0,,Preserve After Deletion.
Dialogue: 0,0:28:51.37,0:28:52.40,Default,,0,0,0,,And it's that simple and it will
Dialogue: 0,0:28:52.40,0:28:53.35,Default,,0,0,0,,show up in my tombstone.
Dialogue: 0,0:28:55.90,0:28:56.92,Default,,0,0,0,,And so with that I'd like to
Dialogue: 0,0:28:56.92,0:28:57.82,Default,,0,0,0,,show you a quick Demo.
Dialogue: 0,0:28:58.67,0:28:59.79,Default,,0,0,0,,So I have a simple app here.
Dialogue: 0,0:29:00.20,0:29:02.85,Default,,0,0,0,,It takes a post I have and puts
Dialogue: 0,0:29:02.85,0:29:03.98,Default,,0,0,0,,it on my social media feeds.
Dialogue: 0,0:29:04.63,0:29:06.14,Default,,0,0,0,,I've set it up with a few
Dialogue: 0,0:29:06.14,0:29:06.70,Default,,0,0,0,,buttons here.
Dialogue: 0,0:29:06.89,0:29:09.49,Default,,0,0,0,,A download button that will go
Dialogue: 0,0:29:09.49,0:29:10.80,Default,,0,0,0,,on a background context and
Dialogue: 0,0:29:11.19,0:29:12.99,Default,,0,0,0,,ingest from the Cloud.
Dialogue: 0,0:29:13.55,0:29:15.19,Default,,0,0,0,,And a background task that will
Dialogue: 0,0:29:15.19,0:29:17.09,Default,,0,0,0,,go out and post all of my stuff.
Dialogue: 0,0:29:17.22,0:29:18.75,Default,,0,0,0,,And I've also got a tab where I
Dialogue: 0,0:29:18.75,0:29:19.99,Default,,0,0,0,,can go and see the history.
Dialogue: 0,0:29:21.49,0:29:23.58,Default,,0,0,0,,Currently in my code I have Use
Dialogue: 0,0:29:23.58,0:29:24.99,Default,,0,0,0,,Persistent History set to False,
Dialogue: 0,0:29:24.99,0:29:26.91,Default,,0,0,0,,but I've enabled it for my store
Dialogue: 0,0:29:26.91,0:29:27.82,Default,,0,0,0,,so that we can see what's
Dialogue: 0,0:29:27.82,0:29:28.29,Default,,0,0,0,,changed.
Dialogue: 0,0:29:30.02,0:29:31.93,Default,,0,0,0,,So here I am and I'll have a
Dialogue: 0,0:29:31.93,0:29:32.64,Default,,0,0,0,,user post.
Dialogue: 0,0:29:33.10,0:29:34.31,Default,,0,0,0,,And this user said, "This demo
Dialogue: 0,0:29:34.31,0:29:34.74,Default,,0,0,0,,is amazing!"
Dialogue: 0,0:29:34.74,0:29:36.61,Default,,0,0,0,,Awesome. And I can also go and
Dialogue: 0,0:29:36.61,0:29:37.75,Default,,0,0,0,,download one from the
Dialogue: 0,0:29:37.75,0:29:38.37,Default,,0,0,0,,background.
Dialogue: 0,0:29:38.37,0:29:40.85,Default,,0,0,0,,And we can see that I've labeled
Dialogue: 0,0:29:40.85,0:29:42.05,Default,,0,0,0,,where the post came from.
Dialogue: 0,0:29:42.05,0:29:43.05,Default,,0,0,0,,The first one comes from the
Dialogue: 0,0:29:43.05,0:29:44.22,Default,,0,0,0,,user, the next one comes from
Dialogue: 0,0:29:44.22,0:29:44.82,Default,,0,0,0,,the background.
Dialogue: 0,0:29:45.72,0:29:48.20,Default,,0,0,0,,But now let's hop out and go to
Dialogue: 0,0:29:48.20,0:29:49.15,Default,,0,0,0,,the Share Extension.
Dialogue: 0,0:29:49.88,0:29:52.12,Default,,0,0,0,,And let's share about Apple here
Dialogue: 0,0:29:52.12,0:29:52.64,Default,,0,0,0,,real quick.
Dialogue: 0,0:29:58.04,0:30:00.15,Default,,0,0,0,,So I can post about this and see
Dialogue: 0,0:30:00.15,0:30:00.70,Default,,0,0,0,,in my app.
Dialogue: 0,0:30:00.85,0:30:02.85,Default,,0,0,0,,And now when we get back to my
Dialogue: 0,0:30:03.02,0:30:05.74,Default,,0,0,0,,app -- oh wait, I lost some
Dialogue: 0,0:30:05.74,0:30:06.69,Default,,0,0,0,,data, this is really odd.
Dialogue: 0,0:30:07.37,0:30:08.63,Default,,0,0,0,,It must have something wrong.
Dialogue: 0,0:30:08.63,0:30:10.26,Default,,0,0,0,,But if I go back to the history
Dialogue: 0,0:30:10.75,0:30:12.53,Default,,0,0,0,,I can see that I had a post
Dialogue: 0,0:30:12.53,0:30:14.28,Default,,0,0,0,,within the app and I had remote
Dialogue: 0,0:30:14.28,0:30:15.91,Default,,0,0,0,,content and I even can see the
Dialogue: 0,0:30:15.91,0:30:16.72,Default,,0,0,0,,Share Extension.
Dialogue: 0,0:30:17.72,0:30:19.37,Default,,0,0,0,,However I'm not seeing that
Dialogue: 0,0:30:19.37,0:30:21.82,Default,,0,0,0,,here, like the user I start
Dialogue: 0,0:30:21.82,0:30:23.15,Default,,0,0,0,,adding data and trying to figure
Dialogue: 0,0:30:23.15,0:30:24.20,Default,,0,0,0,,out what's wrong with this UI.
Dialogue: 0,0:30:25.04,0:30:27.30,Default,,0,0,0,,And my Persistent History once
Dialogue: 0,0:30:27.30,0:30:28.40,Default,,0,0,0,,again is showing everything.
Dialogue: 0,0:30:28.72,0:30:29.87,Default,,0,0,0,,Oh wait, that's weird.
Dialogue: 0,0:30:30.33,0:30:32.66,Default,,0,0,0,,All of a sudden my app has hit
Dialogue: 0,0:30:32.72,0:30:33.83,Default,,0,0,0,,some refresh that I've
Dialogue: 0,0:30:33.83,0:30:35.87,Default,,0,0,0,,downloaded into it based on some
Dialogue: 0,0:30:35.87,0:30:37.82,Default,,0,0,0,,view where I finally go and hit
Dialogue: 0,0:30:37.82,0:30:39.36,Default,,0,0,0,,the database and re-fetch
Dialogue: 0,0:30:39.76,0:30:40.31,Default,,0,0,0,,everything.
Dialogue: 0,0:30:40.96,0:30:41.77,Default,,0,0,0,,Because that's the only way I
Dialogue: 0,0:30:41.77,0:30:43.35,Default,,0,0,0,,can solve this problem sometimes
Dialogue: 0,0:30:43.94,0:30:45.06,Default,,0,0,0,,and that's frustrating to our
Dialogue: 0,0:30:45.06,0:30:45.53,Default,,0,0,0,,users.
Dialogue: 0,0:30:46.47,0:30:48.34,Default,,0,0,0,,But what happens if we turn on
Dialogue: 0,0:30:48.34,0:30:50.04,Default,,0,0,0,,Persistent History and no longer
Dialogue: 0,0:30:50.04,0:30:51.31,Default,,0,0,0,,have to track things like that?
Dialogue: 0,0:30:52.12,0:30:53.74,Default,,0,0,0,,So I'll simply turn this on.
Dialogue: 0,0:30:53.96,0:30:55.20,Default,,0,0,0,,So as you can see here real
Dialogue: 0,0:30:55.20,0:30:59.01,Default,,0,0,0,,quick, I have my Background
Dialogue: 0,0:30:59.01,0:31:01.09,Default,,0,0,0,,Context set up and my View
Dialogue: 0,0:31:01.09,0:31:02.78,Default,,0,0,0,,Context set up and I've also got
Dialogue: 0,0:31:02.78,0:31:03.81,Default,,0,0,0,,them listening to each other.
Dialogue: 0,0:31:04.33,0:31:08.47,Default,,0,0,0,,But I also have some Transaction
Dialogue: 0,0:31:08.47,0:31:09.00,Default,,0,0,0,,Author set.
Dialogue: 0,0:31:09.06,0:31:09.99,Default,,0,0,0,,And I just want to show you how
Dialogue: 0,0:31:10.05,0:31:11.32,Default,,0,0,0,,simple that is so that we can
Dialogue: 0,0:31:11.32,0:31:12.23,Default,,0,0,0,,see this going forward.
Dialogue: 0,0:31:13.52,0:31:14.99,Default,,0,0,0,,OK, so let's stop the app real
Dialogue: 0,0:31:14.99,0:31:16.87,Default,,0,0,0,,quick and re-launch.
Dialogue: 0,0:31:24.07,0:31:25.83,Default,,0,0,0,,And here we are with our app
Dialogue: 0,0:31:25.83,0:31:26.77,Default,,0,0,0,,using History at this time.
Dialogue: 0,0:31:26.77,0:31:28.92,Default,,0,0,0,,And let's go to that troublesome
Dialogue: 0,0:31:28.92,0:31:30.61,Default,,0,0,0,,case of sharing a post.
Dialogue: 0,0:31:31.44,0:31:33.04,Default,,0,0,0,,Well, High Sierra looks pretty
Dialogue: 0,0:31:33.04,0:31:36.67,Default,,0,0,0,,cool, so let's share about that
Dialogue: 0,0:31:37.30,0:31:37.69,Default,,0,0,0,,real quick.
Dialogue: 0,0:31:39.08,0:31:40.76,Default,,0,0,0,,All right, shared about that.
Dialogue: 0,0:31:40.94,0:31:42.09,Default,,0,0,0,,Real quick let's just share
Dialogue: 0,0:31:42.09,0:31:43.08,Default,,0,0,0,,about one more thing.
Dialogue: 0,0:31:44.05,0:31:45.56,Default,,0,0,0,,The cool new watchOS.
Dialogue: 0,0:31:55.11,0:31:56.62,Default,,0,0,0,,And now when we get back to the
Dialogue: 0,0:31:56.62,0:31:56.91,Default,,0,0,0,,app,
Dialogue: 0,0:32:01.12,0:32:02.33,Default,,0,0,0,,voila. There they are.
Dialogue: 0,0:32:02.62,0:32:03.96,Default,,0,0,0,,All I've done is absorb the
Dialogue: 0,0:32:03.96,0:32:05.93,Default,,0,0,0,,history, when my view reloaded,
Dialogue: 0,0:32:06.86,0:32:08.26,Default,,0,0,0,,and we can jump to that code
Dialogue: 0,0:32:08.26,0:32:09.55,Default,,0,0,0,,real quick.
Dialogue: 0,0:32:18.33,0:32:19.62,Default,,0,0,0,,So previously if I was using
Dialogue: 0,0:32:19.65,0:32:21.36,Default,,0,0,0,,Fetch Hit -- not using
Dialogue: 0,0:32:21.36,0:32:22.26,Default,,0,0,0,,Persistent History, I was
Dialogue: 0,0:32:22.29,0:32:23.80,Default,,0,0,0,,fetching everything, but now
Dialogue: 0,0:32:23.80,0:32:25.52,Default,,0,0,0,,that I am all I'm doing is
Dialogue: 0,0:32:25.52,0:32:26.39,Default,,0,0,0,,fetching the history and
Dialogue: 0,0:32:26.75,0:32:28.31,Default,,0,0,0,,absorbing the merged context
Dialogue: 0,0:32:28.49,0:32:29.55,Default,,0,0,0,,from the History.
Dialogue: 0,0:32:29.55,0:32:31.11,Default,,0,0,0,,And it gives me a much smaller
Dialogue: 0,0:32:31.11,0:32:32.39,Default,,0,0,0,,subset and I no longer have to
Dialogue: 0,0:32:32.39,0:32:34.01,Default,,0,0,0,,scan the entire database to see
Dialogue: 0,0:32:34.01,0:32:34.65,Default,,0,0,0,,what was different.
Dialogue: 0,0:32:36.52,0:32:39.64,Default,,0,0,0,,[ Applause ]
Dialogue: 0,0:32:40.14,0:32:42.58,Default,,0,0,0,,And so to recap it's rather
Dialogue: 0,0:32:42.58,0:32:42.90,Default,,0,0,0,,easy.
Dialogue: 0,0:32:43.34,0:32:44.60,Default,,0,0,0,,Simple to enable Persistent
Dialogue: 0,0:32:44.60,0:32:44.92,Default,,0,0,0,,History.
Dialogue: 0,0:32:44.99,0:32:46.07,Default,,0,0,0,,It's just one option on your
Dialogue: 0,0:32:46.07,0:32:46.39,Default,,0,0,0,,store.
Dialogue: 0,0:32:47.88,0:32:49.10,Default,,0,0,0,,It really uncovers all those
Dialogue: 0,0:32:49.10,0:32:49.75,Default,,0,0,0,,missing changes.
Dialogue: 0,0:32:50.20,0:32:51.64,Default,,0,0,0,,And you may have been generating
Dialogue: 0,0:32:51.64,0:32:53.34,Default,,0,0,0,,background context, you may just
Dialogue: 0,0:32:53.34,0:32:54.40,Default,,0,0,0,,not realize that you're missing
Dialogue: 0,0:32:54.40,0:32:56.12,Default,,0,0,0,,a notification, you've harnessed
Dialogue: 0,0:32:56.16,0:32:57.80,Default,,0,0,0,,Batch Updates, Batch Deletes,
Dialogue: 0,0:32:58.10,0:32:58.82,Default,,0,0,0,,which don't generate
Dialogue: 0,0:32:58.82,0:32:59.65,Default,,0,0,0,,notifications.
Dialogue: 0,0:33:00.19,0:33:01.48,Default,,0,0,0,,So they uncover all of that.
Dialogue: 0,0:33:01.89,0:33:03.11,Default,,0,0,0,,And you'll never be in the dark
Dialogue: 0,0:33:03.11,0:33:04.20,Default,,0,0,0,,again about changes to your
Dialogue: 0,0:33:04.20,0:33:04.59,Default,,0,0,0,,database.
Dialogue: 0,0:33:07.83,0:33:09.44,Default,,0,0,0,,Two caveats to mention about
Dialogue: 0,0:33:09.44,0:33:11.25,Default,,0,0,0,,using persistent history -- the
Dialogue: 0,0:33:11.25,0:33:12.44,Default,,0,0,0,,first one is about Migration.
Dialogue: 0,0:33:12.61,0:33:14.40,Default,,0,0,0,,We will preserve as much of your
Dialogue: 0,0:33:14.40,0:33:16.14,Default,,0,0,0,,history as possible on migration
Dialogue: 0,0:33:18.01,0:33:18.94,Default,,0,0,0,,except for two cases.
Dialogue: 0,0:33:19.54,0:33:21.10,Default,,0,0,0,,One is if you remove entities
Dialogue: 0,0:33:21.10,0:33:22.47,Default,,0,0,0,,from your model and we already
Dialogue: 0,0:33:22.47,0:33:24.56,Default,,0,0,0,,have history on these entities,
Dialogue: 0,0:33:25.15,0:33:26.08,Default,,0,0,0,,we'll have to remove that
Dialogue: 0,0:33:26.08,0:33:27.50,Default,,0,0,0,,history for those entities and
Dialogue: 0,0:33:27.61,0:33:28.35,Default,,0,0,0,,that creates a gap.
Dialogue: 0,0:33:29.39,0:33:31.22,Default,,0,0,0,,The other one is for tombstones.
Dialogue: 0,0:33:31.36,0:33:34.40,Default,,0,0,0,,For tombstones you don't want to
Dialogue: 0,0:33:34.51,0:33:35.92,Default,,0,0,0,,have certain data there after
Dialogue: 0,0:33:35.92,0:33:37.15,Default,,0,0,0,,awhile to identify the object.
Dialogue: 0,0:33:37.22,0:33:38.25,Default,,0,0,0,,Maybe it's become a security
Dialogue: 0,0:33:38.25,0:33:39.11,Default,,0,0,0,,concern for you.
Dialogue: 0,0:33:39.11,0:33:41.13,Default,,0,0,0,,So you've called the tombstone.
Dialogue: 0,0:33:41.39,0:33:42.57,Default,,0,0,0,,So we'll do the same and we'll
Dialogue: 0,0:33:42.57,0:33:44.11,Default,,0,0,0,,remove that tombstone value out
Dialogue: 0,0:33:44.40,0:33:45.18,Default,,0,0,0,,from the model.
Dialogue: 0,0:33:45.18,0:33:46.84,Default,,0,0,0,,But if that removes anything
Dialogue: 0,0:33:46.84,0:33:49.03,Default,,0,0,0,,that will leave a gap in your
Dialogue: 0,0:33:49.03,0:33:50.86,Default,,0,0,0,,history, we'll also then only
Dialogue: 0,0:33:50.86,0:33:51.82,Default,,0,0,0,,preserve your history to the
Dialogue: 0,0:33:51.82,0:33:53.30,Default,,0,0,0,,last complete transaction.
Dialogue: 0,0:33:53.72,0:33:56.55,Default,,0,0,0,,This way you can go and follow
Dialogue: 0,0:33:56.55,0:33:58.37,Default,,0,0,0,,the history without falling into
Dialogue: 0,0:33:58.37,0:33:59.89,Default,,0,0,0,,a trap where I am missing
Dialogue: 0,0:33:59.89,0:34:01.70,Default,,0,0,0,,changes once again because of a
Dialogue: 0,0:34:01.88,0:34:01.98,Default,,0,0,0,,gap.
Dialogue: 0,0:34:03.32,0:34:06.41,Default,,0,0,0,,As far as performance there's a
Dialogue: 0,0:34:06.41,0:34:08.52,Default,,0,0,0,,slight impact on every save and
Dialogue: 0,0:34:08.52,0:34:10.17,Default,,0,0,0,,every batch-operation you do.
Dialogue: 0,0:34:11.24,0:34:12.26,Default,,0,0,0,,According to the size of your
Dialogue: 0,0:34:12.26,0:34:13.59,Default,,0,0,0,,save and your batch operation
Dialogue: 0,0:34:13.59,0:34:15.13,Default,,0,0,0,,we'll do a slight calculation of
Dialogue: 0,0:34:15.13,0:34:16.57,Default,,0,0,0,,what changed and write that to
Dialogue: 0,0:34:16.57,0:34:17.07,Default,,0,0,0,,the database.
Dialogue: 0,0:34:17.68,0:34:19.96,Default,,0,0,0,,However, once your operation is
Dialogue: 0,0:34:19.96,0:34:21.61,Default,,0,0,0,,complete all of that memory that
Dialogue: 0,0:34:21.61,0:34:23.15,Default,,0,0,0,,we used is returned back to you.
Dialogue: 0,0:34:23.33,0:34:24.72,Default,,0,0,0,,There's also small storage
Dialogue: 0,0:34:24.72,0:34:26.48,Default,,0,0,0,,overhead, but your history can
Dialogue: 0,0:34:26.48,0:34:27.81,Default,,0,0,0,,be purged, so this makes it
Dialogue: 0,0:34:27.81,0:34:29.07,Default,,0,0,0,,really easy for you to reclaim
Dialogue: 0,0:34:29.07,0:34:30.48,Default,,0,0,0,,that space once you've consumed
Dialogue: 0,0:34:30.48,0:34:30.91,Default,,0,0,0,,the history.
Dialogue: 0,0:34:31.43,0:34:34.77,Default,,0,0,0,,And that's Persistent History
Dialogue: 0,0:34:34.77,0:34:35.06,Default,,0,0,0,,Tracking.
Dialogue: 0,0:34:36.52,0:34:43.02,Default,,0,0,0,,[ Applause ]
Dialogue: 0,0:34:43.52,0:34:44.72,Default,,0,0,0,,Now just to summarize what we've
Dialogue: 0,0:34:44.72,0:34:45.44,Default,,0,0,0,,gone over today.
Dialogue: 0,0:34:45.88,0:34:46.79,Default,,0,0,0,,Melissa went over Core
Dialogue: 0,0:34:46.79,0:34:47.29,Default,,0,0,0,,Spotlight.
Dialogue: 0,0:34:47.50,0:34:49.56,Default,,0,0,0,,It's really easy to adopt, easy
Dialogue: 0,0:34:49.56,0:34:50.59,Default,,0,0,0,,to share your data with
Dialogue: 0,0:34:50.59,0:34:52.35,Default,,0,0,0,,Spotlight, and it gives you deep
Dialogue: 0,0:34:52.35,0:34:52.75,Default,,0,0,0,,linking.
Dialogue: 0,0:34:53.04,0:34:54.30,Default,,0,0,0,,So your users can find their
Dialogue: 0,0:34:54.30,0:34:56.26,Default,,0,0,0,,data in your app anywhere on the
Dialogue: 0,0:34:56.26,0:34:56.51,Default,,0,0,0,,phone.
Dialogue: 0,0:34:57.42,0:34:59.81,Default,,0,0,0,,And the New Indexing API makes
Dialogue: 0,0:34:59.81,0:35:01.57,Default,,0,0,0,,your searches faster and just
Dialogue: 0,0:35:01.57,0:35:02.86,Default,,0,0,0,,makes your app that much faster.
Dialogue: 0,0:35:03.60,0:35:05.61,Default,,0,0,0,,And lastly, Persistent History
Dialogue: 0,0:35:06.11,0:35:07.31,Default,,0,0,0,,allows you to know who's always
Dialogue: 0,0:35:07.31,0:35:09.43,Default,,0,0,0,,done it, never be lost, always
Dialogue: 0,0:35:09.43,0:35:10.32,Default,,0,0,0,,know who's done what to your
Dialogue: 0,0:35:10.32,0:35:10.75,Default,,0,0,0,,database.
Dialogue: 0,0:35:13.03,0:35:14.68,Default,,0,0,0,,One PSA before we go.
Dialogue: 0,0:35:14.92,0:35:15.70,Default,,0,0,0,,Please file bugs.
Dialogue: 0,0:35:16.17,0:35:17.18,Default,,0,0,0,,Let us know if you run into an
Dialogue: 0,0:35:17.18,0:35:17.50,Default,,0,0,0,,issue.
Dialogue: 0,0:35:17.66,0:35:18.47,Default,,0,0,0,,Let us know if you want
Dialogue: 0,0:35:18.47,0:35:18.91,Default,,0,0,0,,something.
Dialogue: 0,0:35:19.99,0:35:21.53,Default,,0,0,0,,Go to bugreport.apple.com.
Dialogue: 0,0:35:21.70,0:35:22.41,Default,,0,0,0,,We are listening.
Dialogue: 0,0:35:23.07,0:35:24.14,Default,,0,0,0,,So please go and visit.
Dialogue: 0,0:35:25.11,0:35:27.19,Default,,0,0,0,,For more information check out
Dialogue: 0,0:35:27.19,0:35:28.80,Default,,0,0,0,,the www.DC website.
Dialogue: 0,0:35:29.56,0:35:31.69,Default,,0,0,0,,And for some related sessions we
Dialogue: 0,0:35:31.69,0:35:32.63,Default,,0,0,0,,had "What's New in Cocoa"
Dialogue: 0,0:35:32.63,0:35:33.99,Default,,0,0,0,,earlier today, so go check out
Dialogue: 0,0:35:33.99,0:35:34.47,Default,,0,0,0,,that video.
Dialogue: 0,0:35:34.99,0:35:35.84,Default,,0,0,0,,We also have "What's New in
Dialogue: 0,0:35:35.84,0:35:36.96,Default,,0,0,0,,Foundation" coming up next.
Dialogue: 0,0:35:37.68,0:35:39.94,Default,,0,0,0,,And we have some cool stuff on
Dialogue: 0,0:35:39.94,0:35:41.25,Default,,0,0,0,,"What's New in Core Spotlight"
Dialogue: 0,0:35:41.25,0:35:42.37,Default,,0,0,0,,later on Thursday.
Dialogue: 0,0:35:42.87,0:35:44.02,Default,,0,0,0,,And check out the "Cocoa
Dialogue: 0,0:35:44.02,0:35:45.36,Default,,0,0,0,,Development Tips" early on
Dialogue: 0,0:35:45.36,0:35:45.96,Default,,0,0,0,,Friday morning.
Dialogue: 0,0:35:46.58,0:35:47.28,Default,,0,0,0,,Thank you very much.
Dialogue: 0,0:35:48.51,0:35:50.51,Default,,0,0,0,,[ Applause ]
