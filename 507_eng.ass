[Script Info]
; Script generated by FFmpeg/Lavc57.89.100
ScriptType: v4.00+
PlayResX: 384
PlayResY: 288

[V4+ Styles]
Format: Name, Fontname, Fontsize, PrimaryColour, SecondaryColour, OutlineColour, BackColour, Bold, Italic, Underline, StrikeOut, ScaleX, ScaleY, Spacing, Angle, BorderStyle, Outline, Shadow, Alignment, MarginL, MarginR, MarginV, Encoding
Style: Default,Arial,16,&Hffffff,&Hffffff,&H0,&H0,0,0,0,0,100,100,0,0,1,1,0,2,10,10,10,0

[Events]
Format: Layer, Start, End, Style, Name, MarginL, MarginR, MarginV, Effect, Text
Dialogue: 0,0:00:25.72,0:00:26.58,Default,,0,0,0,,I'm Brad Ford.
Dialogue: 0,0:00:26.76,0:00:27.79,Default,,0,0,0,,I'm from the Camera Software
Dialogue: 0,0:00:27.79,0:00:30.08,Default,,0,0,0,,Team, and I'm very excited to
Dialogue: 0,0:00:30.08,0:00:31.63,Default,,0,0,0,,share some deep thoughts with
Dialogue: 0,0:00:31.63,0:00:32.49,Default,,0,0,0,,you this afternoon.
Dialogue: 0,0:00:32.75,0:00:34.79,Default,,0,0,0,,Did you see what I did there?
Dialogue: 0,0:00:35.20,0:00:36.29,Default,,0,0,0,,All right [applause].
Dialogue: 0,0:00:38.67,0:00:40.22,Default,,0,0,0,,This session is part one of a
Dialogue: 0,0:00:40.22,0:00:41.95,Default,,0,0,0,,two-part series on a very
Dialogue: 0,0:00:41.95,0:00:43.13,Default,,0,0,0,,important initiative for Apple
Dialogue: 0,0:00:43.13,0:00:44.56,Default,,0,0,0,,this year, and that is media
Dialogue: 0,0:00:44.71,0:00:46.38,Default,,0,0,0,,containing depth information.
Dialogue: 0,0:00:47.06,0:00:48.14,Default,,0,0,0,,I'll introduce depth at the
Dialogue: 0,0:00:48.14,0:00:49.51,Default,,0,0,0,,conceptual level, I'll
Dialogue: 0,0:00:49.51,0:00:51.53,Default,,0,0,0,,familiarize you with key terms,
Dialogue: 0,0:00:51.78,0:00:52.56,Default,,0,0,0,,and I'll teach you how to
Dialogue: 0,0:00:52.56,0:00:53.98,Default,,0,0,0,,capture depth data on the
Dialogue: 0,0:00:53.98,0:00:55.67,Default,,0,0,0,,iPhone, much like this.
Dialogue: 0,0:00:55.67,0:00:56.95,Default,,0,0,0,,You'll see a lot of ghostly
Dialogue: 0,0:00:56.95,0:00:58.15,Default,,0,0,0,,images in this session.
Dialogue: 0,0:00:59.41,0:01:00.42,Default,,0,0,0,,Here's the agenda.
Dialogue: 0,0:01:01.48,0:01:03.10,Default,,0,0,0,,First we're going to cover depth
Dialogue: 0,0:01:03.10,0:01:04.76,Default,,0,0,0,,and disparity on iPhone 7 Plus
Dialogue: 0,0:01:05.22,0:01:06.17,Default,,0,0,0,,at a high level.
Dialogue: 0,0:01:07.13,0:01:08.64,Default,,0,0,0,,Then we'll move on to streaming
Dialogue: 0,0:01:08.64,0:01:09.85,Default,,0,0,0,,depth data from the camera,
Dialogue: 0,0:01:11.05,0:01:12.30,Default,,0,0,0,,capturing photos with depth
Dialogue: 0,0:01:12.30,0:01:15.40,Default,,0,0,0,,data, and finally we'll end with
Dialogue: 0,0:01:15.49,0:01:16.84,Default,,0,0,0,,a slight tangent, which is dual
Dialogue: 0,0:01:16.84,0:01:17.70,Default,,0,0,0,,photo capture.
Dialogue: 0,0:01:18.12,0:01:19.60,Default,,0,0,0,,It is the most highly requested
Dialogue: 0,0:01:19.60,0:01:20.71,Default,,0,0,0,,feature we've had on dual
Dialogue: 0,0:01:20.71,0:01:22.21,Default,,0,0,0,,camera, and I'm very excited to
Dialogue: 0,0:01:22.21,0:01:22.84,Default,,0,0,0,,talk about it.
Dialogue: 0,0:01:23.49,0:01:25.57,Default,,0,0,0,,Your job is to listen for all
Dialogue: 0,0:01:25.57,0:01:28.32,Default,,0,0,0,,the truly horrible depth puns
Dialogue: 0,0:01:28.50,0:01:29.66,Default,,0,0,0,,that I have sprinkled throughout
Dialogue: 0,0:01:29.71,0:01:31.94,Default,,0,0,0,,this session, and let's make a
Dialogue: 0,0:01:31.94,0:01:32.46,Default,,0,0,0,,game of it.
Dialogue: 0,0:01:32.46,0:01:34.33,Default,,0,0,0,,Okay? Every time you hear one,
Dialogue: 0,0:01:34.43,0:01:36.28,Default,,0,0,0,,just give me a nice big groan to
Dialogue: 0,0:01:36.28,0:01:37.38,Default,,0,0,0,,let me know that you care.
Dialogue: 0,0:01:37.38,0:01:37.68,Default,,0,0,0,,All right?
Dialogue: 0,0:01:38.02,0:01:38.86,Default,,0,0,0,,Here, let's practice.
Dialogue: 0,0:01:39.42,0:01:40.98,Default,,0,0,0,,Everybody ready for a deep dive?
Dialogue: 0,0:01:41.03,0:01:43.03,Default,,0,0,0,,[ Group groaning ]
Dialogue: 0,0:01:43.05,0:01:43.83,Default,,0,0,0,,Thank you, from the bottom of my
Dialogue: 0,0:01:43.86,0:01:43.98,Default,,0,0,0,,heart.
Dialogue: 0,0:01:44.05,0:01:46.05,Default,,0,0,0,,[ Group groaning ]
Dialogue: 0,0:01:46.09,0:01:47.09,Default,,0,0,0,,All right.
Dialogue: 0,0:01:47.47,0:01:49.82,Default,,0,0,0,,Good. The reason you're all here
Dialogue: 0,0:01:49.82,0:01:51.73,Default,,0,0,0,,today is this guy right here.
Dialogue: 0,0:01:52.01,0:01:53.53,Default,,0,0,0,,This is the iPhone 7 Plus.
Dialogue: 0,0:01:54.00,0:01:55.23,Default,,0,0,0,,The product, of course, has sold
Dialogue: 0,0:01:55.23,0:01:57.20,Default,,0,0,0,,exceptionally well, even better
Dialogue: 0,0:01:57.20,0:01:58.72,Default,,0,0,0,,than its plus size predecessor,
Dialogue: 0,0:01:59.36,0:02:00.75,Default,,0,0,0,,and that's thanks in large part
Dialogue: 0,0:02:00.75,0:02:01.99,Default,,0,0,0,,to the quality of the dual
Dialogue: 0,0:02:01.99,0:02:02.80,Default,,0,0,0,,camera system.
Dialogue: 0,0:02:03.79,0:02:06.67,Default,,0,0,0,,It is a dual prime lens system
Dialogue: 0,0:02:06.82,0:02:08.66,Default,,0,0,0,,consisting of a 28-millimeter
Dialogue: 0,0:02:08.66,0:02:10.14,Default,,0,0,0,,equivalent wide-angle camera,
Dialogue: 0,0:02:10.54,0:02:12.33,Default,,0,0,0,,and a 56-millimeter equivalent
Dialogue: 0,0:02:12.33,0:02:13.28,Default,,0,0,0,,telephoto camera.
Dialogue: 0,0:02:13.84,0:02:15.69,Default,,0,0,0,,Both of them are 12 megapixels.
Dialogue: 0,0:02:16.01,0:02:17.40,Default,,0,0,0,,They share the same feature set,
Dialogue: 0,0:02:17.55,0:02:18.58,Default,,0,0,0,,the same formats.
Dialogue: 0,0:02:19.15,0:02:20.20,Default,,0,0,0,,You can run either of these
Dialogue: 0,0:02:20.20,0:02:22.18,Default,,0,0,0,,cameras on its own, or you can
Dialogue: 0,0:02:22.18,0:02:24.47,Default,,0,0,0,,address them in tandem using a
Dialogue: 0,0:02:24.47,0:02:26.51,Default,,0,0,0,,third virtual camera, the first
Dialogue: 0,0:02:26.51,0:02:27.83,Default,,0,0,0,,time we've ever delivered one on
Dialogue: 0,0:02:27.94,0:02:29.57,Default,,0,0,0,,iOS, and it's called the dual
Dialogue: 0,0:02:29.57,0:02:30.00,Default,,0,0,0,,camera.
Dialogue: 0,0:02:30.59,0:02:32.08,Default,,0,0,0,,It runs them in a synchronized
Dialogue: 0,0:02:32.08,0:02:33.92,Default,,0,0,0,,fashion, the same frame rate,
Dialogue: 0,0:02:34.45,0:02:35.48,Default,,0,0,0,,and running them together
Dialogue: 0,0:02:35.48,0:02:37.30,Default,,0,0,0,,enables two marquee features.
Dialogue: 0,0:02:38.32,0:02:40.18,Default,,0,0,0,,The first is dual camera zoom.
Dialogue: 0,0:02:41.19,0:02:42.83,Default,,0,0,0,,This switches between the wide
Dialogue: 0,0:02:42.83,0:02:44.49,Default,,0,0,0,,and the tele automatically as
Dialogue: 0,0:02:44.49,0:02:45.11,Default,,0,0,0,,you zoom.
Dialogue: 0,0:02:45.66,0:02:47.82,Default,,0,0,0,,It matches exposure, focus and
Dialogue: 0,0:02:47.82,0:02:49.16,Default,,0,0,0,,frame rate so that it's kind of
Dialogue: 0,0:02:49.16,0:02:49.59,Default,,0,0,0,,magical.
Dialogue: 0,0:02:49.59,0:02:50.50,Default,,0,0,0,,You don't even realize that
Dialogue: 0,0:02:50.50,0:02:52.14,Default,,0,0,0,,we're switching cameras, but all
Dialogue: 0,0:02:52.14,0:02:53.64,Default,,0,0,0,,of this happens very seamlessly.
Dialogue: 0,0:02:54.06,0:02:55.48,Default,,0,0,0,,We also are compensating for the
Dialogue: 0,0:02:55.48,0:02:57.56,Default,,0,0,0,,parallax shift to make it a
Dialogue: 0,0:02:57.56,0:02:59.06,Default,,0,0,0,,smooth transition as you go back
Dialogue: 0,0:02:59.06,0:03:00.22,Default,,0,0,0,,and forth between the wide and
Dialogue: 0,0:03:00.22,0:03:00.68,Default,,0,0,0,,the tele.
Dialogue: 0,0:03:01.25,0:03:03.23,Default,,0,0,0,,And the second marquee feature
Dialogue: 0,0:03:03.23,0:03:04.46,Default,,0,0,0,,is, of course, the Portrait
Dialogue: 0,0:03:04.46,0:03:06.00,Default,,0,0,0,,mode, where the dual camera
Dialogue: 0,0:03:06.00,0:03:08.03,Default,,0,0,0,,system locks into the tele
Dialogue: 0,0:03:08.03,0:03:10.13,Default,,0,0,0,,camera's narrower field of view,
Dialogue: 0,0:03:10.96,0:03:13.09,Default,,0,0,0,,but then uses images from both
Dialogue: 0,0:03:13.14,0:03:15.03,Default,,0,0,0,,the wide and the tele to
Dialogue: 0,0:03:15.03,0:03:16.67,Default,,0,0,0,,generate a beautiful shallow
Dialogue: 0,0:03:16.67,0:03:18.22,Default,,0,0,0,,depth of field effect that you'd
Dialogue: 0,0:03:18.22,0:03:19.26,Default,,0,0,0,,expect from a much more
Dialogue: 0,0:03:19.26,0:03:21.07,Default,,0,0,0,,expensive camera with a fast,
Dialogue: 0,0:03:21.07,0:03:22.11,Default,,0,0,0,,wide-open lens.
Dialogue: 0,0:03:22.87,0:03:24.77,Default,,0,0,0,,The foreground is sharply in
Dialogue: 0,0:03:24.77,0:03:26.60,Default,,0,0,0,,focus, while the background is
Dialogue: 0,0:03:26.60,0:03:28.38,Default,,0,0,0,,progressively blurred in these
Dialogue: 0,0:03:28.38,0:03:30.06,Default,,0,0,0,,pleasing little bouquet circles.
Dialogue: 0,0:03:30.90,0:03:33.20,Default,,0,0,0,,The depth effect has gotten even
Dialogue: 0,0:03:33.20,0:03:34.72,Default,,0,0,0,,better in iOS 11.
Dialogue: 0,0:03:35.29,0:03:36.52,Default,,0,0,0,,We've made improvements to the
Dialogue: 0,0:03:36.52,0:03:38.08,Default,,0,0,0,,rendering of the out-of-focus
Dialogue: 0,0:03:38.08,0:03:38.49,Default,,0,0,0,,area.
Dialogue: 0,0:03:38.90,0:03:40.96,Default,,0,0,0,,It more accurately represents a
Dialogue: 0,0:03:40.96,0:03:43.42,Default,,0,0,0,,wide-open fast lens with sharp
Dialogue: 0,0:03:43.47,0:03:44.88,Default,,0,0,0,,and well-defined bouquet
Dialogue: 0,0:03:44.88,0:03:45.48,Default,,0,0,0,,circles.
Dialogue: 0,0:03:46.00,0:03:47.02,Default,,0,0,0,,We've also improved how the
Dialogue: 0,0:03:47.02,0:03:48.67,Default,,0,0,0,,rendering handles the edges
Dialogue: 0,0:03:48.78,0:03:50.12,Default,,0,0,0,,between the foreground and the
Dialogue: 0,0:03:50.12,0:03:50.66,Default,,0,0,0,,background.
Dialogue: 0,0:03:50.96,0:03:51.85,Default,,0,0,0,,Please check it out if you
Dialogue: 0,0:03:51.85,0:03:52.39,Default,,0,0,0,,haven't yet.
Dialogue: 0,0:03:52.39,0:03:53.31,Default,,0,0,0,,I think you'll be pleasantly
Dialogue: 0,0:03:53.31,0:03:54.65,Default,,0,0,0,,surprised at how great the
Dialogue: 0,0:03:54.65,0:03:56.23,Default,,0,0,0,,quality of the shallow depth of
Dialogue: 0,0:03:56.23,0:03:57.87,Default,,0,0,0,,field effect is in iOS 11.
Dialogue: 0,0:03:58.89,0:04:01.08,Default,,0,0,0,,To generate an effect like this
Dialogue: 0,0:04:01.21,0:04:02.47,Default,,0,0,0,,you need to be able to separate
Dialogue: 0,0:04:02.47,0:04:04.10,Default,,0,0,0,,foreground from background.
Dialogue: 0,0:04:04.16,0:04:05.84,Default,,0,0,0,,In other words, you need depth.
Dialogue: 0,0:04:06.61,0:04:07.92,Default,,0,0,0,,And up to now that depth
Dialogue: 0,0:04:07.92,0:04:09.42,Default,,0,0,0,,information has been exclusive
Dialogue: 0,0:04:09.62,0:04:10.96,Default,,0,0,0,,to the Apple camera app's
Dialogue: 0,0:04:10.96,0:04:13.85,Default,,0,0,0,,Portrait mode, but now new in
Dialogue: 0,0:04:13.93,0:04:15.81,Default,,0,0,0,,iOS 11 we are opening up depth
Dialogue: 0,0:04:15.81,0:04:17.38,Default,,0,0,0,,maps to third party apps.
Dialogue: 0,0:04:18.65,0:04:19.44,Default,,0,0,0,,Here's a gray scale
Dialogue: 0,0:04:19.44,0:04:21.04,Default,,0,0,0,,visualization of the depth map
Dialogue: 0,0:04:21.20,0:04:22.50,Default,,0,0,0,,that was embedded in this image
Dialogue: 0,0:04:22.50,0:04:22.80,Default,,0,0,0,,file.
Dialogue: 0,0:04:24.04,0:04:26.04,Default,,0,0,0,,Having depth information opens
Dialogue: 0,0:04:26.04,0:04:28.10,Default,,0,0,0,,up a world of possibilities for
Dialogue: 0,0:04:28.10,0:04:30.16,Default,,0,0,0,,image editing, such as applying
Dialogue: 0,0:04:30.16,0:04:31.13,Default,,0,0,0,,different filters to the
Dialogue: 0,0:04:31.32,0:04:32.64,Default,,0,0,0,,background and the foreground,
Dialogue: 0,0:04:32.94,0:04:35.18,Default,,0,0,0,,like this.
Dialogue: 0,0:04:35.62,0:04:37.37,Default,,0,0,0,,I've applied a noir black and
Dialogue: 0,0:04:37.37,0:04:39.14,Default,,0,0,0,,white filter to the background
Dialogue: 0,0:04:39.27,0:04:40.44,Default,,0,0,0,,and the fade filter to the
Dialogue: 0,0:04:40.44,0:04:40.96,Default,,0,0,0,,foreground.
Dialogue: 0,0:04:41.45,0:04:42.55,Default,,0,0,0,,And notice how the little girl's
Dialogue: 0,0:04:42.55,0:04:43.78,Default,,0,0,0,,tights are still pink, but
Dialogue: 0,0:04:43.78,0:04:45.24,Default,,0,0,0,,everything behind them is black
Dialogue: 0,0:04:45.24,0:04:45.56,Default,,0,0,0,,and white.
Dialogue: 0,0:04:46.22,0:04:47.66,Default,,0,0,0,,Knowing the gradations of depth,
Dialogue: 0,0:04:48.02,0:04:49.94,Default,,0,0,0,,I can get even fancier and I can
Dialogue: 0,0:04:49.94,0:04:51.35,Default,,0,0,0,,move the switch-over point
Dialogue: 0,0:04:51.52,0:04:53.36,Default,,0,0,0,,forward or backward, like this.
Dialogue: 0,0:04:53.71,0:04:54.88,Default,,0,0,0,,Keep your eyes on the flower.
Dialogue: 0,0:04:56.36,0:04:58.17,Default,,0,0,0,,So now notice that just her hand
Dialogue: 0,0:04:58.17,0:04:59.37,Default,,0,0,0,,and her flower are in color,
Dialogue: 0,0:04:59.37,0:05:00.30,Default,,0,0,0,,while everything else is in
Dialogue: 0,0:05:00.30,0:05:00.89,Default,,0,0,0,,black and white.
Dialogue: 0,0:05:02.13,0:05:03.72,Default,,0,0,0,,You can even control foreground
Dialogue: 0,0:05:03.72,0:05:05.06,Default,,0,0,0,,and background exposures
Dialogue: 0,0:05:05.06,0:05:06.50,Default,,0,0,0,,differently, like this.
Dialogue: 0,0:05:07.74,0:05:09.74,Default,,0,0,0,,So now she looks like she was
Dialogue: 0,0:05:09.74,0:05:11.11,Default,,0,0,0,,photoshopped into her very own
Dialogue: 0,0:05:11.11,0:05:11.44,Default,,0,0,0,,photo.
Dialogue: 0,0:05:12.20,0:05:13.49,Default,,0,0,0,,I'm not saying you should do it.
Dialogue: 0,0:05:13.49,0:05:15.42,Default,,0,0,0,,I'm saying you could do it.
Dialogue: 0,0:05:16.68,0:05:17.10,Default,,0,0,0,,All right.
Dialogue: 0,0:05:17.10,0:05:17.61,Default,,0,0,0,,Enough fun.
Dialogue: 0,0:05:17.66,0:05:18.52,Default,,0,0,0,,Let's get technical.
Dialogue: 0,0:05:18.95,0:05:21.28,Default,,0,0,0,,I like to call this section deep
Dialogue: 0,0:05:21.68,0:05:22.20,Default,,0,0,0,,learning [group groaning].
Dialogue: 0,0:05:23.57,0:05:23.98,Default,,0,0,0,,Thank you.
Dialogue: 0,0:05:24.04,0:05:26.00,Default,,0,0,0,,First we need to define what a
Dialogue: 0,0:05:26.00,0:05:26.99,Default,,0,0,0,,depth map is.
Dialogue: 0,0:05:27.70,0:05:29.46,Default,,0,0,0,,In the real world depth means
Dialogue: 0,0:05:29.46,0:05:31.79,Default,,0,0,0,,the distance between you and an
Dialogue: 0,0:05:31.79,0:05:32.60,Default,,0,0,0,,observed object.
Dialogue: 0,0:05:33.33,0:05:34.86,Default,,0,0,0,,A depth map is a transformation
Dialogue: 0,0:05:34.86,0:05:36.59,Default,,0,0,0,,of a three-dimensional scene
Dialogue: 0,0:05:36.84,0:05:38.15,Default,,0,0,0,,into a two-dimensional
Dialogue: 0,0:05:38.15,0:05:39.92,Default,,0,0,0,,representation, and you do that
Dialogue: 0,0:05:39.92,0:05:41.04,Default,,0,0,0,,by setting the depth to a
Dialogue: 0,0:05:41.04,0:05:42.34,Default,,0,0,0,,constant distance.
Dialogue: 0,0:05:43.08,0:05:44.07,Default,,0,0,0,,Let me explain what I mean.
Dialogue: 0,0:05:44.36,0:05:45.93,Default,,0,0,0,,I'm going to use a diagram of a
Dialogue: 0,0:05:46.04,0:05:48.07,Default,,0,0,0,,pinhole camera often during this
Dialogue: 0,0:05:48.07,0:05:48.77,Default,,0,0,0,,presentation.
Dialogue: 0,0:05:49.42,0:05:50.64,Default,,0,0,0,,If you've studied computer
Dialogue: 0,0:05:50.64,0:05:51.43,Default,,0,0,0,,vision, you'll be really
Dialogue: 0,0:05:51.43,0:05:52.92,Default,,0,0,0,,familiar with pinhole cameras.
Dialogue: 0,0:05:53.07,0:05:54.44,Default,,0,0,0,,A pinhole camera is a simple
Dialogue: 0,0:05:54.44,0:05:56.98,Default,,0,0,0,,lightproof box without a lens.
Dialogue: 0,0:05:56.98,0:05:58.31,Default,,0,0,0,,Instead, it just has a little
Dialogue: 0,0:05:58.31,0:05:59.93,Default,,0,0,0,,poked hole, a single small
Dialogue: 0,0:05:59.93,0:06:01.99,Default,,0,0,0,,aperture that permits light to
Dialogue: 0,0:06:01.99,0:06:04.45,Default,,0,0,0,,enter in and project itself as
Dialogue: 0,0:06:04.45,0:06:06.13,Default,,0,0,0,,an inverted image on the other
Dialogue: 0,0:06:06.13,0:06:08.77,Default,,0,0,0,,side of the image plane, or a
Dialogue: 0,0:06:08.77,0:06:09.26,Default,,0,0,0,,sensor.
Dialogue: 0,0:06:09.84,0:06:12.61,Default,,0,0,0,,The opposite side is known as
Dialogue: 0,0:06:12.89,0:06:13.87,Default,,0,0,0,,image plane or sensor.
Dialogue: 0,0:06:14.77,0:06:15.93,Default,,0,0,0,,The aperture through which the
Dialogue: 0,0:06:15.93,0:06:17.56,Default,,0,0,0,,light rays pass is called the
Dialogue: 0,0:06:17.56,0:06:19.48,Default,,0,0,0,,focal point, and the field of
Dialogue: 0,0:06:19.48,0:06:20.77,Default,,0,0,0,,view of the image captured
Dialogue: 0,0:06:20.94,0:06:23.31,Default,,0,0,0,,depends on the focal length.
Dialogue: 0,0:06:23.90,0:06:24.88,Default,,0,0,0,,So the focal length is the
Dialogue: 0,0:06:24.88,0:06:26.94,Default,,0,0,0,,distance from the focal point to
Dialogue: 0,0:06:26.94,0:06:27.68,Default,,0,0,0,,the image plane.
Dialogue: 0,0:06:27.95,0:06:30.38,Default,,0,0,0,,A shorter focal length means
Dialogue: 0,0:06:30.38,0:06:32.64,Default,,0,0,0,,wider field of view; whereas,
Dialogue: 0,0:06:32.64,0:06:34.38,Default,,0,0,0,,longer focal length, longer box,
Dialogue: 0,0:06:34.38,0:06:35.66,Default,,0,0,0,,means narrower field of view.
Dialogue: 0,0:06:36.43,0:06:38.12,Default,,0,0,0,,The focal length is that
Dialogue: 0,0:06:38.17,0:06:40.38,Default,,0,0,0,,constant distance by which real
Dialogue: 0,0:06:40.38,0:06:41.65,Default,,0,0,0,,world distances are flattened
Dialogue: 0,0:06:41.65,0:06:42.82,Default,,0,0,0,,into a 2D image.
Dialogue: 0,0:06:43.46,0:06:44.96,Default,,0,0,0,,Put simply, a depth map is a
Dialogue: 0,0:06:44.96,0:06:47.18,Default,,0,0,0,,transformation of a 3D depth
Dialogue: 0,0:06:47.45,0:06:49.83,Default,,0,0,0,,into a 2D, single channel image
Dialogue: 0,0:06:50.12,0:06:51.48,Default,,0,0,0,,where each pixel value is a
Dialogue: 0,0:06:51.48,0:06:52.75,Default,,0,0,0,,different depth, like five
Dialogue: 0,0:06:52.75,0:06:54.40,Default,,0,0,0,,meters, four meters, three
Dialogue: 0,0:06:54.40,0:06:54.85,Default,,0,0,0,,meters.
Dialogue: 0,0:06:56.56,0:06:58.91,Default,,0,0,0,,Now, to truly measure depth you
Dialogue: 0,0:06:58.91,0:07:00.78,Default,,0,0,0,,need a purpose-built camera for
Dialogue: 0,0:07:00.78,0:07:01.51,Default,,0,0,0,,this, something like a
Dialogue: 0,0:07:01.51,0:07:02.69,Default,,0,0,0,,time-of-flight camera.
Dialogue: 0,0:07:03.15,0:07:04.60,Default,,0,0,0,,For instance, a system that
Dialogue: 0,0:07:04.98,0:07:07.08,Default,,0,0,0,,bounces light signals off of
Dialogue: 0,0:07:07.08,0:07:08.39,Default,,0,0,0,,objects and then measures the
Dialogue: 0,0:07:08.39,0:07:09.77,Default,,0,0,0,,time that it takes to return
Dialogue: 0,0:07:09.77,0:07:10.66,Default,,0,0,0,,back to the sensor.
Dialogue: 0,0:07:10.99,0:07:13.70,Default,,0,0,0,,The iPhone 7 dual camera is not
Dialogue: 0,0:07:14.03,0:07:15.28,Default,,0,0,0,,a time-of-flight camera.
Dialogue: 0,0:07:16.11,0:07:18.34,Default,,0,0,0,,Instead, it is a disparity-based
Dialogue: 0,0:07:18.34,0:07:18.85,Default,,0,0,0,,system.
Dialogue: 0,0:07:19.37,0:07:21.38,Default,,0,0,0,,Disparity is a measure of the
Dialogue: 0,0:07:21.38,0:07:24.01,Default,,0,0,0,,magnitude of shift of an object
Dialogue: 0,0:07:24.01,0:07:25.28,Default,,0,0,0,,when observed from two different
Dialogue: 0,0:07:25.28,0:07:26.55,Default,,0,0,0,,cameras, like your eyeballs.
Dialogue: 0,0:07:27.12,0:07:28.28,Default,,0,0,0,,Disparity is another name for
Dialogue: 0,0:07:28.28,0:07:28.97,Default,,0,0,0,,parallax.
Dialogue: 0,0:07:29.93,0:07:31.59,Default,,0,0,0,,You can observe this effect by
Dialogue: 0,0:07:31.59,0:07:33.62,Default,,0,0,0,,holding your head steady and
Dialogue: 0,0:07:33.62,0:07:35.50,Default,,0,0,0,,fixing your gaze on something
Dialogue: 0,0:07:35.73,0:07:37.87,Default,,0,0,0,,close, and then without moving
Dialogue: 0,0:07:37.87,0:07:39.45,Default,,0,0,0,,your head, close one eye and
Dialogue: 0,0:07:39.45,0:07:40.11,Default,,0,0,0,,then the other eye.
Dialogue: 0,0:07:40.24,0:07:41.13,Default,,0,0,0,,So, for instance, this would be
Dialogue: 0,0:07:41.13,0:07:44.67,Default,,0,0,0,,left eye, right eye; left eye,
Dialogue: 0,0:07:45.84,0:07:46.27,Default,,0,0,0,,right eye.
Dialogue: 0,0:07:46.77,0:07:47.76,Default,,0,0,0,,And you can see the colored
Dialogue: 0,0:07:47.76,0:07:49.55,Default,,0,0,0,,pencils appear to shift a lot
Dialogue: 0,0:07:49.55,0:07:50.73,Default,,0,0,0,,more than the markers in the
Dialogue: 0,0:07:50.73,0:07:52.11,Default,,0,0,0,,back because they are closer.
Dialogue: 0,0:07:52.25,0:07:53.65,Default,,0,0,0,,That's the parallax effect, or
Dialogue: 0,0:07:53.65,0:07:54.22,Default,,0,0,0,,disparity.
Dialogue: 0,0:07:55.78,0:07:56.98,Default,,0,0,0,,Now back to our pinhole camera
Dialogue: 0,0:07:56.98,0:07:57.31,Default,,0,0,0,,model.
Dialogue: 0,0:07:57.97,0:07:59.68,Default,,0,0,0,,Now I've taken a bird's eye view
Dialogue: 0,0:07:59.91,0:08:02.05,Default,,0,0,0,,of two cameras that are said to
Dialogue: 0,0:08:02.05,0:08:03.76,Default,,0,0,0,,be stereo rectified.
Dialogue: 0,0:08:04.30,0:08:06.15,Default,,0,0,0,,That means, one, that they are
Dialogue: 0,0:08:06.15,0:08:07.46,Default,,0,0,0,,parallel to one another, they're
Dialogue: 0,0:08:07.46,0:08:08.85,Default,,0,0,0,,pointing in the same direction,
Dialogue: 0,0:08:09.51,0:08:11.39,Default,,0,0,0,,and two, they have the same
Dialogue: 0,0:08:11.39,0:08:12.67,Default,,0,0,0,,focal length, which is very
Dialogue: 0,0:08:12.67,0:08:13.16,Default,,0,0,0,,important.
Dialogue: 0,0:08:13.94,0:08:14.99,Default,,0,0,0,,That's the distance from the
Dialogue: 0,0:08:14.99,0:08:16.39,Default,,0,0,0,,focal point to the image plane
Dialogue: 0,0:08:16.39,0:08:16.98,Default,,0,0,0,,or sensor.
Dialogue: 0,0:08:17.64,0:08:19.43,Default,,0,0,0,,Each camera will have a measured
Dialogue: 0,0:08:19.47,0:08:21.39,Default,,0,0,0,,optical center or a principal
Dialogue: 0,0:08:21.39,0:08:23.34,Default,,0,0,0,,point, and if you draw a
Dialogue: 0,0:08:23.34,0:08:24.73,Default,,0,0,0,,perpendicular line from the
Dialogue: 0,0:08:24.73,0:08:27.82,Default,,0,0,0,,pinhole to the image plane, then
Dialogue: 0,0:08:27.82,0:08:29.17,Default,,0,0,0,,the optical center is the point
Dialogue: 0,0:08:29.17,0:08:30.78,Default,,0,0,0,,at which it intersects with the
Dialogue: 0,0:08:30.78,0:08:31.40,Default,,0,0,0,,image plane.
Dialogue: 0,0:08:31.99,0:08:32.97,Default,,0,0,0,,Now, there's another term that
Dialogue: 0,0:08:32.97,0:08:33.99,Default,,0,0,0,,you should be familiar with and
Dialogue: 0,0:08:33.99,0:08:35.09,Default,,0,0,0,,that is baseline.
Dialogue: 0,0:08:35.72,0:08:37.45,Default,,0,0,0,,Baseline refers to the distance
Dialogue: 0,0:08:37.45,0:08:39.25,Default,,0,0,0,,between the two optical centers
Dialogue: 0,0:08:39.25,0:08:40.34,Default,,0,0,0,,of the lenses in a
Dialogue: 0,0:08:40.34,0:08:41.71,Default,,0,0,0,,stereo-rectified system.
Dialogue: 0,0:08:42.39,0:08:43.18,Default,,0,0,0,,Here's how it works.
Dialogue: 0,0:08:43.76,0:08:45.89,Default,,0,0,0,,Rays of light from an observed
Dialogue: 0,0:08:45.89,0:08:48.24,Default,,0,0,0,,object pass through the optical
Dialogue: 0,0:08:48.24,0:08:51.20,Default,,0,0,0,,centers and -- or through the
Dialogue: 0,0:08:51.20,0:08:53.65,Default,,0,0,0,,apertures and land at different
Dialogue: 0,0:08:53.65,0:08:55.39,Default,,0,0,0,,points on the image planes of
Dialogue: 0,0:08:55.39,0:08:56.20,Default,,0,0,0,,the two cameras.
Dialogue: 0,0:08:57.42,0:08:58.68,Default,,0,0,0,,A fourth term that I'm going to
Dialogue: 0,0:08:58.68,0:09:00.27,Default,,0,0,0,,throw at you right now is Z.
Dialogue: 0,0:09:00.45,0:09:02.93,Default,,0,0,0,,Z is the canonical term for
Dialogue: 0,0:09:02.93,0:09:06.32,Default,,0,0,0,,depth, or real-world depth.
Dialogue: 0,0:09:06.32,0:09:07.50,Default,,0,0,0,,Now, watch what happens to the
Dialogue: 0,0:09:07.50,0:09:09.54,Default,,0,0,0,,points on the image plane as the
Dialogue: 0,0:09:09.54,0:09:11.43,Default,,0,0,0,,observed point gets farther
Dialogue: 0,0:09:11.43,0:09:11.77,Default,,0,0,0,,away.
Dialogue: 0,0:09:13.88,0:09:15.40,Default,,0,0,0,,They moved closer together.
Dialogue: 0,0:09:15.40,0:09:16.18,Default,,0,0,0,,I'm going to show that to you
Dialogue: 0,0:09:16.18,0:09:16.79,Default,,0,0,0,,one more time.
Dialogue: 0,0:09:17.90,0:09:19.25,Default,,0,0,0,,So as the real point gets
Dialogue: 0,0:09:19.25,0:09:21.72,Default,,0,0,0,,farther away, they get closer
Dialogue: 0,0:09:21.72,0:09:24.30,Default,,0,0,0,,together on the image plane, and
Dialogue: 0,0:09:24.84,0:09:26.73,Default,,0,0,0,,as the object gets closer, the
Dialogue: 0,0:09:26.73,0:09:28.36,Default,,0,0,0,,dots move farther away from each
Dialogue: 0,0:09:28.36,0:09:28.58,Default,,0,0,0,,other.
Dialogue: 0,0:09:29.11,0:09:30.63,Default,,0,0,0,,So when the cameras are stereo
Dialogue: 0,0:09:30.63,0:09:32.46,Default,,0,0,0,,rectified, these shifts only
Dialogue: 0,0:09:32.46,0:09:33.57,Default,,0,0,0,,move in one direction.
Dialogue: 0,0:09:34.04,0:09:35.52,Default,,0,0,0,,They either move closer or
Dialogue: 0,0:09:35.52,0:09:36.93,Default,,0,0,0,,farther away from one another,
Dialogue: 0,0:09:36.93,0:09:39.18,Default,,0,0,0,,but on the same line, or the
Dialogue: 0,0:09:39.18,0:09:40.20,Default,,0,0,0,,epipolar line.
Dialogue: 0,0:09:41.80,0:09:42.89,Default,,0,0,0,,Now, knowing the baseline you
Dialogue: 0,0:09:42.89,0:09:43.99,Default,,0,0,0,,can essentially line up the
Dialogue: 0,0:09:43.99,0:09:45.27,Default,,0,0,0,,cameras along their optical
Dialogue: 0,0:09:45.27,0:09:47.75,Default,,0,0,0,,centers like this and subtract
Dialogue: 0,0:09:47.75,0:09:48.76,Default,,0,0,0,,the distance between the
Dialogue: 0,0:09:48.76,0:09:50.55,Default,,0,0,0,,observed points on the image
Dialogue: 0,0:09:50.55,0:09:52.73,Default,,0,0,0,,planes to get the disparity.
Dialogue: 0,0:09:53.29,0:09:54.32,Default,,0,0,0,,That's what disparity is.
Dialogue: 0,0:09:55.08,0:09:56.63,Default,,0,0,0,,You can express this distance in
Dialogue: 0,0:09:56.63,0:09:57.99,Default,,0,0,0,,whatever units make sense for
Dialogue: 0,0:09:57.99,0:09:58.75,Default,,0,0,0,,your processing.
Dialogue: 0,0:09:58.92,0:10:00.70,Default,,0,0,0,,It could be pixels, meters,
Dialogue: 0,0:10:00.70,0:10:01.44,Default,,0,0,0,,microns.
Dialogue: 0,0:10:02.03,0:10:03.29,Default,,0,0,0,,And it's common to store it in
Dialogue: 0,0:10:03.29,0:10:05.62,Default,,0,0,0,,pixels since we think of RGB
Dialogue: 0,0:10:05.62,0:10:07.44,Default,,0,0,0,,images in pixels.
Dialogue: 0,0:10:08.21,0:10:09.61,Default,,0,0,0,,Now, storing pixel shifts works
Dialogue: 0,0:10:09.61,0:10:11.33,Default,,0,0,0,,fine, as long as the image that
Dialogue: 0,0:10:11.33,0:10:13.24,Default,,0,0,0,,they accompany never changes
Dialogue: 0,0:10:13.34,0:10:13.97,Default,,0,0,0,,size.
Dialogue: 0,0:10:14.95,0:10:16.38,Default,,0,0,0,,It's not so good if you're going
Dialogue: 0,0:10:16.38,0:10:18.39,Default,,0,0,0,,to edit that image because if
Dialogue: 0,0:10:18.39,0:10:19.75,Default,,0,0,0,,you've scaled the image down,
Dialogue: 0,0:10:20.07,0:10:21.56,Default,,0,0,0,,you've now effectively changed
Dialogue: 0,0:10:21.56,0:10:22.44,Default,,0,0,0,,the pixel size.
Dialogue: 0,0:10:22.73,0:10:23.97,Default,,0,0,0,,So you have to go through the
Dialogue: 0,0:10:23.97,0:10:26.05,Default,,0,0,0,,map and you have to scale each
Dialogue: 0,0:10:26.05,0:10:27.20,Default,,0,0,0,,value in the depth map.
Dialogue: 0,0:10:27.62,0:10:28.41,Default,,0,0,0,,That's a very brittle
Dialogue: 0,0:10:28.41,0:10:29.25,Default,,0,0,0,,representation.
Dialogue: 0,0:10:30.63,0:10:32.58,Default,,0,0,0,,Instead, we at Apple have chosen
Dialogue: 0,0:10:32.58,0:10:34.04,Default,,0,0,0,,to express disparity using
Dialogue: 0,0:10:34.20,0:10:36.38,Default,,0,0,0,,normalized values that are
Dialogue: 0,0:10:36.38,0:10:37.98,Default,,0,0,0,,resilient to scaling operations.
Dialogue: 0,0:10:38.38,0:10:39.86,Default,,0,0,0,,So here's how we do that.
Dialogue: 0,0:10:40.21,0:10:41.52,Default,,0,0,0,,Again, going to our observed
Dialogue: 0,0:10:41.52,0:10:43.81,Default,,0,0,0,,point, you'll notice that there
Dialogue: 0,0:10:43.81,0:10:45.38,Default,,0,0,0,,are two similar triangles being
Dialogue: 0,0:10:45.38,0:10:45.78,Default,,0,0,0,,formed.
Dialogue: 0,0:10:46.09,0:10:47.24,Default,,0,0,0,,I'll highlight them for you.
Dialogue: 0,0:10:48.72,0:10:51.06,Default,,0,0,0,,These triangles have equal
Dialogue: 0,0:10:51.06,0:10:53.15,Default,,0,0,0,,ratios of sides and proportions.
Dialogue: 0,0:10:53.84,0:10:55.29,Default,,0,0,0,,Now, if I get rid of the cameras
Dialogue: 0,0:10:55.29,0:10:56.44,Default,,0,0,0,,to just show you the triangles,
Dialogue: 0,0:10:56.91,0:10:58.56,Default,,0,0,0,,the real-world triangle sides
Dialogue: 0,0:10:58.56,0:11:01.86,Default,,0,0,0,,are Z, or meters, and baseline,
Dialogue: 0,0:11:01.93,0:11:02.94,Default,,0,0,0,,the distance between the two
Dialogue: 0,0:11:02.94,0:11:03.72,Default,,0,0,0,,optical centers.
Dialogue: 0,0:11:05.00,0:11:06.51,Default,,0,0,0,,Inside the light box, or the
Dialogue: 0,0:11:06.51,0:11:09.50,Default,,0,0,0,,lightproof box, that same
Dialogue: 0,0:11:09.50,0:11:11.36,Default,,0,0,0,,triangle is represented as the
Dialogue: 0,0:11:11.36,0:11:13.37,Default,,0,0,0,,focal length in pixels and the
Dialogue: 0,0:11:13.37,0:11:14.92,Default,,0,0,0,,disparity in pixels.
Dialogue: 0,0:11:15.20,0:11:17.15,Default,,0,0,0,,Do you feel math coming on?
Dialogue: 0,0:11:17.19,0:11:18.04,Default,,0,0,0,,I feel math coming on.
Dialogue: 0,0:11:18.65,0:11:19.77,Default,,0,0,0,,So stay with me here.
Dialogue: 0,0:11:19.77,0:11:21.98,Default,,0,0,0,,This is pretty painless.
Dialogue: 0,0:11:22.74,0:11:29.57,Default,,0,0,0,,Baseline is to Z as pixel
Dialogue: 0,0:11:30.60,0:11:32.94,Default,,0,0,0,,disparity is to focal length.
Dialogue: 0,0:11:33.67,0:11:36.12,Default,,0,0,0,,Okay. Well, what if we divide
Dialogue: 0,0:11:36.12,0:11:38.40,Default,,0,0,0,,both sides by the baseline so
Dialogue: 0,0:11:38.40,0:11:41.03,Default,,0,0,0,,the b's cancel out on the left,
Dialogue: 0,0:11:41.51,0:11:43.65,Default,,0,0,0,,and what you're left with is 1
Dialogue: 0,0:11:43.65,0:11:44.31,Default,,0,0,0,,over z.
Dialogue: 0,0:11:45.29,0:11:45.98,Default,,0,0,0,,That's pretty nice.
Dialogue: 0,0:11:46.64,0:11:48.89,Default,,0,0,0,,1 over z is inverse depth.
Dialogue: 0,0:11:49.39,0:11:50.96,Default,,0,0,0,,That is literally what disparity
Dialogue: 0,0:11:50.96,0:11:51.43,Default,,0,0,0,,means.
Dialogue: 0,0:11:51.90,0:11:53.13,Default,,0,0,0,,When an object moves farther
Dialogue: 0,0:11:53.13,0:11:55.16,Default,,0,0,0,,away, the disparity shrinks.
Dialogue: 0,0:11:55.76,0:11:57.15,Default,,0,0,0,,When it moves closer, the
Dialogue: 0,0:11:57.15,0:11:58.03,Default,,0,0,0,,disparity grows.
Dialogue: 0,0:11:58.03,0:11:59.61,Default,,0,0,0,,So it is the inverse of depth.
Dialogue: 0,0:12:01.34,0:12:02.63,Default,,0,0,0,,What remains on the right is
Dialogue: 0,0:12:02.63,0:12:04.43,Default,,0,0,0,,what we call normalized
Dialogue: 0,0:12:04.43,0:12:05.03,Default,,0,0,0,,disparity.
Dialogue: 0,0:12:05.10,0:12:06.36,Default,,0,0,0,,So it's not a pixel shift
Dialogue: 0,0:12:06.36,0:12:09.16,Default,,0,0,0,,anymore, it's d over focal
Dialogue: 0,0:12:09.16,0:12:11.07,Default,,0,0,0,,length times baseline.
Dialogue: 0,0:12:11.53,0:12:13.24,Default,,0,0,0,,The baseline is baked in so you
Dialogue: 0,0:12:13.24,0:12:14.20,Default,,0,0,0,,don't need to carry that
Dialogue: 0,0:12:14.20,0:12:15.92,Default,,0,0,0,,information with you separately
Dialogue: 0,0:12:16.14,0:12:17.08,Default,,0,0,0,,when you're dealing with the
Dialogue: 0,0:12:17.08,0:12:17.65,Default,,0,0,0,,depth map.
Dialogue: 0,0:12:18.26,0:12:20.18,Default,,0,0,0,,The units are 1 over meters,
Dialogue: 0,0:12:20.18,0:12:22.17,Default,,0,0,0,,just as it's 1 over z, and it
Dialogue: 0,0:12:22.29,0:12:23.90,Default,,0,0,0,,withstands scaling operations,
Dialogue: 0,0:12:24.44,0:12:25.67,Default,,0,0,0,,and as you can see, converting
Dialogue: 0,0:12:25.67,0:12:27.74,Default,,0,0,0,,from depth to disparity is
Dialogue: 0,0:12:27.74,0:12:29.02,Default,,0,0,0,,trivial, since it's just a
Dialogue: 0,0:12:29.02,0:12:30.09,Default,,0,0,0,,1-over operation.
Dialogue: 0,0:12:31.17,0:12:33.42,Default,,0,0,0,,Is anyone feeling way beyond
Dialogue: 0,0:12:33.42,0:12:33.98,Default,,0,0,0,,their depth at this point?
Dialogue: 0,0:12:34.52,0:12:36.59,Default,,0,0,0,,[ Group groaning ]
Dialogue: 0,0:12:37.09,0:12:38.26,Default,,0,0,0,,This is a little tricky stuff,
Dialogue: 0,0:12:38.30,0:12:40.39,Default,,0,0,0,,but the takeaways are simple.
Dialogue: 0,0:12:41.99,0:12:43.33,Default,,0,0,0,,We have a disparity-based
Dialogue: 0,0:12:43.33,0:12:44.21,Default,,0,0,0,,system, not a true
Dialogue: 0,0:12:44.21,0:12:46.07,Default,,0,0,0,,time-of-flight camera, but
Dialogue: 0,0:12:46.07,0:12:47.81,Default,,0,0,0,,disparity is a great proxy for
Dialogue: 0,0:12:47.81,0:12:50.48,Default,,0,0,0,,depth, and normalized disparity
Dialogue: 0,0:12:50.48,0:12:55.18,Default,,0,0,0,,is the inverse of depth.
Dialogue: 0,0:12:55.35,0:12:56.77,Default,,0,0,0,,Hey, speaking of normalized
Dialogue: 0,0:12:56.77,0:12:58.30,Default,,0,0,0,,disparity as being the inverse
Dialogue: 0,0:12:58.30,0:12:58.96,Default,,0,0,0,,of depth, here's a deep thought.
Dialogue: 0,0:13:03.29,0:13:05.91,Default,,0,0,0,,This image has a disparity map,
Dialogue: 0,0:13:06.64,0:13:08.48,Default,,0,0,0,,so I guess this would make this
Dialogue: 0,0:13:08.48,0:13:09.98,Default,,0,0,0,,a depth-defying leap.
Dialogue: 0,0:13:10.52,0:13:12.60,Default,,0,0,0,,[ Group groaning ]
Dialogue: 0,0:13:13.10,0:13:13.56,Default,,0,0,0,,Thank you.
Dialogue: 0,0:13:13.81,0:13:14.80,Default,,0,0,0,,All right.
Dialogue: 0,0:13:15.21,0:13:17.76,Default,,0,0,0,,So in our depth API set we use
Dialogue: 0,0:13:17.76,0:13:20.10,Default,,0,0,0,,the term depth data, and this is
Dialogue: 0,0:13:20.10,0:13:21.44,Default,,0,0,0,,a generic term for anything
Dialogue: 0,0:13:21.44,0:13:22.24,Default,,0,0,0,,that's depthy.
Dialogue: 0,0:13:22.66,0:13:24.75,Default,,0,0,0,,It can refer to either a true
Dialogue: 0,0:13:24.75,0:13:26.64,Default,,0,0,0,,depth map or a disparity map.
Dialogue: 0,0:13:26.77,0:13:28.16,Default,,0,0,0,,Both are related to depth,
Dialogue: 0,0:13:28.36,0:13:29.69,Default,,0,0,0,,they're both depthy, so they are
Dialogue: 0,0:13:29.69,0:13:30.85,Default,,0,0,0,,both depth data.
Dialogue: 0,0:13:32.47,0:13:34.24,Default,,0,0,0,,And we have a purpose-built
Dialogue: 0,0:13:34.24,0:13:35.28,Default,,0,0,0,,object for this.
Dialogue: 0,0:13:35.40,0:13:36.96,Default,,0,0,0,,The canonical representation on
Dialogue: 0,0:13:36.96,0:13:38.46,Default,,0,0,0,,our platform for depth is called
Dialogue: 0,0:13:38.46,0:13:40.14,Default,,0,0,0,,an AVDepthData.
Dialogue: 0,0:13:40.52,0:13:42.89,Default,,0,0,0,,It's available on iOS, macOS and
Dialogue: 0,0:13:42.89,0:13:43.38,Default,,0,0,0,,tvOS.
Dialogue: 0,0:13:43.95,0:13:45.39,Default,,0,0,0,,It's a class in the AVFoundation
Dialogue: 0,0:13:45.39,0:13:47.29,Default,,0,0,0,,framework and it represents
Dialogue: 0,0:13:47.29,0:13:49.03,Default,,0,0,0,,either depth or disparity maps.
Dialogue: 0,0:13:49.52,0:13:50.99,Default,,0,0,0,,It also provides some nice
Dialogue: 0,0:13:50.99,0:13:52.61,Default,,0,0,0,,facilities to convert between
Dialogue: 0,0:13:52.61,0:13:53.68,Default,,0,0,0,,depth and disparity.
Dialogue: 0,0:13:54.72,0:13:55.83,Default,,0,0,0,,Okay. Let's get into the nuts
Dialogue: 0,0:13:55.83,0:13:57.41,Default,,0,0,0,,and bolts of depth maps.
Dialogue: 0,0:13:58.11,0:13:59.89,Default,,0,0,0,,Depth maps are images, if you
Dialogue: 0,0:13:59.89,0:14:00.97,Default,,0,0,0,,haven't figured out by now.
Dialogue: 0,0:14:01.03,0:14:02.77,Default,,0,0,0,,They're kind of like RGB images,
Dialogue: 0,0:14:02.77,0:14:04.11,Default,,0,0,0,,except they're single channel,
Dialogue: 0,0:14:04.61,0:14:05.85,Default,,0,0,0,,but they can still be expressed
Dialogue: 0,0:14:05.85,0:14:08.02,Default,,0,0,0,,as CV pixel buffers, and now
Dialogue: 0,0:14:08.02,0:14:09.87,Default,,0,0,0,,CoreVideo defines four new pixel
Dialogue: 0,0:14:09.87,0:14:12.21,Default,,0,0,0,,formats for the types that we
Dialogue: 0,0:14:12.21,0:14:13.46,Default,,0,0,0,,saw on the previous slide.
Dialogue: 0,0:14:13.52,0:14:15.00,Default,,0,0,0,,They're all floating point.
Dialogue: 0,0:14:15.71,0:14:18.17,Default,,0,0,0,,The first two are for normalized
Dialogue: 0,0:14:18.17,0:14:20.03,Default,,0,0,0,,disparity and it's measured in 1
Dialogue: 0,0:14:20.03,0:14:20.87,Default,,0,0,0,,over meters.
Dialogue: 0,0:14:20.87,0:14:22.30,Default,,0,0,0,,Notice that there's a 16-bit
Dialogue: 0,0:14:22.30,0:14:24.22,Default,,0,0,0,,flavor and a 32-bit flavor.
Dialogue: 0,0:14:24.92,0:14:27.15,Default,,0,0,0,,The second two are for depth and
Dialogue: 0,0:14:27.15,0:14:28.21,Default,,0,0,0,,they're measured in meters.
Dialogue: 0,0:14:29.16,0:14:31.01,Default,,0,0,0,,They also come in 16- or 32-bit
Dialogue: 0,0:14:31.01,0:14:31.46,Default,,0,0,0,,flavors.
Dialogue: 0,0:14:31.59,0:14:32.54,Default,,0,0,0,,Why would we do this?
Dialogue: 0,0:14:33.23,0:14:34.10,Default,,0,0,0,,Well, if you're going to be
Dialogue: 0,0:14:34.10,0:14:35.76,Default,,0,0,0,,working with depth on the GPU,
Dialogue: 0,0:14:35.76,0:14:36.96,Default,,0,0,0,,it would make sense for you to
Dialogue: 0,0:14:36.96,0:14:39.19,Default,,0,0,0,,request 16-bit or half float
Dialogue: 0,0:14:39.31,0:14:40.72,Default,,0,0,0,,values of depth.
Dialogue: 0,0:14:40.72,0:14:42.16,Default,,0,0,0,,If you'll be working on the CPU,
Dialogue: 0,0:14:42.45,0:14:43.85,Default,,0,0,0,,you should work with the full
Dialogue: 0,0:14:43.85,0:14:46.12,Default,,0,0,0,,32-bit float variants.
Dialogue: 0,0:14:46.12,0:14:46.74,Default,,0,0,0,,They'll work better.
Dialogue: 0,0:14:48.48,0:14:49.65,Default,,0,0,0,,We'll talk later about where an
Dialogue: 0,0:14:49.65,0:14:51.44,Default,,0,0,0,,AVDepthData object might come
Dialogue: 0,0:14:51.44,0:14:52.64,Default,,0,0,0,,from, but for right now let's
Dialogue: 0,0:14:52.64,0:14:53.71,Default,,0,0,0,,just focus on its core
Dialogue: 0,0:14:53.71,0:14:54.37,Default,,0,0,0,,properties.
Dialogue: 0,0:14:55.14,0:14:57.16,Default,,0,0,0,,Given an AVDepthData object you
Dialogue: 0,0:14:57.16,0:14:58.86,Default,,0,0,0,,can query its depth data type,
Dialogue: 0,0:14:59.22,0:15:00.54,Default,,0,0,0,,which is one of those four pixel
Dialogue: 0,0:15:00.54,0:15:02.98,Default,,0,0,0,,formats; you can get access to
Dialogue: 0,0:15:02.98,0:15:04.93,Default,,0,0,0,,the depthDataMap itself which,
Dialogue: 0,0:15:04.93,0:15:06.88,Default,,0,0,0,,again, is a CV pixel buffer; you
Dialogue: 0,0:15:06.88,0:15:08.35,Default,,0,0,0,,can iterate through it by row
Dialogue: 0,0:15:08.35,0:15:09.93,Default,,0,0,0,,and column using standard CV
Dialogue: 0,0:15:09.93,0:15:10.77,Default,,0,0,0,,pixel buffer APIs.
Dialogue: 0,0:15:10.77,0:15:13.57,Default,,0,0,0,,And the final two properties I
Dialogue: 0,0:15:13.57,0:15:15.04,Default,,0,0,0,,want to highlight here have to
Dialogue: 0,0:15:15.04,0:15:16.97,Default,,0,0,0,,do with inherent problems in
Dialogue: 0,0:15:16.97,0:15:19.33,Default,,0,0,0,,capturing depth data, and we're
Dialogue: 0,0:15:19.33,0:15:19.91,Default,,0,0,0,,going to go through these
Dialogue: 0,0:15:19.91,0:15:21.43,Default,,0,0,0,,problems one at a time and
Dialogue: 0,0:15:21.43,0:15:22.65,Default,,0,0,0,,discuss the solutions.
Dialogue: 0,0:15:23.24,0:15:25.65,Default,,0,0,0,,The first problem is holes,
Dialogue: 0,0:15:25.96,0:15:27.42,Default,,0,0,0,,holes in the depth data.
Dialogue: 0,0:15:27.61,0:15:29.63,Default,,0,0,0,,To calculate disparity both
Dialogue: 0,0:15:29.63,0:15:31.39,Default,,0,0,0,,cameras need to observe that
Dialogue: 0,0:15:31.39,0:15:32.89,Default,,0,0,0,,same point, but from two
Dialogue: 0,0:15:32.89,0:15:33.74,Default,,0,0,0,,different perspectives.
Dialogue: 0,0:15:34.16,0:15:36.12,Default,,0,0,0,,If they can't see it, no
Dialogue: 0,0:15:36.12,0:15:36.68,Default,,0,0,0,,disparity.
Dialogue: 0,0:15:37.26,0:15:38.62,Default,,0,0,0,,So why might they not be able to
Dialogue: 0,0:15:38.62,0:15:38.97,Default,,0,0,0,,see it?
Dialogue: 0,0:15:39.76,0:15:42.29,Default,,0,0,0,,For one, occlusions, such as a
Dialogue: 0,0:15:42.29,0:15:43.76,Default,,0,0,0,,creepy finger coming in and
Dialogue: 0,0:15:43.95,0:15:45.29,Default,,0,0,0,,suddenly blocking one of your
Dialogue: 0,0:15:45.29,0:15:45.83,Default,,0,0,0,,cameras.
Dialogue: 0,0:15:45.83,0:15:47.89,Default,,0,0,0,,If it's partially obscuring it
Dialogue: 0,0:15:47.89,0:15:49.43,Default,,0,0,0,,or obscuring it, you don't have
Dialogue: 0,0:15:49.49,0:15:52.36,Default,,0,0,0,,two points of view anymore,
Dialogue: 0,0:15:52.36,0:15:53.33,Default,,0,0,0,,therefore, you have no
Dialogue: 0,0:15:53.33,0:15:53.89,Default,,0,0,0,,disparity.
Dialogue: 0,0:15:55.07,0:15:56.86,Default,,0,0,0,,Another more common reason is
Dialogue: 0,0:15:56.90,0:15:58.71,Default,,0,0,0,,difficulty in finding features.
Dialogue: 0,0:15:59.54,0:16:01.11,Default,,0,0,0,,When camera one and camera two's
Dialogue: 0,0:16:01.11,0:16:03.01,Default,,0,0,0,,images are compared, remember,
Dialogue: 0,0:16:03.01,0:16:04.91,Default,,0,0,0,,they line them up by optical
Dialogue: 0,0:16:04.91,0:16:06.31,Default,,0,0,0,,center and look for features
Dialogue: 0,0:16:07.18,0:16:08.43,Default,,0,0,0,,matching key points.
Dialogue: 0,0:16:09.00,0:16:10.87,Default,,0,0,0,,Let's say it's dark out and the
Dialogue: 0,0:16:10.87,0:16:12.51,Default,,0,0,0,,observed point may not have very
Dialogue: 0,0:16:12.51,0:16:13.99,Default,,0,0,0,,well-defined features anymore,
Dialogue: 0,0:16:14.41,0:16:16.72,Default,,0,0,0,,the color is a little bit noisy,
Dialogue: 0,0:16:16.72,0:16:18.11,Default,,0,0,0,,the edges are hard to find.
Dialogue: 0,0:16:18.81,0:16:20.14,Default,,0,0,0,,Another example would be if you
Dialogue: 0,0:16:20.14,0:16:21.40,Default,,0,0,0,,point the cameras at a flat,
Dialogue: 0,0:16:21.40,0:16:24.15,Default,,0,0,0,,white wall with no texture to
Dialogue: 0,0:16:24.15,0:16:26.09,Default,,0,0,0,,it, there are no features so
Dialogue: 0,0:16:26.09,0:16:27.35,Default,,0,0,0,,it's very hard to find
Dialogue: 0,0:16:27.35,0:16:29.35,Default,,0,0,0,,differences in matching.
Dialogue: 0,0:16:29.47,0:16:30.87,Default,,0,0,0,,For any of these reasons you
Dialogue: 0,0:16:30.87,0:16:32.46,Default,,0,0,0,,might have areas in your image
Dialogue: 0,0:16:32.89,0:16:35.16,Default,,0,0,0,,where there is no disparity, and
Dialogue: 0,0:16:35.16,0:16:36.10,Default,,0,0,0,,those are called holes.
Dialogue: 0,0:16:37.31,0:16:39.11,Default,,0,0,0,,Holes are expressed in the
Dialogue: 0,0:16:39.11,0:16:41.77,Default,,0,0,0,,depthDataMap as not a number
Dialogue: 0,0:16:42.19,0:16:43.53,Default,,0,0,0,,standard floating-point
Dialogue: 0,0:16:43.53,0:16:45.10,Default,,0,0,0,,representation, either 16-bit or
Dialogue: 0,0:16:45.10,0:16:45.80,Default,,0,0,0,,32-bit.
Dialogue: 0,0:16:46.51,0:16:48.62,Default,,0,0,0,,Depth maps may also be processed
Dialogue: 0,0:16:48.89,0:16:50.05,Default,,0,0,0,,to fill in the holes.
Dialogue: 0,0:16:50.53,0:16:52.71,Default,,0,0,0,,We can do this by interpolating
Dialogue: 0,0:16:52.71,0:16:54.23,Default,,0,0,0,,based on surrounding depth data
Dialogue: 0,0:16:54.23,0:16:56.44,Default,,0,0,0,,that's good or by using metadata
Dialogue: 0,0:16:56.44,0:16:58.17,Default,,0,0,0,,present in the RGB image.
Dialogue: 0,0:16:58.87,0:17:01.18,Default,,0,0,0,,The isDepthDataFiltered property
Dialogue: 0,0:17:01.18,0:17:03.27,Default,,0,0,0,,of AVDepthData tells you whether
Dialogue: 0,0:17:03.27,0:17:04.88,Default,,0,0,0,,the map has been processed in
Dialogue: 0,0:17:04.88,0:17:05.35,Default,,0,0,0,,this way.
Dialogue: 0,0:17:06.34,0:17:08.04,Default,,0,0,0,,If you receive an unfiltered
Dialogue: 0,0:17:08.04,0:17:09.79,Default,,0,0,0,,AVDepthData, you can expect to
Dialogue: 0,0:17:09.79,0:17:11.76,Default,,0,0,0,,find not a number values within
Dialogue: 0,0:17:11.91,0:17:13.05,Default,,0,0,0,,that map.
Dialogue: 0,0:17:13.33,0:17:14.72,Default,,0,0,0,,Okay. We'll talk a little bit
Dialogue: 0,0:17:14.72,0:17:16.44,Default,,0,0,0,,more about how you can request
Dialogue: 0,0:17:16.44,0:17:17.58,Default,,0,0,0,,filtering later on.
Dialogue: 0,0:17:18.62,0:17:20.38,Default,,0,0,0,,The second problem that
Dialogue: 0,0:17:20.38,0:17:21.49,Default,,0,0,0,,interferes with accurate
Dialogue: 0,0:17:21.49,0:17:22.96,Default,,0,0,0,,disparity generation is
Dialogue: 0,0:17:23.16,0:17:24.06,Default,,0,0,0,,calibration error.
Dialogue: 0,0:17:24.56,0:17:25.72,Default,,0,0,0,,There are lots of different
Dialogue: 0,0:17:25.72,0:17:26.92,Default,,0,0,0,,kinds of calibration errors that
Dialogue: 0,0:17:26.92,0:17:28.84,Default,,0,0,0,,can happen that we can correct,
Dialogue: 0,0:17:29.25,0:17:30.37,Default,,0,0,0,,but there's one that we can't,
Dialogue: 0,0:17:30.81,0:17:32.52,Default,,0,0,0,,and that is incorrect accounting
Dialogue: 0,0:17:32.52,0:17:34.61,Default,,0,0,0,,of the optical center in either
Dialogue: 0,0:17:34.61,0:17:36.35,Default,,0,0,0,,of the two cameras.
Dialogue: 0,0:17:36.75,0:17:38.89,Default,,0,0,0,,So for this one I've shifted our
Dialogue: 0,0:17:39.48,0:17:40.82,Default,,0,0,0,,pinhole cameras down to the
Dialogue: 0,0:17:40.82,0:17:42.28,Default,,0,0,0,,bottom by 90 degrees to give
Dialogue: 0,0:17:42.28,0:17:43.39,Default,,0,0,0,,myself a little more room at the
Dialogue: 0,0:17:43.39,0:17:43.79,Default,,0,0,0,,top.
Dialogue: 0,0:17:44.36,0:17:46.03,Default,,0,0,0,,In an ideal stereo-rectified
Dialogue: 0,0:17:46.03,0:17:48.35,Default,,0,0,0,,system, perspective only shifts
Dialogue: 0,0:17:48.35,0:17:50.43,Default,,0,0,0,,in one direction, left or right,
Dialogue: 0,0:17:51.22,0:17:52.70,Default,,0,0,0,,along these same lines.
Dialogue: 0,0:17:53.10,0:17:54.60,Default,,0,0,0,,So if there's a ray that's
Dialogue: 0,0:17:54.60,0:17:56.94,Default,,0,0,0,,observed from camera one, it
Dialogue: 0,0:17:56.94,0:17:58.82,Default,,0,0,0,,would be viewed as a series of
Dialogue: 0,0:17:58.87,0:18:01.06,Default,,0,0,0,,intersecting points on a line
Dialogue: 0,0:18:01.31,0:18:01.96,Default,,0,0,0,,from camera two, like this.
Dialogue: 0,0:18:06.05,0:18:06.96,Default,,0,0,0,,So for disparities to be
Dialogue: 0,0:18:06.96,0:18:09.50,Default,,0,0,0,,measured accurately you must
Dialogue: 0,0:18:09.50,0:18:11.24,Default,,0,0,0,,have an accurate baseline.
Dialogue: 0,0:18:11.53,0:18:12.89,Default,,0,0,0,,And baseline, again, is the
Dialogue: 0,0:18:12.89,0:18:14.10,Default,,0,0,0,,distance between the two optical
Dialogue: 0,0:18:14.10,0:18:14.51,Default,,0,0,0,,centers.
Dialogue: 0,0:18:15.07,0:18:16.16,Default,,0,0,0,,If you don't have an accurate
Dialogue: 0,0:18:16.16,0:18:18.19,Default,,0,0,0,,baseline, you can't align those
Dialogue: 0,0:18:18.19,0:18:19.79,Default,,0,0,0,,two cameras' optical centers and
Dialogue: 0,0:18:19.79,0:18:21.15,Default,,0,0,0,,you can't figure out how much
Dialogue: 0,0:18:21.15,0:18:22.11,Default,,0,0,0,,disparity there is.
Dialogue: 0,0:18:23.34,0:18:24.68,Default,,0,0,0,,Now, what happens if the optical
Dialogue: 0,0:18:24.68,0:18:27.20,Default,,0,0,0,,center is calculated wrong or
Dialogue: 0,0:18:27.20,0:18:28.16,Default,,0,0,0,,just misreported?
Dialogue: 0,0:18:28.92,0:18:29.86,Default,,0,0,0,,Let's say the true optical
Dialogue: 0,0:18:29.86,0:18:32.75,Default,,0,0,0,,center is here, but for some
Dialogue: 0,0:18:32.75,0:18:35.12,Default,,0,0,0,,reason it's misreported as being
Dialogue: 0,0:18:35.85,0:18:36.11,Default,,0,0,0,,here.
Dialogue: 0,0:18:36.96,0:18:38.20,Default,,0,0,0,,Now suddenly all of our
Dialogue: 0,0:18:38.33,0:18:39.86,Default,,0,0,0,,disparity points on camera two's
Dialogue: 0,0:18:39.86,0:18:41.22,Default,,0,0,0,,image plane are shifted to the
Dialogue: 0,0:18:41.22,0:18:44.18,Default,,0,0,0,,left by the same fixed amount.
Dialogue: 0,0:18:44.90,0:18:46.56,Default,,0,0,0,,Now all the objects will be
Dialogue: 0,0:18:46.56,0:18:48.27,Default,,0,0,0,,reported as being farther than
Dialogue: 0,0:18:48.27,0:18:49.07,Default,,0,0,0,,they truly are.
Dialogue: 0,0:18:50.11,0:18:51.22,Default,,0,0,0,,If the error were in the other
Dialogue: 0,0:18:51.22,0:18:52.50,Default,,0,0,0,,direction, then the objects
Dialogue: 0,0:18:52.50,0:18:53.65,Default,,0,0,0,,would be misreported as being
Dialogue: 0,0:18:53.65,0:18:54.29,Default,,0,0,0,,too close.
Dialogue: 0,0:18:55.03,0:18:56.94,Default,,0,0,0,,So we can detect and fix a lot
Dialogue: 0,0:18:56.94,0:18:57.94,Default,,0,0,0,,of problems, but this one we
Dialogue: 0,0:18:57.94,0:18:59.62,Default,,0,0,0,,can't detect and fix because,
Dialogue: 0,0:18:59.62,0:19:00.99,Default,,0,0,0,,again, all of those points still
Dialogue: 0,0:19:00.99,0:19:02.14,Default,,0,0,0,,look like they're on the same
Dialogue: 0,0:19:02.19,0:19:03.09,Default,,0,0,0,,correct line.
Dialogue: 0,0:19:03.38,0:19:04.15,Default,,0,0,0,,We don't know the difference
Dialogue: 0,0:19:04.15,0:19:05.66,Default,,0,0,0,,between the baseline being wrong
Dialogue: 0,0:19:06.05,0:19:07.93,Default,,0,0,0,,and the person actually moving
Dialogue: 0,0:19:08.05,0:19:08.92,Default,,0,0,0,,further or closer.
Dialogue: 0,0:19:10.14,0:19:11.14,Default,,0,0,0,,Now, how can this happen; why
Dialogue: 0,0:19:11.14,0:19:12.45,Default,,0,0,0,,would there be problems with
Dialogue: 0,0:19:12.66,0:19:15.11,Default,,0,0,0,,optical center calculation?
Dialogue: 0,0:19:16.10,0:19:17.77,Default,,0,0,0,,iPhone cameras don't use
Dialogue: 0,0:19:17.77,0:19:20.61,Default,,0,0,0,,pinholes, they have lenses, and
Dialogue: 0,0:19:20.61,0:19:23.11,Default,,0,0,0,,on iPhones those lenses don't
Dialogue: 0,0:19:23.11,0:19:23.69,Default,,0,0,0,,stay still.
Dialogue: 0,0:19:24.37,0:19:26.92,Default,,0,0,0,,If OIS is engaged, then the lens
Dialogue: 0,0:19:26.92,0:19:28.44,Default,,0,0,0,,may be moving laterally to
Dialogue: 0,0:19:28.44,0:19:30.01,Default,,0,0,0,,counteract hand shake.
Dialogue: 0,0:19:30.71,0:19:32.39,Default,,0,0,0,,Gravity can come into play
Dialogue: 0,0:19:32.39,0:19:33.58,Default,,0,0,0,,because it can cause the lenses
Dialogue: 0,0:19:33.58,0:19:34.16,Default,,0,0,0,,to sag.
Dialogue: 0,0:19:34.90,0:19:36.75,Default,,0,0,0,,The focus actuators are actually
Dialogue: 0,0:19:36.75,0:19:38.67,Default,,0,0,0,,springs to which an electrical
Dialogue: 0,0:19:38.67,0:19:39.56,Default,,0,0,0,,current is applied.
Dialogue: 0,0:19:40.17,0:19:41.68,Default,,0,0,0,,So all of these reasons might
Dialogue: 0,0:19:41.68,0:19:43.06,Default,,0,0,0,,cause it to move around
Dialogue: 0,0:19:43.06,0:19:44.02,Default,,0,0,0,,laterally a little bit, and
Dialogue: 0,0:19:44.46,0:19:45.74,Default,,0,0,0,,these very small errors in
Dialogue: 0,0:19:45.74,0:19:46.86,Default,,0,0,0,,optical center position can
Dialogue: 0,0:19:46.86,0:19:49.15,Default,,0,0,0,,result in large errors in
Dialogue: 0,0:19:49.15,0:19:49.66,Default,,0,0,0,,disparity.
Dialogue: 0,0:19:50.51,0:19:52.18,Default,,0,0,0,,When this occurs, the result is
Dialogue: 0,0:19:52.18,0:19:54.89,Default,,0,0,0,,a constant amount of error in
Dialogue: 0,0:19:54.89,0:19:56.02,Default,,0,0,0,,every pixel in the map.
Dialogue: 0,0:19:57.34,0:19:58.82,Default,,0,0,0,,The disparity values are still
Dialogue: 0,0:19:59.07,0:20:01.34,Default,,0,0,0,,usable relative to one another,
Dialogue: 0,0:20:01.74,0:20:04.57,Default,,0,0,0,,but they no longer reflect
Dialogue: 0,0:20:04.57,0:20:05.88,Default,,0,0,0,,real-world distances.
Dialogue: 0,0:20:07.02,0:20:09.55,Default,,0,0,0,,For this reason AVDepthData
Dialogue: 0,0:20:09.55,0:20:11.05,Default,,0,0,0,,objects have to have a concept
Dialogue: 0,0:20:11.05,0:20:12.09,Default,,0,0,0,,of accuracy.
Dialogue: 0,0:20:12.90,0:20:15.09,Default,,0,0,0,,An accuracy value of absolute
Dialogue: 0,0:20:15.09,0:20:17.68,Default,,0,0,0,,would mean the units do reflect
Dialogue: 0,0:20:17.68,0:20:19.03,Default,,0,0,0,,real-world distances, there's no
Dialogue: 0,0:20:19.03,0:20:20.08,Default,,0,0,0,,calibration problem.
Dialogue: 0,0:20:20.72,0:20:22.88,Default,,0,0,0,,Relative accuracy means that the
Dialogue: 0,0:20:22.88,0:20:24.44,Default,,0,0,0,,Z ordering is still preserved,
Dialogue: 0,0:20:25.12,0:20:26.95,Default,,0,0,0,,but the real-world scale has
Dialogue: 0,0:20:26.95,0:20:27.55,Default,,0,0,0,,been lost.
Dialogue: 0,0:20:28.44,0:20:29.85,Default,,0,0,0,,Depth data captured from, say, a
Dialogue: 0,0:20:29.85,0:20:31.49,Default,,0,0,0,,third-party camera can be
Dialogue: 0,0:20:31.49,0:20:33.66,Default,,0,0,0,,reported as either absolute or
Dialogue: 0,0:20:33.66,0:20:36.28,Default,,0,0,0,,relative, but iPhone 7 Plus
Dialogue: 0,0:20:36.28,0:20:38.92,Default,,0,0,0,,always reports relative accuracy
Dialogue: 0,0:20:39.25,0:20:40.47,Default,,0,0,0,,due to the calibration errors
Dialogue: 0,0:20:40.47,0:20:41.31,Default,,0,0,0,,that I just mentioned.
Dialogue: 0,0:20:41.89,0:20:42.71,Default,,0,0,0,,But I don't want you to be
Dialogue: 0,0:20:42.71,0:20:43.48,Default,,0,0,0,,frightened by that.
Dialogue: 0,0:20:43.88,0:20:46.82,Default,,0,0,0,,Relative accuracy is not bad
Dialogue: 0,0:20:46.82,0:20:47.46,Default,,0,0,0,,accuracy.
Dialogue: 0,0:20:47.95,0:20:49.25,Default,,0,0,0,,Dual camera depth is still
Dialogue: 0,0:20:49.25,0:20:51.38,Default,,0,0,0,,totally usable, and let me show
Dialogue: 0,0:20:51.38,0:20:53.43,Default,,0,0,0,,you how.
Dialogue: 0,0:20:53.66,0:20:55.16,Default,,0,0,0,,Awesome, formulas on slides.
Dialogue: 0,0:20:55.97,0:20:56.99,Default,,0,0,0,,Okay. Here comes a bit of math
Dialogue: 0,0:20:56.99,0:20:57.20,Default,,0,0,0,,again.
Dialogue: 0,0:20:57.44,0:20:59.29,Default,,0,0,0,,Let's say we've got a relative
Dialogue: 0,0:20:59.29,0:21:00.99,Default,,0,0,0,,accuracy disparity value on the
Dialogue: 0,0:21:00.99,0:21:03.13,Default,,0,0,0,,left, which is the d with the
Dialogue: 0,0:21:03.13,0:21:05.27,Default,,0,0,0,,little dunce cap over it because
Dialogue: 0,0:21:05.27,0:21:07.70,Default,,0,0,0,,it's bad, and that's equivalent
Dialogue: 0,0:21:07.70,0:21:10.17,Default,,0,0,0,,to an absolute disparity d plus
Dialogue: 0,0:21:10.17,0:21:11.88,Default,,0,0,0,,a fixed amount of error.
Dialogue: 0,0:21:12.49,0:21:13.34,Default,,0,0,0,,We don't know what the fixed
Dialogue: 0,0:21:13.34,0:21:14.35,Default,,0,0,0,,amount of error is, but it's
Dialogue: 0,0:21:14.39,0:21:14.58,Default,,0,0,0,,there.
Dialogue: 0,0:21:15.99,0:21:16.93,Default,,0,0,0,,Now, let's take a common
Dialogue: 0,0:21:16.93,0:21:19.00,Default,,0,0,0,,operation such as finding the
Dialogue: 0,0:21:19.00,0:21:20.17,Default,,0,0,0,,difference between two
Dialogue: 0,0:21:20.17,0:21:22.18,Default,,0,0,0,,disparities in the same map,
Dialogue: 0,0:21:22.83,0:21:23.90,Default,,0,0,0,,it's like subtracting the
Dialogue: 0,0:21:23.90,0:21:24.42,Default,,0,0,0,,differences.
Dialogue: 0,0:21:24.88,0:21:27.42,Default,,0,0,0,,So let's say the equation looks
Dialogue: 0,0:21:27.42,0:21:28.00,Default,,0,0,0,,like this.
Dialogue: 0,0:21:28.95,0:21:31.06,Default,,0,0,0,,You have two bad datas where
Dialogue: 0,0:21:31.06,0:21:33.28,Default,,0,0,0,,you're subtracting two bad
Dialogue: 0,0:21:33.28,0:21:34.93,Default,,0,0,0,,disparities, and that's the same
Dialogue: 0,0:21:34.93,0:21:36.12,Default,,0,0,0,,as two good disparities with the
Dialogue: 0,0:21:36.12,0:21:37.01,Default,,0,0,0,,same fixed error.
Dialogue: 0,0:21:37.47,0:21:39.44,Default,,0,0,0,,If we reorder things, we find
Dialogue: 0,0:21:39.44,0:21:41.49,Default,,0,0,0,,that actually we can get rid of
Dialogue: 0,0:21:41.49,0:21:43.81,Default,,0,0,0,,the errors because they cancel
Dialogue: 0,0:21:43.81,0:21:45.74,Default,,0,0,0,,each other out and we're left
Dialogue: 0,0:21:45.74,0:21:47.76,Default,,0,0,0,,with a very happy coincidence
Dialogue: 0,0:21:47.76,0:21:48.00,Default,,0,0,0,,here.
Dialogue: 0,0:21:49.46,0:21:51.06,Default,,0,0,0,,This happy discovery is that the
Dialogue: 0,0:21:51.06,0:21:52.48,Default,,0,0,0,,differences are the same,
Dialogue: 0,0:21:53.11,0:21:54.08,Default,,0,0,0,,whether your disparity is
Dialogue: 0,0:21:54.08,0:21:55.80,Default,,0,0,0,,perfect or your disparity is
Dialogue: 0,0:21:55.80,0:21:56.26,Default,,0,0,0,,relative.
Dialogue: 0,0:21:56.88,0:21:58.36,Default,,0,0,0,,This formula kind of proves that
Dialogue: 0,0:21:58.36,0:21:59.76,Default,,0,0,0,,relative is just as good as
Dialogue: 0,0:21:59.76,0:22:01.31,Default,,0,0,0,,absolute if you're creating
Dialogue: 0,0:22:01.31,0:22:03.28,Default,,0,0,0,,effects that only rely on, say,
Dialogue: 0,0:22:03.28,0:22:04.77,Default,,0,0,0,,differences within the same map.
Dialogue: 0,0:22:05.05,0:22:06.18,Default,,0,0,0,,And that's why the effects
Dialogue: 0,0:22:06.18,0:22:08.42,Default,,0,0,0,,produced from relative accuracy
Dialogue: 0,0:22:08.42,0:22:09.96,Default,,0,0,0,,depth still look fantastic.
Dialogue: 0,0:22:10.28,0:22:13.28,Default,,0,0,0,,And with that I think we've
Dialogue: 0,0:22:13.28,0:22:15.01,Default,,0,0,0,,wrapped up our AVDepthData
Dialogue: 0,0:22:15.01,0:22:16.46,Default,,0,0,0,,intro, or maybe we've gotten to
Dialogue: 0,0:22:16.46,0:22:17.43,Default,,0,0,0,,the bottom of it [group
Dialogue: 0,0:22:17.43,0:22:19.26,Default,,0,0,0,,groaning].
Dialogue: 0,0:22:19.26,0:22:20.44,Default,,0,0,0,,It's time to move on to our
Dialogue: 0,0:22:20.44,0:22:21.94,Default,,0,0,0,,first capture case, which is
Dialogue: 0,0:22:21.99,0:22:24.45,Default,,0,0,0,,streaming depth, and I feel a
Dialogue: 0,0:22:24.45,0:22:24.98,Default,,0,0,0,,demo coming on.
Dialogue: 0,0:22:32.05,0:22:33.96,Default,,0,0,0,,Okay. Let's start with a demo
Dialogue: 0,0:22:33.96,0:22:35.67,Default,,0,0,0,,called AVCamPhotoFilter.
Dialogue: 0,0:22:36.32,0:22:37.65,Default,,0,0,0,,This is an app that we released
Dialogue: 0,0:22:37.65,0:22:39.76,Default,,0,0,0,,last year as sample code with
Dialogue: 0,0:22:39.76,0:22:41.22,Default,,0,0,0,,the show, and this was to show
Dialogue: 0,0:22:41.22,0:22:43.16,Default,,0,0,0,,you how to apply an effect in
Dialogue: 0,0:22:43.16,0:22:46.72,Default,,0,0,0,,real time to a preview and
Dialogue: 0,0:22:46.79,0:22:48.11,Default,,0,0,0,,render that same effect to the
Dialogue: 0,0:22:48.11,0:22:48.63,Default,,0,0,0,,photo.
Dialogue: 0,0:22:49.03,0:22:50.25,Default,,0,0,0,,So last year it just had one
Dialogue: 0,0:22:50.25,0:22:51.53,Default,,0,0,0,,button at the top and that was
Dialogue: 0,0:22:51.53,0:22:53.03,Default,,0,0,0,,to filter the video, and it did,
Dialogue: 0,0:22:53.10,0:22:54.09,Default,,0,0,0,,you know, kind of a cheesy
Dialogue: 0,0:22:54.09,0:22:56.79,Default,,0,0,0,,little rosy effect to the video,
Dialogue: 0,0:22:56.79,0:22:57.95,Default,,0,0,0,,but it shows it to you in real
Dialogue: 0,0:22:57.95,0:23:00.36,Default,,0,0,0,,time on the preview and it also
Dialogue: 0,0:23:00.36,0:23:01.72,Default,,0,0,0,,renders it to the photo when you
Dialogue: 0,0:23:01.72,0:23:02.46,Default,,0,0,0,,take a photo.
Dialogue: 0,0:23:02.91,0:23:05.55,Default,,0,0,0,,This year we've added some depth
Dialogue: 0,0:23:05.61,0:23:08.23,Default,,0,0,0,,to this sample by showing you
Dialogue: 0,0:23:08.23,0:23:11.16,Default,,0,0,0,,how to preview depth in a
Dialogue: 0,0:23:11.16,0:23:11.98,Default,,0,0,0,,streaming fashion.
Dialogue: 0,0:23:12.67,0:23:13.87,Default,,0,0,0,,So now what we're doing is
Dialogue: 0,0:23:13.87,0:23:16.11,Default,,0,0,0,,turning on depth and we're
Dialogue: 0,0:23:16.11,0:23:19.19,Default,,0,0,0,,previewing it by mixing between
Dialogue: 0,0:23:19.19,0:23:24.10,Default,,0,0,0,,full RGB and full depth.
Dialogue: 0,0:23:24.26,0:23:25.58,Default,,0,0,0,,I'm going to call up my lovely
Dialogue: 0,0:23:25.58,0:23:26.80,Default,,0,0,0,,assistant Vanna -- actually,
Dialogue: 0,0:23:26.80,0:23:27.25,Default,,0,0,0,,it's Eric.
Dialogue: 0,0:23:27.36,0:23:27.86,Default,,0,0,0,,Thanks, Eric.
Dialogue: 0,0:23:28.26,0:23:29.34,Default,,0,0,0,,He's going to come up and show
Dialogue: 0,0:23:30.55,0:23:32.05,Default,,0,0,0,,us something that's dynamic,
Dialogue: 0,0:23:32.05,0:23:32.98,Default,,0,0,0,,like a baseball glove.
Dialogue: 0,0:23:33.06,0:23:33.51,Default,,0,0,0,,I love it.
Dialogue: 0,0:23:34.03,0:23:35.55,Default,,0,0,0,,Now, notice that it's quite
Dialogue: 0,0:23:35.55,0:23:36.97,Default,,0,0,0,,noisy, there's a lot of jumping
Dialogue: 0,0:23:36.97,0:23:37.59,Default,,0,0,0,,around happening.
Dialogue: 0,0:23:37.59,0:23:38.56,Default,,0,0,0,,You can definitely see what it
Dialogue: 0,0:23:38.56,0:23:40.72,Default,,0,0,0,,is, but it's not perfect and
Dialogue: 0,0:23:40.72,0:23:41.75,Default,,0,0,0,,there's a lot of temporal
Dialogue: 0,0:23:41.75,0:23:43.26,Default,,0,0,0,,problems going on, but I can
Dialogue: 0,0:23:43.26,0:23:45.46,Default,,0,0,0,,click the Smooth button and
Dialogue: 0,0:23:45.46,0:23:47.25,Default,,0,0,0,,suddenly we have filtered the
Dialogue: 0,0:23:47.25,0:23:49.10,Default,,0,0,0,,depth to fill in the holes and
Dialogue: 0,0:23:49.10,0:23:50.42,Default,,0,0,0,,temporally smooth them, and now
Dialogue: 0,0:23:50.42,0:23:51.71,Default,,0,0,0,,it's a really nice-looking
Dialogue: 0,0:23:52.09,0:23:52.65,Default,,0,0,0,,disparity.
Dialogue: 0,0:23:52.65,0:23:54.08,Default,,0,0,0,,I'm going to go ahead and take a
Dialogue: 0,0:23:54.08,0:23:54.54,Default,,0,0,0,,photo.
Dialogue: 0,0:23:54.60,0:23:58.55,Default,,0,0,0,,And now if I go back to the
Dialogue: 0,0:23:58.55,0:24:00.89,Default,,0,0,0,,Photos app, we'll find that we
Dialogue: 0,0:24:00.89,0:24:03.15,Default,,0,0,0,,just captured a really lovely
Dialogue: 0,0:24:03.78,0:24:05.33,Default,,0,0,0,,looking depth representation,
Dialogue: 0,0:24:05.80,0:24:07.47,Default,,0,0,0,,and now this is an educational
Dialogue: 0,0:24:07.47,0:24:09.49,Default,,0,0,0,,app because finally we can
Dialogue: 0,0:24:09.54,0:24:11.50,Default,,0,0,0,,answer the question how deep is
Dialogue: 0,0:24:11.50,0:24:13.46,Default,,0,0,0,,your glove, how deep is your
Dialogue: 0,0:24:13.46,0:24:13.84,Default,,0,0,0,,glove [group groaning].
Dialogue: 0,0:24:14.40,0:24:15.49,Default,,0,0,0,,You really need to learn.
Dialogue: 0,0:24:16.37,0:24:17.19,Default,,0,0,0,,All right.
Dialogue: 0,0:24:17.19,0:24:20.47,Default,,0,0,0,,Let's go back to slides.
Dialogue: 0,0:24:20.95,0:24:21.65,Default,,0,0,0,,I know it's late.
Dialogue: 0,0:24:21.65,0:24:22.78,Default,,0,0,0,,I'm trying to keep you awake.
Dialogue: 0,0:24:24.66,0:24:25.00,Default,,0,0,0,,All right.
Dialogue: 0,0:24:25.00,0:24:25.82,Default,,0,0,0,,How did we do that.
Dialogue: 0,0:24:27.67,0:24:29.24,Default,,0,0,0,,AVFoundation frameworks camera
Dialogue: 0,0:24:29.24,0:24:30.88,Default,,0,0,0,,capture classes are divided into
Dialogue: 0,0:24:30.88,0:24:32.38,Default,,0,0,0,,three main groups.
Dialogue: 0,0:24:32.78,0:24:33.41,Default,,0,0,0,,The first is the
Dialogue: 0,0:24:33.41,0:24:34.94,Default,,0,0,0,,AVCaptureSession, which is just
Dialogue: 0,0:24:34.94,0:24:36.05,Default,,0,0,0,,a control object.
Dialogue: 0,0:24:36.54,0:24:37.82,Default,,0,0,0,,You tell it to start or stop
Dialogue: 0,0:24:37.82,0:24:38.86,Default,,0,0,0,,running, but it doesn't do
Dialogue: 0,0:24:38.86,0:24:40.22,Default,,0,0,0,,anything unless you give it some
Dialogue: 0,0:24:40.22,0:24:42.47,Default,,0,0,0,,input, and for that we have AV
Dialogue: 0,0:24:42.47,0:24:44.32,Default,,0,0,0,,capture inputs, such as an
Dialogue: 0,0:24:44.32,0:24:46.42,Default,,0,0,0,,AVCaptureDeviceInput, I've made
Dialogue: 0,0:24:46.42,0:24:48.22,Default,,0,0,0,,one here associated with the
Dialogue: 0,0:24:48.22,0:24:50.08,Default,,0,0,0,,dual camera, and that provides
Dialogue: 0,0:24:50.08,0:24:51.80,Default,,0,0,0,,input to the session, but now
Dialogue: 0,0:24:51.80,0:24:53.21,Default,,0,0,0,,you need to direct it somewhere
Dialogue: 0,0:24:53.21,0:24:53.89,Default,,0,0,0,,as an output.
Dialogue: 0,0:24:54.26,0:24:55.80,Default,,0,0,0,,And now we have a new kind of
Dialogue: 0,0:24:55.80,0:24:56.48,Default,,0,0,0,,output called an
Dialogue: 0,0:24:56.48,0:24:58.41,Default,,0,0,0,,AVCaptureDepthDataOutput.
Dialogue: 0,0:24:59.22,0:25:01.59,Default,,0,0,0,,This is affectionately referred
Dialogue: 0,0:25:01.59,0:25:04.26,Default,,0,0,0,,to on our team as the DDO, and
Dialogue: 0,0:25:04.26,0:25:05.69,Default,,0,0,0,,it functions similarly to our
Dialogue: 0,0:25:05.69,0:25:07.81,Default,,0,0,0,,VideoDataOutput, except that
Dialogue: 0,0:25:07.81,0:25:09.13,Default,,0,0,0,,instead of delivering CoreMedia
Dialogue: 0,0:25:09.13,0:25:11.06,Default,,0,0,0,,sample buffers, it delivers
Dialogue: 0,0:25:11.20,0:25:14.01,Default,,0,0,0,,AVDepthData objects, that
Dialogue: 0,0:25:14.01,0:25:15.32,Default,,0,0,0,,canonical representation that I
Dialogue: 0,0:25:15.32,0:25:16.00,Default,,0,0,0,,was talking about.
Dialogue: 0,0:25:16.46,0:25:17.57,Default,,0,0,0,,It delivers them in a streaming
Dialogue: 0,0:25:17.57,0:25:17.98,Default,,0,0,0,,fashion.
Dialogue: 0,0:25:23.05,0:25:24.37,Default,,0,0,0,,Now, where is
Dialogue: 0,0:25:24.37,0:25:25.48,Default,,0,0,0,,AVCaptureDepthDataOutput
Dialogue: 0,0:25:25.48,0:25:26.18,Default,,0,0,0,,supported?
Dialogue: 0,0:25:26.18,0:25:27.27,Default,,0,0,0,,You can, of course, add it to
Dialogue: 0,0:25:27.27,0:25:29.37,Default,,0,0,0,,any session anywhere, but you're
Dialogue: 0,0:25:29.37,0:25:31.07,Default,,0,0,0,,not going to get depth unless
Dialogue: 0,0:25:31.07,0:25:32.27,Default,,0,0,0,,you are on the dual camera
Dialogue: 0,0:25:32.27,0:25:33.82,Default,,0,0,0,,because that is the only dual
Dialogue: 0,0:25:34.26,0:25:35.98,Default,,0,0,0,,system or stereo system that we
Dialogue: 0,0:25:35.98,0:25:37.77,Default,,0,0,0,,have for calculating disparity.
Dialogue: 0,0:25:39.18,0:25:40.25,Default,,0,0,0,,When you attach a
Dialogue: 0,0:25:40.25,0:25:42.17,Default,,0,0,0,,DepthDataOutput to your session,
Dialogue: 0,0:25:42.45,0:25:43.31,Default,,0,0,0,,some things happen.
Dialogue: 0,0:25:43.72,0:25:45.15,Default,,0,0,0,,The dual camera automatically
Dialogue: 0,0:25:45.15,0:25:48.29,Default,,0,0,0,,zooms to 2X, that is the full
Dialogue: 0,0:25:48.29,0:25:50.14,Default,,0,0,0,,field of view of the tele, and
Dialogue: 0,0:25:50.14,0:25:51.28,Default,,0,0,0,,that's because in order to
Dialogue: 0,0:25:51.28,0:25:53.07,Default,,0,0,0,,calculate disparity, the focal
Dialogue: 0,0:25:53.07,0:25:55.11,Default,,0,0,0,,lengths need to be the same and
Dialogue: 0,0:25:55.17,0:25:57.09,Default,,0,0,0,,at 2X zoom the wide-angle
Dialogue: 0,0:25:57.09,0:25:58.78,Default,,0,0,0,,camera's focal length matches
Dialogue: 0,0:25:58.83,0:25:59.25,Default,,0,0,0,,the tele.
Dialogue: 0,0:26:00.54,0:26:02.37,Default,,0,0,0,,Also zoom is disabled while you
Dialogue: 0,0:26:02.37,0:26:03.78,Default,,0,0,0,,are calculating depth.
Dialogue: 0,0:26:04.66,0:26:06.65,Default,,0,0,0,,We've added some new accessors
Dialogue: 0,0:26:06.65,0:26:08.26,Default,,0,0,0,,to AVCaptureDevice.
Dialogue: 0,0:26:08.93,0:26:10.53,Default,,0,0,0,,On the dual camera you can
Dialogue: 0,0:26:10.53,0:26:12.54,Default,,0,0,0,,discover which video formats
Dialogue: 0,0:26:12.54,0:26:14.20,Default,,0,0,0,,support depth by querying the
Dialogue: 0,0:26:14.20,0:26:15.53,Default,,0,0,0,,supportedDepthDataFormats
Dialogue: 0,0:26:15.53,0:26:16.05,Default,,0,0,0,,property.
Dialogue: 0,0:26:16.20,0:26:18.30,Default,,0,0,0,,And there's also a new
Dialogue: 0,0:26:18.50,0:26:20.66,Default,,0,0,0,,activeDepthDataFormat property
Dialogue: 0,0:26:20.66,0:26:22.19,Default,,0,0,0,,that lets you see what the
Dialogue: 0,0:26:22.19,0:26:23.85,Default,,0,0,0,,activeDepthDataFormat is or
Dialogue: 0,0:26:23.85,0:26:26.77,Default,,0,0,0,,select a new DepthDataFormat.
Dialogue: 0,0:26:28.28,0:26:30.53,Default,,0,0,0,,We currently support three video
Dialogue: 0,0:26:30.53,0:26:33.40,Default,,0,0,0,,resolutions or presets for
Dialogue: 0,0:26:33.40,0:26:34.41,Default,,0,0,0,,depth, and let me go through
Dialogue: 0,0:26:34.41,0:26:35.18,Default,,0,0,0,,them one at a time.
Dialogue: 0,0:26:35.45,0:26:37.12,Default,,0,0,0,,The first is the ever-popular
Dialogue: 0,0:26:37.12,0:26:38.02,Default,,0,0,0,,Photo Preset.
Dialogue: 0,0:26:38.66,0:26:41.42,Default,,0,0,0,,In the Photo Preset you get a
Dialogue: 0,0:26:41.42,0:26:43.19,Default,,0,0,0,,screen-sized preview coming out
Dialogue: 0,0:26:43.19,0:26:44.72,Default,,0,0,0,,of VideoDataOutput, and you get
Dialogue: 0,0:26:44.72,0:26:46.68,Default,,0,0,0,,full res 12-megapixel images
Dialogue: 0,0:26:46.91,0:26:48.47,Default,,0,0,0,,coming out of the photoOutput.
Dialogue: 0,0:26:48.92,0:26:49.70,Default,,0,0,0,,So here you see that the
Dialogue: 0,0:26:49.70,0:26:50.97,Default,,0,0,0,,VideoDataOutput is delivering
Dialogue: 0,0:26:50.97,0:26:52.51,Default,,0,0,0,,1440x1080, which is
Dialogue: 0,0:26:52.51,0:26:53.34,Default,,0,0,0,,screen-sized.
Dialogue: 0,0:26:53.84,0:26:54.99,Default,,0,0,0,,Accompanying that, if you use a
Dialogue: 0,0:26:54.99,0:26:57.97,Default,,0,0,0,,DepthDataOutput, you get 320x240
Dialogue: 0,0:26:58.15,0:27:00.09,Default,,0,0,0,,at a maximum of 24 fps.
Dialogue: 0,0:27:00.50,0:27:01.24,Default,,0,0,0,,Why so small?
Dialogue: 0,0:27:01.76,0:27:03.10,Default,,0,0,0,,Well, it takes a lot of
Dialogue: 0,0:27:03.10,0:27:04.74,Default,,0,0,0,,horsepower to do that disparity
Dialogue: 0,0:27:04.74,0:27:06.21,Default,,0,0,0,,map 24 times a second.
Dialogue: 0,0:27:06.92,0:27:08.45,Default,,0,0,0,,You can also get it at a lower
Dialogue: 0,0:27:08.56,0:27:09.96,Default,,0,0,0,,resolution if you would like,
Dialogue: 0,0:27:09.96,0:27:11.36,Default,,0,0,0,,160x120.
Dialogue: 0,0:27:11.67,0:27:13.98,Default,,0,0,0,,Next we have a 16x9 format.
Dialogue: 0,0:27:13.98,0:27:15.48,Default,,0,0,0,,This is a new format this year.
Dialogue: 0,0:27:16.07,0:27:18.50,Default,,0,0,0,,Last year we had a 720p 16x9
Dialogue: 0,0:27:18.50,0:27:19.77,Default,,0,0,0,,format that went up to 60 fps.
Dialogue: 0,0:27:19.77,0:27:21.57,Default,,0,0,0,,This is a new one that goes up
Dialogue: 0,0:27:21.57,0:27:23.11,Default,,0,0,0,,to 30 fps, but it supports
Dialogue: 0,0:27:23.11,0:27:23.53,Default,,0,0,0,,depth.
Dialogue: 0,0:27:23.80,0:27:25.82,Default,,0,0,0,,And again, it is aspect correct
Dialogue: 0,0:27:25.82,0:27:26.93,Default,,0,0,0,,in the DepthDataOutput at
Dialogue: 0,0:27:26.93,0:27:29.36,Default,,0,0,0,,320x180 or 160x90.
Dialogue: 0,0:27:29.94,0:27:31.08,Default,,0,0,0,,And finally, we have a very
Dialogue: 0,0:27:31.08,0:27:34.33,Default,,0,0,0,,small VGA-sized preset or active
Dialogue: 0,0:27:34.33,0:27:35.57,Default,,0,0,0,,format that you can use if you
Dialogue: 0,0:27:35.57,0:27:36.62,Default,,0,0,0,,just want something very small
Dialogue: 0,0:27:36.62,0:27:36.98,Default,,0,0,0,,very fast.
Dialogue: 0,0:27:41.43,0:27:42.57,Default,,0,0,0,,Let's talk about frame rates.
Dialogue: 0,0:27:42.76,0:27:44.27,Default,,0,0,0,,AVCaptureDevice allows you to
Dialogue: 0,0:27:44.27,0:27:46.29,Default,,0,0,0,,set the min and max video frame
Dialogue: 0,0:27:46.29,0:27:47.68,Default,,0,0,0,,rates, but it does not allow you
Dialogue: 0,0:27:47.68,0:27:50.13,Default,,0,0,0,,to set the depth frame rates
Dialogue: 0,0:27:50.23,0:27:51.63,Default,,0,0,0,,independent of the video frame
Dialogue: 0,0:27:51.63,0:27:51.82,Default,,0,0,0,,rate.
Dialogue: 0,0:27:52.21,0:27:54.15,Default,,0,0,0,,That is because depth needs to
Dialogue: 0,0:27:54.15,0:27:56.27,Default,,0,0,0,,be delivered coincident with the
Dialogue: 0,0:27:56.27,0:28:00.05,Default,,0,0,0,,video or at an even fraction of
Dialogue: 0,0:28:00.52,0:28:01.59,Default,,0,0,0,,the video frame rate.
Dialogue: 0,0:28:02.32,0:28:04.79,Default,,0,0,0,,So, for example, if you select a
Dialogue: 0,0:28:04.79,0:28:08.11,Default,,0,0,0,,max video frame rate of 24, the
Dialogue: 0,0:28:08.11,0:28:09.54,Default,,0,0,0,,depth can keep up with that, so
Dialogue: 0,0:28:09.54,0:28:11.23,Default,,0,0,0,,you get 24 fps of depth.
Dialogue: 0,0:28:11.74,0:28:13.90,Default,,0,0,0,,If, however, you select 30 fps
Dialogue: 0,0:28:13.90,0:28:16.47,Default,,0,0,0,,video, the depth cannot keep up
Dialogue: 0,0:28:16.57,0:28:18.38,Default,,0,0,0,,so it will select not 24, but
Dialogue: 0,0:28:18.38,0:28:20.21,Default,,0,0,0,,15, so that you got nice even
Dialogue: 0,0:28:20.33,0:28:20.94,Default,,0,0,0,,multiples.
Dialogue: 0,0:28:22.18,0:28:24.78,Default,,0,0,0,,DepthDataOutput supports
Dialogue: 0,0:28:25.02,0:28:26.42,Default,,0,0,0,,filtering depth data, as I just
Dialogue: 0,0:28:26.42,0:28:26.89,Default,,0,0,0,,showed you in the
Dialogue: 0,0:28:26.89,0:28:28.22,Default,,0,0,0,,AVCamPhotoFilter demo.
Dialogue: 0,0:28:28.75,0:28:30.81,Default,,0,0,0,,That fills the holes and it also
Dialogue: 0,0:28:30.81,0:28:32.89,Default,,0,0,0,,smooths things out as you move
Dialogue: 0,0:28:32.89,0:28:34.18,Default,,0,0,0,,around so that you don't see
Dialogue: 0,0:28:34.29,0:28:35.46,Default,,0,0,0,,temporal jumps from
Dialogue: 0,0:28:35.46,0:28:37.62,Default,,0,0,0,,frame-to-frame.
Dialogue: 0,0:28:38.20,0:28:38.64,Default,,0,0,0,,All right.
Dialogue: 0,0:28:38.91,0:28:39.86,Default,,0,0,0,,Let's look at our current
Dialogue: 0,0:28:40.06,0:28:42.18,Default,,0,0,0,,landscape as far as data
Dialogue: 0,0:28:42.18,0:28:42.84,Default,,0,0,0,,outputs.
Dialogue: 0,0:28:43.32,0:28:44.67,Default,,0,0,0,,We have four of them now.
Dialogue: 0,0:28:45.33,0:28:45.94,Default,,0,0,0,,The first is the
Dialogue: 0,0:28:45.94,0:28:47.15,Default,,0,0,0,,VideoDataOutput, which has been
Dialogue: 0,0:28:47.15,0:28:49.69,Default,,0,0,0,,around since iOS 4, and it is
Dialogue: 0,0:28:49.69,0:28:51.11,Default,,0,0,0,,the thing that gives you video
Dialogue: 0,0:28:51.11,0:28:52.67,Default,,0,0,0,,frames one at a time in a
Dialogue: 0,0:28:52.67,0:28:54.79,Default,,0,0,0,,streaming fashion at 30 fps or
Dialogue: 0,0:28:54.79,0:28:56.32,Default,,0,0,0,,60 fps, whatever you set it to.
Dialogue: 0,0:28:57.07,0:28:58.89,Default,,0,0,0,,We also have an AudioDataOutput
Dialogue: 0,0:28:59.23,0:29:00.73,Default,,0,0,0,,which typically gives you pushes
Dialogue: 0,0:29:00.73,0:29:03.58,Default,,0,0,0,,of PCM frames in 1024 at a time
Dialogue: 0,0:29:03.96,0:29:05.42,Default,,0,0,0,,at 44.1.
Dialogue: 0,0:29:05.85,0:29:08.19,Default,,0,0,0,,We also have a MetadataOutput
Dialogue: 0,0:29:08.19,0:29:10.13,Default,,0,0,0,,that can deliver either faces,
Dialogue: 0,0:29:10.13,0:29:12.54,Default,,0,0,0,,detected faces or barcodes, and
Dialogue: 0,0:29:12.54,0:29:13.74,Default,,0,0,0,,these come in sporadically.
Dialogue: 0,0:29:14.14,0:29:15.45,Default,,0,0,0,,They may have some latency, up
Dialogue: 0,0:29:15.45,0:29:16.78,Default,,0,0,0,,to four frames of latency for
Dialogue: 0,0:29:16.78,0:29:17.57,Default,,0,0,0,,finding faces.
Dialogue: 0,0:29:18.54,0:29:19.45,Default,,0,0,0,,And now we're adding
Dialogue: 0,0:29:19.45,0:29:21.28,Default,,0,0,0,,DepthDataOutput, which, as I
Dialogue: 0,0:29:21.28,0:29:22.52,Default,,0,0,0,,just mentioned, is either
Dialogue: 0,0:29:22.52,0:29:23.70,Default,,0,0,0,,delivered at the frame rate of
Dialogue: 0,0:29:23.70,0:29:26.63,Default,,0,0,0,,the video or at a rate evenly
Dialogue: 0,0:29:26.71,0:29:28.18,Default,,0,0,0,,divisible by the video.
Dialogue: 0,0:29:28.58,0:29:30.25,Default,,0,0,0,,So now this is kind of getting
Dialogue: 0,0:29:30.25,0:29:30.88,Default,,0,0,0,,ridiculous.
Dialogue: 0,0:29:31.37,0:29:32.27,Default,,0,0,0,,In order to work with all of
Dialogue: 0,0:29:32.27,0:29:33.81,Default,,0,0,0,,these data outputs you have to
Dialogue: 0,0:29:33.81,0:29:35.00,Default,,0,0,0,,have a very sophisticated
Dialogue: 0,0:29:35.00,0:29:37.22,Default,,0,0,0,,buffering mechanism to keep
Dialogue: 0,0:29:37.22,0:29:38.28,Default,,0,0,0,,track of when everything's
Dialogue: 0,0:29:38.28,0:29:39.71,Default,,0,0,0,,coming in if you care about
Dialogue: 0,0:29:39.80,0:29:41.11,Default,,0,0,0,,dealing with all of them at the
Dialogue: 0,0:29:41.11,0:29:42.86,Default,,0,0,0,,same time, or dealing with a
Dialogue: 0,0:29:42.86,0:29:44.09,Default,,0,0,0,,certain presentation time
Dialogue: 0,0:29:44.09,0:29:44.70,Default,,0,0,0,,altogether.
Dialogue: 0,0:29:45.56,0:29:47.83,Default,,0,0,0,,We have recognized this as a
Dialogue: 0,0:29:47.83,0:29:51.21,Default,,0,0,0,,problem for a while now, but the
Dialogue: 0,0:29:51.21,0:29:52.97,Default,,0,0,0,,DepthDataOutput has proven to be
Dialogue: 0,0:29:53.05,0:29:54.76,Default,,0,0,0,,the bridge too far.
Dialogue: 0,0:29:54.76,0:29:58.03,Default,,0,0,0,,That wasn't very loud.
Dialogue: 0,0:29:58.25,0:29:59.63,Default,,0,0,0,,Next one, better effort, please.
Dialogue: 0,0:30:00.12,0:30:01.92,Default,,0,0,0,,In iOS 11 we've added a new
Dialogue: 0,0:30:01.92,0:30:05.14,Default,,0,0,0,,synchronizing object called an
Dialogue: 0,0:30:05.14,0:30:06.19,Default,,0,0,0,,AVCaptureDataOutput
Dialogue: 0,0:30:06.19,0:30:06.81,Default,,0,0,0,,Synchronizer.
Dialogue: 0,0:30:07.36,0:30:08.89,Default,,0,0,0,,It delivers all of the available
Dialogue: 0,0:30:08.89,0:30:10.32,Default,,0,0,0,,data for a given presentation
Dialogue: 0,0:30:10.32,0:30:12.43,Default,,0,0,0,,time in a single unified
Dialogue: 0,0:30:12.65,0:30:14.93,Default,,0,0,0,,callback, and it delivers a
Dialogue: 0,0:30:14.98,0:30:16.66,Default,,0,0,0,,collection object called an
Dialogue: 0,0:30:16.66,0:30:18.41,Default,,0,0,0,,AVCaptureSynchronizedData
Dialogue: 0,0:30:18.41,0:30:18.81,Default,,0,0,0,,Collection.
Dialogue: 0,0:30:19.40,0:30:21.14,Default,,0,0,0,,So this allows you to designate
Dialogue: 0,0:30:21.14,0:30:22.91,Default,,0,0,0,,a master output, the one that's
Dialogue: 0,0:30:22.91,0:30:24.11,Default,,0,0,0,,most important to you, the one
Dialogue: 0,0:30:24.11,0:30:25.14,Default,,0,0,0,,that you want everything else to
Dialogue: 0,0:30:25.14,0:30:27.19,Default,,0,0,0,,be synchronized to, and then it
Dialogue: 0,0:30:27.32,0:30:28.86,Default,,0,0,0,,will do the job of holding on to
Dialogue: 0,0:30:28.86,0:30:30.30,Default,,0,0,0,,the media as long as it needs
Dialogue: 0,0:30:30.30,0:30:31.99,Default,,0,0,0,,to, to ensure that all of the
Dialogue: 0,0:30:31.99,0:30:33.36,Default,,0,0,0,,data for a given presentation
Dialogue: 0,0:30:33.36,0:30:34.91,Default,,0,0,0,,time is available before it
Dialogue: 0,0:30:34.91,0:30:36.14,Default,,0,0,0,,gives you that single unified
Dialogue: 0,0:30:36.14,0:30:36.68,Default,,0,0,0,,callback.
Dialogue: 0,0:30:36.97,0:30:38.99,Default,,0,0,0,,It will either give you all of
Dialogue: 0,0:30:38.99,0:30:40.57,Default,,0,0,0,,the data for all of the outputs,
Dialogue: 0,0:30:40.57,0:30:41.86,Default,,0,0,0,,or if it's assured that there is
Dialogue: 0,0:30:41.86,0:30:43.68,Default,,0,0,0,,no data for a particular output,
Dialogue: 0,0:30:43.68,0:30:44.69,Default,,0,0,0,,it will go ahead and give you
Dialogue: 0,0:30:44.69,0:30:46.23,Default,,0,0,0,,the collection with what it had.
Dialogue: 0,0:30:47.32,0:30:48.79,Default,,0,0,0,,So here's a little code snippet
Dialogue: 0,0:30:48.79,0:30:49.74,Default,,0,0,0,,showing how to work with the
Dialogue: 0,0:30:49.74,0:30:51.04,Default,,0,0,0,,data output synchronizer's
Dialogue: 0,0:30:51.04,0:30:53.10,Default,,0,0,0,,unified delegate callback, which
Dialogue: 0,0:30:53.10,0:30:54.32,Default,,0,0,0,,passes you, again, a
Dialogue: 0,0:30:54.32,0:30:55.99,Default,,0,0,0,,SynchronizedDataCollection.
Dialogue: 0,0:30:56.53,0:30:57.07,Default,,0,0,0,,It's cool.
Dialogue: 0,0:30:57.23,0:30:59.18,Default,,0,0,0,,You can use it like an array or
Dialogue: 0,0:30:59.18,0:31:00.48,Default,,0,0,0,,like a dictionary, depending on
Dialogue: 0,0:31:00.48,0:31:01.23,Default,,0,0,0,,what you want to do with it.
Dialogue: 0,0:31:01.23,0:31:03.88,Default,,0,0,0,,You can iterate through it like
Dialogue: 0,0:31:03.88,0:31:06.07,Default,,0,0,0,,you would an array, using fast
Dialogue: 0,0:31:06.07,0:31:07.32,Default,,0,0,0,,enumeration if you just want to
Dialogue: 0,0:31:07.32,0:31:08.52,Default,,0,0,0,,get a list of everything that's
Dialogue: 0,0:31:08.52,0:31:09.53,Default,,0,0,0,,in the current collection.
Dialogue: 0,0:31:10.53,0:31:13.17,Default,,0,0,0,,Or if you want to deal with it
Dialogue: 0,0:31:13.17,0:31:14.94,Default,,0,0,0,,in a dictionary like fashion,
Dialogue: 0,0:31:15.29,0:31:18.45,Default,,0,0,0,,you can index by subscripting a
Dialogue: 0,0:31:18.45,0:31:19.25,Default,,0,0,0,,data output that you're
Dialogue: 0,0:31:19.25,0:31:19.90,Default,,0,0,0,,concerned with.
Dialogue: 0,0:31:19.90,0:31:21.49,Default,,0,0,0,,For instance, here I'm just
Dialogue: 0,0:31:21.49,0:31:22.55,Default,,0,0,0,,looking for the particular
Dialogue: 0,0:31:22.55,0:31:23.59,Default,,0,0,0,,result that came from the
Dialogue: 0,0:31:23.59,0:31:25.31,Default,,0,0,0,,DepthDataOutput and if it's
Dialogue: 0,0:31:25.31,0:31:26.85,Default,,0,0,0,,present, it will give it to me.
Dialogue: 0,0:31:27.17,0:31:28.77,Default,,0,0,0,,You have to guard your code to
Dialogue: 0,0:31:28.77,0:31:30.10,Default,,0,0,0,,look for nil because, again,
Dialogue: 0,0:31:30.10,0:31:31.43,Default,,0,0,0,,there might not be any depth for
Dialogue: 0,0:31:31.43,0:31:32.71,Default,,0,0,0,,that given presentation time.
Dialogue: 0,0:31:32.79,0:31:33.04,Default,,0,0,0,,All right.
Dialogue: 0,0:31:34.14,0:31:36.63,Default,,0,0,0,,For an example of how to use
Dialogue: 0,0:31:36.63,0:31:37.64,Default,,0,0,0,,AVCaptureDataOutput
Dialogue: 0,0:31:37.64,0:31:38.91,Default,,0,0,0,,Synchronizer, again, use
Dialogue: 0,0:31:38.91,0:31:40.73,Default,,0,0,0,,AVCamPhotoFilter.
Dialogue: 0,0:31:41.02,0:31:42.19,Default,,0,0,0,,That sample code is already
Dialogue: 0,0:31:42.19,0:31:42.72,Default,,0,0,0,,available.
Dialogue: 0,0:31:42.80,0:31:43.72,Default,,0,0,0,,It's associated with this
Dialogue: 0,0:31:43.72,0:31:44.21,Default,,0,0,0,,session.
Dialogue: 0,0:31:44.21,0:31:45.23,Default,,0,0,0,,You can download it right now.
Dialogue: 0,0:31:47.23,0:31:48.18,Default,,0,0,0,,There's another new streaming
Dialogue: 0,0:31:48.18,0:31:50.08,Default,,0,0,0,,feature in iOS 11, a slight
Dialogue: 0,0:31:50.08,0:31:51.92,Default,,0,0,0,,tangent here, and that is
Dialogue: 0,0:31:51.92,0:31:53.97,Default,,0,0,0,,support for delivering camera
Dialogue: 0,0:31:53.97,0:31:56.37,Default,,0,0,0,,intrinsics with each video frame
Dialogue: 0,0:31:56.67,0:31:57.30,Default,,0,0,0,,when you're using
Dialogue: 0,0:31:57.30,0:31:58.16,Default,,0,0,0,,VideoDataOutput.
Dialogue: 0,0:31:58.34,0:32:00.19,Default,,0,0,0,,If you recall our pinhole
Dialogue: 0,0:32:00.19,0:32:02.51,Default,,0,0,0,,camera, in order to transform
Dialogue: 0,0:32:02.51,0:32:04.19,Default,,0,0,0,,points from a 3D space to a 2D
Dialogue: 0,0:32:04.19,0:32:05.60,Default,,0,0,0,,space, we needed two bits of
Dialogue: 0,0:32:05.60,0:32:06.23,Default,,0,0,0,,information.
Dialogue: 0,0:32:06.57,0:32:08.79,Default,,0,0,0,,We needed the optical center, or
Dialogue: 0,0:32:08.79,0:32:10.92,Default,,0,0,0,,principal point, and we needed
Dialogue: 0,0:32:10.92,0:32:12.16,Default,,0,0,0,,the focal length.
Dialogue: 0,0:32:12.16,0:32:13.62,Default,,0,0,0,,In computer vision you can use
Dialogue: 0,0:32:13.62,0:32:16.29,Default,,0,0,0,,these properties to re-project a
Dialogue: 0,0:32:16.29,0:32:18.71,Default,,0,0,0,,2D image back to the 3D space by
Dialogue: 0,0:32:18.71,0:32:19.72,Default,,0,0,0,,using the inverse
Dialogue: 0,0:32:19.89,0:32:22.72,Default,,0,0,0,,transformation, and this figures
Dialogue: 0,0:32:22.72,0:32:24.36,Default,,0,0,0,,prominently in the new AR kit.
Dialogue: 0,0:32:25.30,0:32:27.37,Default,,0,0,0,,New in iOS 11 you can opt in to
Dialogue: 0,0:32:27.37,0:32:30.50,Default,,0,0,0,,receive such a set of intrinsics
Dialogue: 0,0:32:30.89,0:32:33.01,Default,,0,0,0,,with each and every video frame
Dialogue: 0,0:32:33.01,0:32:34.26,Default,,0,0,0,,that you're delivered, and you
Dialogue: 0,0:32:34.26,0:32:35.56,Default,,0,0,0,,opt in by calling the
Dialogue: 0,0:32:35.56,0:32:36.75,Default,,0,0,0,,AVCaptureConnection
Dialogue: 0,0:32:37.24,0:32:38.81,Default,,0,0,0,,isCameraIntrinsic
Dialogue: 0,0:32:38.81,0:32:40.38,Default,,0,0,0,,MatrixDeliveryEnabled.
Dialogue: 0,0:32:41.16,0:32:42.85,Default,,0,0,0,,When you do that you can expect
Dialogue: 0,0:32:42.85,0:32:45.42,Default,,0,0,0,,to get one attachment per buffer
Dialogue: 0,0:32:45.55,0:32:46.53,Default,,0,0,0,,with the intrinsics.
Dialogue: 0,0:32:47.07,0:32:48.69,Default,,0,0,0,,Let me show you what the matrix
Dialogue: 0,0:32:48.69,0:32:49.61,Default,,0,0,0,,itself looks like.
Dialogue: 0,0:32:49.78,0:32:51.34,Default,,0,0,0,,It may look imposing, but it's
Dialogue: 0,0:32:51.34,0:32:52.13,Default,,0,0,0,,really quite simple.
Dialogue: 0,0:32:53.00,0:32:55.13,Default,,0,0,0,,Camera intrinsics are a 3x3
Dialogue: 0,0:32:55.13,0:32:56.98,Default,,0,0,0,,matrix that describe the
Dialogue: 0,0:32:57.41,0:32:58.58,Default,,0,0,0,,geometric properties of the
Dialogue: 0,0:32:58.58,0:32:59.01,Default,,0,0,0,,camera.
Dialogue: 0,0:32:59.83,0:33:02.69,Default,,0,0,0,,fx and fy are the pixel focal
Dialogue: 0,0:33:02.69,0:33:03.00,Default,,0,0,0,,length.
Dialogue: 0,0:33:03.63,0:33:05.11,Default,,0,0,0,,They're separate x and y values
Dialogue: 0,0:33:05.11,0:33:06.92,Default,,0,0,0,,because sometimes cameras have
Dialogue: 0,0:33:07.23,0:33:09.22,Default,,0,0,0,,anamorphic lens or anamorphic
Dialogue: 0,0:33:09.27,0:33:09.77,Default,,0,0,0,,pixels.
Dialogue: 0,0:33:10.42,0:33:12.33,Default,,0,0,0,,On iOS devices, our cameras
Dialogue: 0,0:33:12.33,0:33:14.76,Default,,0,0,0,,always have square pixels, so fx
Dialogue: 0,0:33:14.76,0:33:15.96,Default,,0,0,0,,and fy are always going to be
Dialogue: 0,0:33:15.96,0:33:16.71,Default,,0,0,0,,the same value.
Dialogue: 0,0:33:17.78,0:33:20.96,Default,,0,0,0,,Then x naught and y naught are
Dialogue: 0,0:33:20.96,0:33:22.27,Default,,0,0,0,,the pixel coordinates of the
Dialogue: 0,0:33:22.27,0:33:23.87,Default,,0,0,0,,lens' principal point, or
Dialogue: 0,0:33:23.87,0:33:24.57,Default,,0,0,0,,optical center.
Dialogue: 0,0:33:25.18,0:33:27.15,Default,,0,0,0,,These are all in pixel values
Dialogue: 0,0:33:27.15,0:33:27.82,Default,,0,0,0,,and they're given at the
Dialogue: 0,0:33:27.82,0:33:29.36,Default,,0,0,0,,resolution of the video buffer
Dialogue: 0,0:33:29.46,0:33:30.74,Default,,0,0,0,,with which they're provided.
Dialogue: 0,0:33:30.99,0:33:32.65,Default,,0,0,0,,So, once you've opted in, you
Dialogue: 0,0:33:32.65,0:33:34.69,Default,,0,0,0,,can expect to get sample buffers
Dialogue: 0,0:33:34.69,0:33:35.81,Default,,0,0,0,,in a streaming fashion and you
Dialogue: 0,0:33:35.81,0:33:37.48,Default,,0,0,0,,can get this attachment from
Dialogue: 0,0:33:37.48,0:33:39.71,Default,,0,0,0,,them, and the payload is a C/F
Dialogue: 0,0:33:39.71,0:33:42.11,Default,,0,0,0,,data that wraps a matrix float
Dialogue: 0,0:33:42.11,0:33:44.66,Default,,0,0,0,,3x3, which is a SIMD data type.
Dialogue: 0,0:33:45.33,0:33:46.84,Default,,0,0,0,,If you're doing computer vision,
Dialogue: 0,0:33:47.24,0:33:48.32,Default,,0,0,0,,you'll be really interested in
Dialogue: 0,0:33:48.32,0:33:49.00,Default,,0,0,0,,this new feature.
Dialogue: 0,0:33:50.25,0:33:52.02,Default,,0,0,0,,Okay. I think we've officially
Dialogue: 0,0:33:52.02,0:33:52.98,Default,,0,0,0,,deep sixed the streaming topics.
Dialogue: 0,0:33:53.52,0:33:55.55,Default,,0,0,0,,[ Group groaning ]
Dialogue: 0,0:33:56.05,0:33:57.09,Default,,0,0,0,,Better effort.
Dialogue: 0,0:33:57.09,0:33:58.66,Default,,0,0,0,,Let's move on to the photo
Dialogue: 0,0:33:58.66,0:33:59.86,Default,,0,0,0,,capture, and let's start with a
Dialogue: 0,0:33:59.86,0:33:59.98,Default,,0,0,0,,demo.
Dialogue: 0,0:34:07.73,0:34:08.85,Default,,0,0,0,,This is a two-for-one.
Dialogue: 0,0:34:08.92,0:34:10.44,Default,,0,0,0,,We're going to do two apps here.
Dialogue: 0,0:34:11.18,0:34:13.06,Default,,0,0,0,,AVCam is the venerable piece of
Dialogue: 0,0:34:13.06,0:34:14.64,Default,,0,0,0,,sample code that shows how to
Dialogue: 0,0:34:14.64,0:34:17.73,Default,,0,0,0,,take photos and movies using
Dialogue: 0,0:34:17.73,0:34:18.44,Default,,0,0,0,,AVFoundation.
Dialogue: 0,0:34:19.74,0:34:21.31,Default,,0,0,0,,And notice here, though we've
Dialogue: 0,0:34:21.31,0:34:22.97,Default,,0,0,0,,added depth support to it, you
Dialogue: 0,0:34:22.97,0:34:24.23,Default,,0,0,0,,don't see anything happening
Dialogue: 0,0:34:24.23,0:34:24.76,Default,,0,0,0,,with depth.
Dialogue: 0,0:34:25.21,0:34:27.42,Default,,0,0,0,,That's because while I'm able to
Dialogue: 0,0:34:27.42,0:34:30.25,Default,,0,0,0,,take a picture of these pencils
Dialogue: 0,0:34:30.25,0:34:32.29,Default,,0,0,0,,here, you don't actually see a
Dialogue: 0,0:34:32.29,0:34:34.71,Default,,0,0,0,,representation of the depth, but
Dialogue: 0,0:34:34.71,0:34:35.91,Default,,0,0,0,,it was stored in the photo.
Dialogue: 0,0:34:35.96,0:34:37.74,Default,,0,0,0,,So when I go into the Photos app
Dialogue: 0,0:34:38.76,0:34:40.23,Default,,0,0,0,,and I look at it, and let's say
Dialogue: 0,0:34:40.23,0:34:42.94,Default,,0,0,0,,I go into the Editing menu, look
Dialogue: 0,0:34:42.94,0:34:44.63,Default,,0,0,0,,what popped up, Depth at the
Dialogue: 0,0:34:44.63,0:34:44.90,Default,,0,0,0,,top.
Dialogue: 0,0:34:44.90,0:34:47.06,Default,,0,0,0,,So I can now touch the Depth and
Dialogue: 0,0:34:47.06,0:34:48.61,Default,,0,0,0,,suddenly it will apply that blur
Dialogue: 0,0:34:48.61,0:34:50.27,Default,,0,0,0,,effect to the background, which
Dialogue: 0,0:34:50.27,0:34:50.86,Default,,0,0,0,,is pretty cool.
Dialogue: 0,0:34:51.22,0:34:53.88,Default,,0,0,0,,So now photos that you take in
Dialogue: 0,0:34:53.88,0:34:57.29,Default,,0,0,0,,your app are eligible to have
Dialogue: 0,0:34:57.41,0:34:58.57,Default,,0,0,0,,the shallow depth of field
Dialogue: 0,0:34:58.57,0:34:59.94,Default,,0,0,0,,effect applied to them as well.
Dialogue: 0,0:34:59.94,0:35:01.08,Default,,0,0,0,,That's pretty cool.
Dialogue: 0,0:35:02.01,0:35:03.29,Default,,0,0,0,,We can also do other more
Dialogue: 0,0:35:03.29,0:35:05.46,Default,,0,0,0,,interesting things with depth,
Dialogue: 0,0:35:05.54,0:35:06.72,Default,,0,0,0,,knowing now that we've got them
Dialogue: 0,0:35:06.72,0:35:07.71,Default,,0,0,0,,in all of these photos.
Dialogue: 0,0:35:08.06,0:35:10.52,Default,,0,0,0,,And by the way, in iOS 11 all of
Dialogue: 0,0:35:10.52,0:35:11.55,Default,,0,0,0,,the photos that you take in the
Dialogue: 0,0:35:11.55,0:35:13.12,Default,,0,0,0,,Portrait mode are now storing
Dialogue: 0,0:35:13.12,0:35:15.47,Default,,0,0,0,,depth information in the photos,
Dialogue: 0,0:35:15.52,0:35:18.04,Default,,0,0,0,,so they are fodder for your new
Dialogue: 0,0:35:18.04,0:35:18.76,Default,,0,0,0,,creative apps.
Dialogue: 0,0:35:19.30,0:35:20.91,Default,,0,0,0,,I'm going to use this app called
Dialogue: 0,0:35:20.91,0:35:23.34,Default,,0,0,0,,Wiggle Me to show some creative
Dialogue: 0,0:35:23.34,0:35:24.59,Default,,0,0,0,,things that you can do with the
Dialogue: 0,0:35:24.59,0:35:24.98,Default,,0,0,0,,depth.
Dialogue: 0,0:35:26.96,0:35:29.43,Default,,0,0,0,,I'll select an easy one for
Dialogue: 0,0:35:29.94,0:35:30.63,Default,,0,0,0,,beginning.
Dialogue: 0,0:35:31.18,0:35:32.10,Default,,0,0,0,,What it's doing is taking
Dialogue: 0,0:35:32.10,0:35:34.34,Default,,0,0,0,,something that was flat and it's
Dialogue: 0,0:35:34.43,0:35:36.56,Default,,0,0,0,,re-projecting it out into a 3D
Dialogue: 0,0:35:36.73,0:35:39.46,Default,,0,0,0,,space and it's kind of rolling
Dialogue: 0,0:35:39.46,0:35:41.77,Default,,0,0,0,,it around, or I can just stop it
Dialogue: 0,0:35:41.77,0:35:43.12,Default,,0,0,0,,from rolling and I'm just going
Dialogue: 0,0:35:43.12,0:35:45.33,Default,,0,0,0,,to use the gyro to move my phone
Dialogue: 0,0:35:45.33,0:35:45.74,Default,,0,0,0,,around.
Dialogue: 0,0:35:45.81,0:35:47.77,Default,,0,0,0,,Isn't that a neat effect?
Dialogue: 0,0:35:48.10,0:35:49.44,Default,,0,0,0,,It sort of comes to life.
Dialogue: 0,0:35:49.44,0:35:50.87,Default,,0,0,0,,I'm going to pick a different
Dialogue: 0,0:35:50.87,0:35:51.12,Default,,0,0,0,,one.
Dialogue: 0,0:35:51.84,0:35:53.97,Default,,0,0,0,,I really like the dog.
Dialogue: 0,0:35:55.08,0:35:55.94,Default,,0,0,0,,The dog looks great.
Dialogue: 0,0:35:56.18,0:35:59.58,Default,,0,0,0,,So now he kind of moves around
Dialogue: 0,0:35:59.58,0:36:00.63,Default,,0,0,0,,from side-to-side.
Dialogue: 0,0:36:01.30,0:36:02.75,Default,,0,0,0,,You can also do something which
Dialogue: 0,0:36:02.75,0:36:04.22,Default,,0,0,0,,is force the perspective to
Dialogue: 0,0:36:04.22,0:36:04.84,Default,,0,0,0,,change.
Dialogue: 0,0:36:04.84,0:36:07.56,Default,,0,0,0,,Knowing where the depth is, you
Dialogue: 0,0:36:07.56,0:36:09.41,Default,,0,0,0,,can mess with the depth, like
Dialogue: 0,0:36:09.41,0:36:09.81,Default,,0,0,0,,this.
Dialogue: 0,0:36:10.82,0:36:11.85,Default,,0,0,0,,Dolly zoom [laughter].
Dialogue: 0,0:36:13.24,0:36:14.75,Default,,0,0,0,,Dolly zoom, dog in your face.
Dialogue: 0,0:36:15.05,0:36:16.73,Default,,0,0,0,,I have preferred to rotate it
Dialogue: 0,0:36:16.73,0:36:18.19,Default,,0,0,0,,while Dolly zooming, because
Dialogue: 0,0:36:18.19,0:36:19.25,Default,,0,0,0,,it's sort of like a gangster
Dialogue: 0,0:36:19.25,0:36:19.58,Default,,0,0,0,,dog.
Dialogue: 0,0:36:19.58,0:36:23.50,Default,,0,0,0,,I think the appropriate music
Dialogue: 0,0:36:23.50,0:36:24.40,Default,,0,0,0,,for this part would be "Rolling
Dialogue: 0,0:36:24.40,0:36:24.98,Default,,0,0,0,,in the Deep," don't you?
Dialogue: 0,0:36:25.52,0:36:28.07,Default,,0,0,0,,[ Group groaning ]
Dialogue: 0,0:36:28.57,0:36:29.93,Default,,0,0,0,,You guys are doing a great job.
Dialogue: 0,0:36:29.93,0:36:30.49,Default,,0,0,0,,I appreciate.
Dialogue: 0,0:36:30.49,0:36:30.98,Default,,0,0,0,,I really appreciate it.
Dialogue: 0,0:36:37.05,0:36:39.02,Default,,0,0,0,,Okay. When taking photos with
Dialogue: 0,0:36:39.02,0:36:41.15,Default,,0,0,0,,depth, we support a wide gamut
Dialogue: 0,0:36:41.19,0:36:42.28,Default,,0,0,0,,of capture options.
Dialogue: 0,0:36:43.16,0:36:44.78,Default,,0,0,0,,You can do flash captures with
Dialogue: 0,0:36:44.81,0:36:46.45,Default,,0,0,0,,depth, you can do still image
Dialogue: 0,0:36:46.45,0:36:48.03,Default,,0,0,0,,stabilization with depth.
Dialogue: 0,0:36:48.47,0:36:49.78,Default,,0,0,0,,You can even do auto exposure
Dialogue: 0,0:36:49.78,0:36:51.75,Default,,0,0,0,,brackets, such as a plus 2,
Dialogue: 0,0:36:51.75,0:36:52.89,Default,,0,0,0,,minus 2, 0 EV.
Dialogue: 0,0:36:52.89,0:36:56.63,Default,,0,0,0,,You can do Live Photos with the
Dialogue: 0,0:36:56.63,0:36:58.10,Default,,0,0,0,,depth stored in the photo
Dialogue: 0,0:36:58.10,0:36:58.61,Default,,0,0,0,,itself.
Dialogue: 0,0:37:00.69,0:37:02.53,Default,,0,0,0,,AVCapturePhotoOutput is what you
Dialogue: 0,0:37:02.53,0:37:04.97,Default,,0,0,0,,need to use to get photos with
Dialogue: 0,0:37:05.02,0:37:05.26,Default,,0,0,0,,depth.
Dialogue: 0,0:37:05.73,0:37:06.58,Default,,0,0,0,,This is a class that we
Dialogue: 0,0:37:06.58,0:37:07.85,Default,,0,0,0,,introduced last year as the
Dialogue: 0,0:37:07.85,0:37:08.73,Default,,0,0,0,,successor to
Dialogue: 0,0:37:08.73,0:37:10.13,Default,,0,0,0,,AVCaptureStillImageOutput.
Dialogue: 0,0:37:10.95,0:37:13.38,Default,,0,0,0,,It excels at handling complex
Dialogue: 0,0:37:13.38,0:37:14.40,Default,,0,0,0,,photo requests.
Dialogue: 0,0:37:14.80,0:37:15.85,Default,,0,0,0,,I'm talking about a request
Dialogue: 0,0:37:15.85,0:37:17.53,Default,,0,0,0,,where you expect to get multiple
Dialogue: 0,0:37:17.53,0:37:19.31,Default,,0,0,0,,assets and they need to be
Dialogue: 0,0:37:19.31,0:37:21.26,Default,,0,0,0,,tracked and delivered, such as
Dialogue: 0,0:37:21.73,0:37:24.02,Default,,0,0,0,,you're going to get a raw and a
Dialogue: 0,0:37:24.02,0:37:27.29,Default,,0,0,0,,JPEG, and a live photo movie, et
Dialogue: 0,0:37:27.29,0:37:27.59,Default,,0,0,0,,cetera.
Dialogue: 0,0:37:27.59,0:37:28.96,Default,,0,0,0,,You could get multiple things
Dialogue: 0,0:37:28.96,0:37:29.64,Default,,0,0,0,,and they're coming in at
Dialogue: 0,0:37:29.64,0:37:30.32,Default,,0,0,0,,different points.
Dialogue: 0,0:37:30.71,0:37:31.84,Default,,0,0,0,,The programming model is that
Dialogue: 0,0:37:31.84,0:37:34.14,Default,,0,0,0,,you fill out a request, which is
Dialogue: 0,0:37:34.14,0:37:34.43,Default,,0,0,0,,called an
Dialogue: 0,0:37:34.43,0:37:36.40,Default,,0,0,0,,AVCapturePhotoSettings, you
Dialogue: 0,0:37:36.40,0:37:37.68,Default,,0,0,0,,initiate the photo capture by
Dialogue: 0,0:37:37.68,0:37:39.46,Default,,0,0,0,,passing the request and the
Dialogue: 0,0:37:39.46,0:37:40.80,Default,,0,0,0,,delegate to be called later.
Dialogue: 0,0:37:41.58,0:37:44.05,Default,,0,0,0,,And as your photoOutput is the
Dialogue: 0,0:37:44.05,0:37:45.51,Default,,0,0,0,,one and only interface for
Dialogue: 0,0:37:45.51,0:37:49.96,Default,,0,0,0,,capturing Live Photos, bare RAW
Dialogue: 0,0:37:49.96,0:37:52.95,Default,,0,0,0,,images, and Apple P3 wide-color
Dialogue: 0,0:37:52.95,0:37:53.44,Default,,0,0,0,,images.
Dialogue: 0,0:37:54.43,0:37:56.68,Default,,0,0,0,,Also, now in iOS 11 it is the
Dialogue: 0,0:37:56.68,0:37:59.64,Default,,0,0,0,,one and only way to capture HEIF
Dialogue: 0,0:37:59.76,0:38:01.85,Default,,0,0,0,,file format, which was mentioned
Dialogue: 0,0:38:01.85,0:38:02.52,Default,,0,0,0,,in the keynote.
Dialogue: 0,0:38:04.07,0:38:05.37,Default,,0,0,0,,A great many changes needed to
Dialogue: 0,0:38:05.37,0:38:06.40,Default,,0,0,0,,be made to the
Dialogue: 0,0:38:06.40,0:38:08.27,Default,,0,0,0,,AVCapturePhotoOutput to support
Dialogue: 0,0:38:08.44,0:38:11.10,Default,,0,0,0,,HEIF and so in iOS 11, to
Dialogue: 0,0:38:11.10,0:38:13.30,Default,,0,0,0,,accommodate those great many
Dialogue: 0,0:38:13.30,0:38:15.16,Default,,0,0,0,,changes, we have added a new
Dialogue: 0,0:38:15.16,0:38:16.16,Default,,0,0,0,,delegate callback.
Dialogue: 0,0:38:17.04,0:38:18.68,Default,,0,0,0,,It's a simple one.
Dialogue: 0,0:38:19.13,0:38:21.03,Default,,0,0,0,,This is a replacement for the
Dialogue: 0,0:38:21.03,0:38:22.77,Default,,0,0,0,,callbacks where you would get a
Dialogue: 0,0:38:22.77,0:38:23.48,Default,,0,0,0,,sample buffer.
Dialogue: 0,0:38:23.90,0:38:25.17,Default,,0,0,0,,Instead, you now get a new
Dialogue: 0,0:38:25.41,0:38:27.32,Default,,0,0,0,,object called an AVCapturePhoto.
Dialogue: 0,0:38:27.32,0:38:30.49,Default,,0,0,0,,AVCapturePhoto is the only
Dialogue: 0,0:38:30.56,0:38:32.76,Default,,0,0,0,,delivery vehicle for depth, so
Dialogue: 0,0:38:32.76,0:38:34.49,Default,,0,0,0,,if you want depth, you need to
Dialogue: 0,0:38:34.57,0:38:36.86,Default,,0,0,0,,opt in by implementing this new
Dialogue: 0,0:38:36.86,0:38:37.68,Default,,0,0,0,,delegate callback.
Dialogue: 0,0:38:39.10,0:38:41.12,Default,,0,0,0,,In addition, you need to
Dialogue: 0,0:38:41.12,0:38:42.79,Default,,0,0,0,,explicitly opt in for
Dialogue: 0,0:38:42.79,0:38:44.54,Default,,0,0,0,,DepthDataDelivery before
Dialogue: 0,0:38:44.54,0:38:45.49,Default,,0,0,0,,starting your session.
Dialogue: 0,0:38:46.17,0:38:48.50,Default,,0,0,0,,Why? Well, remember, the dual
Dialogue: 0,0:38:48.50,0:38:49.81,Default,,0,0,0,,camera needs to do some special
Dialogue: 0,0:38:49.81,0:38:51.19,Default,,0,0,0,,behavior when it's doing depth.
Dialogue: 0,0:38:51.19,0:38:53.04,Default,,0,0,0,,It needs to zoom up to 2X so
Dialogue: 0,0:38:53.04,0:38:54.85,Default,,0,0,0,,that the focal lengths match,
Dialogue: 0,0:38:55.33,0:38:56.51,Default,,0,0,0,,and it needs to lock itself
Dialogue: 0,0:38:56.51,0:38:57.45,Default,,0,0,0,,there so that you're not
Dialogue: 0,0:38:57.45,0:38:57.84,Default,,0,0,0,,zooming.
Dialogue: 0,0:38:58.62,0:39:00.74,Default,,0,0,0,,So the way that you do that is
Dialogue: 0,0:39:00.74,0:39:01.70,Default,,0,0,0,,before you start running your
Dialogue: 0,0:39:01.70,0:39:02.75,Default,,0,0,0,,session, you tell the
Dialogue: 0,0:39:02.75,0:39:04.44,Default,,0,0,0,,photoOutput I want
Dialogue: 0,0:39:04.44,0:39:06.07,Default,,0,0,0,,DepthDataDeliveryEnabled, and
Dialogue: 0,0:39:06.71,0:39:08.95,Default,,0,0,0,,then on a per photo request
Dialogue: 0,0:39:08.95,0:39:10.20,Default,,0,0,0,,basis, that would be when you
Dialogue: 0,0:39:10.20,0:39:11.82,Default,,0,0,0,,actually snap the photo, you
Dialogue: 0,0:39:11.82,0:39:13.10,Default,,0,0,0,,would fill out a settings object
Dialogue: 0,0:39:13.10,0:39:15.29,Default,,0,0,0,,and say, again, I want depth in
Dialogue: 0,0:39:15.29,0:39:16.28,Default,,0,0,0,,this particular photo.
Dialogue: 0,0:39:17.92,0:39:19.53,Default,,0,0,0,,Then you work with the resulting
Dialogue: 0,0:39:19.83,0:39:21.78,Default,,0,0,0,,AVCapturePhoto that comes back
Dialogue: 0,0:39:22.24,0:39:23.71,Default,,0,0,0,,and it has an accessor called
Dialogue: 0,0:39:23.78,0:39:25.33,Default,,0,0,0,,AVDepthData.
Dialogue: 0,0:39:25.33,0:39:26.53,Default,,0,0,0,,Wow, that AVDepthData, it's
Dialogue: 0,0:39:26.53,0:39:26.97,Default,,0,0,0,,everywhere.
Dialogue: 0,0:39:26.97,0:39:27.83,Default,,0,0,0,,It's like pervasive.
Dialogue: 0,0:39:28.60,0:39:29.76,Default,,0,0,0,,It's like deeply integrated into
Dialogue: 0,0:39:29.76,0:39:29.98,Default,,0,0,0,,the API.
Dialogue: 0,0:39:30.52,0:39:34.00,Default,,0,0,0,,[ Group groaning ]
Dialogue: 0,0:39:34.50,0:39:36.58,Default,,0,0,0,,On iOS most AVCaptureDevice
Dialogue: 0,0:39:36.58,0:39:38.06,Default,,0,0,0,,formats have the ability to take
Dialogue: 0,0:39:38.19,0:39:40.53,Default,,0,0,0,,higher resolution stills than
Dialogue: 0,0:39:40.53,0:39:41.84,Default,,0,0,0,,their streaming resolution.
Dialogue: 0,0:39:42.33,0:39:43.44,Default,,0,0,0,,Looking at our formats that
Dialogue: 0,0:39:43.44,0:39:45.79,Default,,0,0,0,,support depth on iPhone 7 Plus,
Dialogue: 0,0:39:46.26,0:39:49.06,Default,,0,0,0,,here you see the streaming video
Dialogue: 0,0:39:49.06,0:39:50.63,Default,,0,0,0,,resolution compared to the high
Dialogue: 0,0:39:50.63,0:39:51.97,Default,,0,0,0,,res photo resolution that you
Dialogue: 0,0:39:51.97,0:39:52.25,Default,,0,0,0,,get.
Dialogue: 0,0:39:52.74,0:39:54.60,Default,,0,0,0,,So, for instance, for photo, if
Dialogue: 0,0:39:54.60,0:39:55.61,Default,,0,0,0,,you're streaming, you only get
Dialogue: 0,0:39:55.61,0:39:56.98,Default,,0,0,0,,screen-sized buffers, but you
Dialogue: 0,0:39:56.98,0:39:58.79,Default,,0,0,0,,get 12-megapixel stills.
Dialogue: 0,0:39:59.71,0:40:01.37,Default,,0,0,0,,The same holds true for depth.
Dialogue: 0,0:40:02.58,0:40:03.59,Default,,0,0,0,,Remember what I told you that
Dialogue: 0,0:40:03.59,0:40:04.54,Default,,0,0,0,,when we're streaming depth,
Dialogue: 0,0:40:04.54,0:40:06.00,Default,,0,0,0,,there's a lot of work to be done
Dialogue: 0,0:40:06.10,0:40:08.03,Default,,0,0,0,,in a real-time fashion to meet
Dialogue: 0,0:40:08.03,0:40:10.75,Default,,0,0,0,,that 24 fps, but when doing a
Dialogue: 0,0:40:10.75,0:40:12.19,Default,,0,0,0,,photo, we have a little extra
Dialogue: 0,0:40:12.19,0:40:13.95,Default,,0,0,0,,time since it doesn't need to be
Dialogue: 0,0:40:13.95,0:40:15.53,Default,,0,0,0,,delivered real time, so we can
Dialogue: 0,0:40:15.53,0:40:17.25,Default,,0,0,0,,give you a very high quality,
Dialogue: 0,0:40:17.50,0:40:18.75,Default,,0,0,0,,great looking map that's over
Dialogue: 0,0:40:18.75,0:40:20.11,Default,,0,0,0,,twice the resolution of the
Dialogue: 0,0:40:20.11,0:40:20.60,Default,,0,0,0,,streaming.
Dialogue: 0,0:40:21.83,0:40:24.03,Default,,0,0,0,,The aspect ratio always matches
Dialogue: 0,0:40:24.03,0:40:24.90,Default,,0,0,0,,that of the video.
Dialogue: 0,0:40:24.90,0:40:26.45,Default,,0,0,0,,So if you're doing 16x9 video,
Dialogue: 0,0:40:26.71,0:40:29.78,Default,,0,0,0,,you get a 16x9 map.
Dialogue: 0,0:40:30.46,0:40:30.95,Default,,0,0,0,,All right.
Dialogue: 0,0:40:31.23,0:40:32.64,Default,,0,0,0,,Now it's time to talk about the
Dialogue: 0,0:40:32.64,0:40:33.94,Default,,0,0,0,,dirty little subject of
Dialogue: 0,0:40:34.21,0:40:35.06,Default,,0,0,0,,distortions.
Dialogue: 0,0:40:36.25,0:40:37.88,Default,,0,0,0,,The depth maps that we capture
Dialogue: 0,0:40:37.88,0:40:39.55,Default,,0,0,0,,and embed in photos are
Dialogue: 0,0:40:40.33,0:40:40.99,Default,,0,0,0,,distorted.
Dialogue: 0,0:40:41.96,0:40:43.42,Default,,0,0,0,,I'm sorry to be the bearer of
Dialogue: 0,0:40:43.42,0:40:44.82,Default,,0,0,0,,that news, but it's actually a
Dialogue: 0,0:40:44.82,0:40:45.28,Default,,0,0,0,,good thing.
Dialogue: 0,0:40:45.85,0:40:46.72,Default,,0,0,0,,Let me explain why.
Dialogue: 0,0:40:47.77,0:40:49.07,Default,,0,0,0,,All the camera diagrams that I
Dialogue: 0,0:40:49.07,0:40:51.03,Default,,0,0,0,,showed you up to this point were
Dialogue: 0,0:40:51.03,0:40:52.18,Default,,0,0,0,,pinhole cameras.
Dialogue: 0,0:40:52.87,0:40:54.58,Default,,0,0,0,,Pinhole cameras have no lenses
Dialogue: 0,0:40:55.19,0:40:57.53,Default,,0,0,0,,so the images are rectilinear;
Dialogue: 0,0:40:58.22,0:41:00.01,Default,,0,0,0,,that is, light passes through
Dialogue: 0,0:41:00.01,0:41:01.86,Default,,0,0,0,,the little aperture in straight
Dialogue: 0,0:41:01.86,0:41:04.98,Default,,0,0,0,,lines and presents a
Dialogue: 0,0:41:04.98,0:41:08.05,Default,,0,0,0,,geometrically perfect replicated
Dialogue: 0,0:41:08.05,0:41:09.61,Default,,0,0,0,,inverted object on the image
Dialogue: 0,0:41:09.61,0:41:09.95,Default,,0,0,0,,plane.
Dialogue: 0,0:41:10.67,0:41:12.51,Default,,0,0,0,,So if you had a perfect grid of
Dialogue: 0,0:41:12.51,0:41:14.21,Default,,0,0,0,,squares like this and you took a
Dialogue: 0,0:41:14.21,0:41:15.71,Default,,0,0,0,,picture of it with a pinhole
Dialogue: 0,0:41:15.71,0:41:17.37,Default,,0,0,0,,camera, it would look like this
Dialogue: 0,0:41:17.37,0:41:18.27,Default,,0,0,0,,on the image plane, but
Dialogue: 0,0:41:18.27,0:41:18.81,Default,,0,0,0,,upside-down.
Dialogue: 0,0:41:19.49,0:41:21.87,Default,,0,0,0,,So straight lines would remain
Dialogue: 0,0:41:21.87,0:41:22.23,Default,,0,0,0,,straight.
Dialogue: 0,0:41:23.88,0:41:25.42,Default,,0,0,0,,Unfortunately, in the real world
Dialogue: 0,0:41:25.42,0:41:26.99,Default,,0,0,0,,we need to let more light in, so
Dialogue: 0,0:41:26.99,0:41:29.13,Default,,0,0,0,,we need lenses, and lenses have
Dialogue: 0,0:41:29.13,0:41:30.07,Default,,0,0,0,,radial distortions.
Dialogue: 0,0:41:30.82,0:41:32.38,Default,,0,0,0,,These distortions are present in
Dialogue: 0,0:41:32.38,0:41:33.69,Default,,0,0,0,,the captured images as well
Dialogue: 0,0:41:33.69,0:41:36.49,Default,,0,0,0,,because they were sort of bent
Dialogue: 0,0:41:36.49,0:41:39.40,Default,,0,0,0,,in slightly odd ways to get to
Dialogue: 0,0:41:39.40,0:41:40.15,Default,,0,0,0,,the image sensor.
Dialogue: 0,0:41:40.40,0:41:42.34,Default,,0,0,0,,And in an extreme case, straight
Dialogue: 0,0:41:42.34,0:41:43.59,Default,,0,0,0,,lines captured through a bad
Dialogue: 0,0:41:43.59,0:41:44.78,Default,,0,0,0,,lens might look something like
Dialogue: 0,0:41:44.78,0:41:45.19,Default,,0,0,0,,this.
Dialogue: 0,0:41:45.73,0:41:47.20,Default,,0,0,0,,This is no good for finding
Dialogue: 0,0:41:47.20,0:41:49.40,Default,,0,0,0,,disparity, since two images need
Dialogue: 0,0:41:49.40,0:41:51.14,Default,,0,0,0,,to be matched to find features.
Dialogue: 0,0:41:51.51,0:41:53.51,Default,,0,0,0,,Well, if camera one has got a
Dialogue: 0,0:41:53.51,0:41:54.86,Default,,0,0,0,,set of distortions and camera
Dialogue: 0,0:41:54.86,0:41:56.04,Default,,0,0,0,,two has got a different set of
Dialogue: 0,0:41:56.04,0:41:57.42,Default,,0,0,0,,distortions, how are you going
Dialogue: 0,0:41:57.42,0:41:59.25,Default,,0,0,0,,to find the same set of features
Dialogue: 0,0:41:59.25,0:42:01.13,Default,,0,0,0,,in those two images since
Dialogue: 0,0:42:01.13,0:42:02.25,Default,,0,0,0,,they're warped differently?
Dialogue: 0,0:42:02.41,0:42:06.22,Default,,0,0,0,,I left out an important step
Dialogue: 0,0:42:06.22,0:42:07.24,Default,,0,0,0,,when I described how we
Dialogue: 0,0:42:07.24,0:42:09.29,Default,,0,0,0,,calculate disparities and I'm
Dialogue: 0,0:42:09.29,0:42:10.32,Default,,0,0,0,,going to fill it in right now.
Dialogue: 0,0:42:10.98,0:42:12.70,Default,,0,0,0,,Before comparing the tele and
Dialogue: 0,0:42:12.70,0:42:14.70,Default,,0,0,0,,the wide images, we have to do
Dialogue: 0,0:42:14.70,0:42:15.34,Default,,0,0,0,,an extra step.
Dialogue: 0,0:42:15.97,0:42:17.18,Default,,0,0,0,,We have to make those warped
Dialogue: 0,0:42:17.18,0:42:20.55,Default,,0,0,0,,images rectilinear; that is, we
Dialogue: 0,0:42:20.60,0:42:22.66,Default,,0,0,0,,unwarp them using a calibrated
Dialogue: 0,0:42:22.66,0:42:25.20,Default,,0,0,0,,set of coefficients and those
Dialogue: 0,0:42:25.20,0:42:26.46,Default,,0,0,0,,characterize the lens'
Dialogue: 0,0:42:26.74,0:42:27.41,Default,,0,0,0,,distortions.
Dialogue: 0,0:42:28.54,0:42:30.09,Default,,0,0,0,,After each image is corrected
Dialogue: 0,0:42:30.55,0:42:32.21,Default,,0,0,0,,they look like this; satisfying,
Dialogue: 0,0:42:32.53,0:42:33.66,Default,,0,0,0,,straight lines, straight.
Dialogue: 0,0:42:34.41,0:42:35.74,Default,,0,0,0,,Now we can, with certainty,
Dialogue: 0,0:42:35.74,0:42:37.40,Default,,0,0,0,,compare points in the two images
Dialogue: 0,0:42:37.40,0:42:40.54,Default,,0,0,0,,and find a perfect, real-world,
Dialogue: 0,0:42:40.98,0:42:43.45,Default,,0,0,0,,rectilinear disparity map, which
Dialogue: 0,0:42:43.45,0:42:44.97,Default,,0,0,0,,looks like that.
Dialogue: 0,0:42:45.66,0:42:46.61,Default,,0,0,0,,Now we have the opposite
Dialogue: 0,0:42:46.61,0:42:47.04,Default,,0,0,0,,problem.
Dialogue: 0,0:42:47.68,0:42:49.02,Default,,0,0,0,,The disparity map matches the
Dialogue: 0,0:42:49.02,0:42:51.30,Default,,0,0,0,,physical world, but it doesn't
Dialogue: 0,0:42:51.30,0:42:53.04,Default,,0,0,0,,match the image that we just
Dialogue: 0,0:42:53.04,0:42:54.64,Default,,0,0,0,,took, which has warping due to
Dialogue: 0,0:42:54.64,0:42:56.38,Default,,0,0,0,,the lens, so now we have to do
Dialogue: 0,0:42:56.38,0:42:59.25,Default,,0,0,0,,another step, which is to rewarp
Dialogue: 0,0:42:59.67,0:43:01.97,Default,,0,0,0,,the disparity map back to the
Dialogue: 0,0:43:01.97,0:43:04.28,Default,,0,0,0,,image so that it -- we use a set
Dialogue: 0,0:43:04.28,0:43:06.22,Default,,0,0,0,,of inverse lens coefficients to
Dialogue: 0,0:43:06.22,0:43:08.03,Default,,0,0,0,,do this, and the final disparity
Dialogue: 0,0:43:08.03,0:43:09.85,Default,,0,0,0,,map has the same geometric
Dialogue: 0,0:43:10.01,0:43:11.86,Default,,0,0,0,,distortions as its accompanying
Dialogue: 0,0:43:11.86,0:43:12.25,Default,,0,0,0,,image.
Dialogue: 0,0:43:13.30,0:43:14.55,Default,,0,0,0,,So I said that this was a good
Dialogue: 0,0:43:14.55,0:43:14.78,Default,,0,0,0,,thing.
Dialogue: 0,0:43:14.78,0:43:15.60,Default,,0,0,0,,Let me explain why.
Dialogue: 0,0:43:16.15,0:43:18.40,Default,,0,0,0,,It means that out of the box our
Dialogue: 0,0:43:18.40,0:43:20.50,Default,,0,0,0,,depthDataMaps that come with
Dialogue: 0,0:43:20.50,0:43:23.59,Default,,0,0,0,,photos are meant for filters,
Dialogue: 0,0:43:23.67,0:43:24.26,Default,,0,0,0,,for effects.
Dialogue: 0,0:43:24.64,0:43:26.76,Default,,0,0,0,,They always match the image that
Dialogue: 0,0:43:26.76,0:43:27.36,Default,,0,0,0,,they accompany.
Dialogue: 0,0:43:27.77,0:43:29.51,Default,,0,0,0,,So if you're working on effects,
Dialogue: 0,0:43:29.51,0:43:31.39,Default,,0,0,0,,if you want to do stuff with
Dialogue: 0,0:43:31.50,0:43:33.68,Default,,0,0,0,,like the Wiggle Me app, you want
Dialogue: 0,0:43:33.68,0:43:36.15,Default,,0,0,0,,to do interesting effects with
Dialogue: 0,0:43:36.27,0:43:37.60,Default,,0,0,0,,the image such as I showed at
Dialogue: 0,0:43:37.60,0:43:39.26,Default,,0,0,0,,the very beginning, they're
Dialogue: 0,0:43:39.26,0:43:40.05,Default,,0,0,0,,perfect for that.
Dialogue: 0,0:43:40.68,0:43:42.13,Default,,0,0,0,,What they're not perfect for is
Dialogue: 0,0:43:42.18,0:43:43.93,Default,,0,0,0,,reconstructing a 3D scene.
Dialogue: 0,0:43:44.43,0:43:45.56,Default,,0,0,0,,If you want to do that, you
Dialogue: 0,0:43:45.56,0:43:47.09,Default,,0,0,0,,should make them rectilinear,
Dialogue: 0,0:43:48.07,0:43:48.90,Default,,0,0,0,,and you can do that.
Dialogue: 0,0:43:48.90,0:43:49.87,Default,,0,0,0,,I'm going to talk about that in
Dialogue: 0,0:43:51.24,0:43:52.14,Default,,0,0,0,,a minute.
Dialogue: 0,0:43:52.14,0:43:53.74,Default,,0,0,0,,I'd like to just touch briefly
Dialogue: 0,0:43:53.74,0:43:55.66,Default,,0,0,0,,on the physical structure of the
Dialogue: 0,0:43:55.66,0:43:57.95,Default,,0,0,0,,depth data in our image files.
Dialogue: 0,0:43:58.56,0:44:01.06,Default,,0,0,0,,In iOS 11 we support two kinds
Dialogue: 0,0:44:01.06,0:44:02.51,Default,,0,0,0,,of images with depth.
Dialogue: 0,0:44:02.62,0:44:05.06,Default,,0,0,0,,The first is HEIF HEVC, the new
Dialogue: 0,0:44:05.06,0:44:08.16,Default,,0,0,0,,format, also called HEIC files,
Dialogue: 0,0:44:08.82,0:44:10.78,Default,,0,0,0,,and there, there is first-class
Dialogue: 0,0:44:10.78,0:44:11.79,Default,,0,0,0,,support for depth.
Dialogue: 0,0:44:12.35,0:44:13.99,Default,,0,0,0,,There's an area inside the file
Dialogue: 0,0:44:13.99,0:44:15.65,Default,,0,0,0,,called the auxiliary image,
Dialogue: 0,0:44:15.65,0:44:17.74,Default,,0,0,0,,which can store a disparity or a
Dialogue: 0,0:44:17.74,0:44:20.10,Default,,0,0,0,,depth or an alpha map, and
Dialogue: 0,0:44:20.10,0:44:21.01,Default,,0,0,0,,that's where we store it.
Dialogue: 0,0:44:21.59,0:44:24.79,Default,,0,0,0,,We encode it as monochrome HEVC,
Dialogue: 0,0:44:25.48,0:44:27.02,Default,,0,0,0,,and we also store metadata
Dialogue: 0,0:44:27.02,0:44:29.47,Default,,0,0,0,,that's important for working
Dialogue: 0,0:44:29.47,0:44:32.26,Default,,0,0,0,,with that depth, such as
Dialogue: 0,0:44:32.26,0:44:33.40,Default,,0,0,0,,information about whether or not
Dialogue: 0,0:44:33.40,0:44:35.77,Default,,0,0,0,,it was filtered, what is its
Dialogue: 0,0:44:35.77,0:44:38.17,Default,,0,0,0,,accuracy, camera calibration
Dialogue: 0,0:44:38.17,0:44:39.18,Default,,0,0,0,,information like lens
Dialogue: 0,0:44:39.18,0:44:41.04,Default,,0,0,0,,distortions, and also some
Dialogue: 0,0:44:41.04,0:44:42.09,Default,,0,0,0,,rendering instructions.
Dialogue: 0,0:44:42.55,0:44:45.50,Default,,0,0,0,,All of those are encoded as XMP
Dialogue: 0,0:44:45.63,0:44:47.20,Default,,0,0,0,,along with the auxiliary image.
Dialogue: 0,0:44:48.64,0:44:50.30,Default,,0,0,0,,The second format we support is
Dialogue: 0,0:44:50.30,0:44:50.60,Default,,0,0,0,,JPEG.
Dialogue: 0,0:44:51.41,0:44:53.34,Default,,0,0,0,,Boy, JPEG wasn't meant to do
Dialogue: 0,0:44:53.34,0:44:54.55,Default,,0,0,0,,tricks like this, but we made it
Dialogue: 0,0:44:54.55,0:44:55.49,Default,,0,0,0,,do this trick anyway.
Dialogue: 0,0:44:56.09,0:44:59.43,Default,,0,0,0,,The map is 8-bit lossy JPEG if
Dialogue: 0,0:44:59.43,0:45:01.25,Default,,0,0,0,,it's filtered, or if it has not
Dialogue: 0,0:45:01.25,0:45:04.16,Default,,0,0,0,,a numbers in it, we use 16-bit
Dialogue: 0,0:45:04.16,0:45:06.13,Default,,0,0,0,,lossless JPEG encoding to
Dialogue: 0,0:45:06.13,0:45:07.16,Default,,0,0,0,,preserve all of the not a
Dialogue: 0,0:45:07.16,0:45:09.43,Default,,0,0,0,,numbers, and we store it as a
Dialogue: 0,0:45:09.43,0:45:11.06,Default,,0,0,0,,second image at the bottom of
Dialogue: 0,0:45:11.06,0:45:12.15,Default,,0,0,0,,the JPEG, so it's like a
Dialogue: 0,0:45:12.15,0:45:13.49,Default,,0,0,0,,multipicture object, if you're
Dialogue: 0,0:45:13.49,0:45:14.20,Default,,0,0,0,,familiar with that.
Dialogue: 0,0:45:15.04,0:45:17.10,Default,,0,0,0,,Again, we store the metadata as
Dialogue: 0,0:45:17.19,0:45:20.14,Default,,0,0,0,,XMP, just as we do with HEIF
Dialogue: 0,0:45:21.96,0:45:22.36,Default,,0,0,0,,HEVC.
Dialogue: 0,0:45:23.44,0:45:23.83,Default,,0,0,0,,All right.
Dialogue: 0,0:45:23.83,0:45:25.10,Default,,0,0,0,,On to the most requested
Dialogue: 0,0:45:25.10,0:45:26.66,Default,,0,0,0,,developer feature for the dual
Dialogue: 0,0:45:26.66,0:45:28.42,Default,,0,0,0,,camera, and that's dual photo
Dialogue: 0,0:45:28.42,0:45:28.84,Default,,0,0,0,,capture.
Dialogue: 0,0:45:29.79,0:45:31.63,Default,,0,0,0,,What do I mean by this.
Dialogue: 0,0:45:32.14,0:45:33.84,Default,,0,0,0,,So far, when you use the dual
Dialogue: 0,0:45:33.84,0:45:35.94,Default,,0,0,0,,camera and take a picture, you
Dialogue: 0,0:45:35.94,0:45:37.23,Default,,0,0,0,,still just get one image.
Dialogue: 0,0:45:37.32,0:45:38.71,Default,,0,0,0,,It's either from the wide or
Dialogue: 0,0:45:38.71,0:45:40.02,Default,,0,0,0,,it's from the tele, depending
Dialogue: 0,0:45:40.02,0:45:41.39,Default,,0,0,0,,where you're zoomed, or if
Dialogue: 0,0:45:41.39,0:45:43.04,Default,,0,0,0,,you're in the area between one
Dialogue: 0,0:45:43.04,0:45:45.27,Default,,0,0,0,,and 2X you might get portions of
Dialogue: 0,0:45:45.36,0:45:46.93,Default,,0,0,0,,both as we do some blending to
Dialogue: 0,0:45:46.93,0:45:48.72,Default,,0,0,0,,make an even nicer picture, but
Dialogue: 0,0:45:48.72,0:45:49.75,Default,,0,0,0,,you still only get one.
Dialogue: 0,0:45:50.49,0:45:52.56,Default,,0,0,0,,You've been clamoring for both
Dialogue: 0,0:45:52.69,0:45:53.84,Default,,0,0,0,,images and that's what we're
Dialogue: 0,0:45:53.84,0:45:54.43,Default,,0,0,0,,giving you now.
Dialogue: 0,0:45:54.74,0:45:56.19,Default,,0,0,0,,With a single request, you can
Dialogue: 0,0:45:56.19,0:45:58.40,Default,,0,0,0,,get both the wide and the tele
Dialogue: 0,0:45:58.47,0:46:00.74,Default,,0,0,0,,in their full 12-megapixel glory
Dialogue: 0,0:46:00.74,0:46:01.51,Default,,0,0,0,,and you can do whatever the heck
Dialogue: 0,0:46:01.51,0:46:01.98,Default,,0,0,0,,you want with them.
Dialogue: 0,0:46:02.52,0:46:08.26,Default,,0,0,0,,[ Applause ]
Dialogue: 0,0:46:08.76,0:46:09.62,Default,,0,0,0,,Here's how you do it.
Dialogue: 0,0:46:09.75,0:46:11.03,Default,,0,0,0,,It's very similar to opting in
Dialogue: 0,0:46:11.03,0:46:11.58,Default,,0,0,0,,for depth.
Dialogue: 0,0:46:12.45,0:46:13.61,Default,,0,0,0,,Before starting the capture
Dialogue: 0,0:46:13.61,0:46:15.44,Default,,0,0,0,,session, you need to opt in by
Dialogue: 0,0:46:15.44,0:46:16.66,Default,,0,0,0,,telling the photoOutput I'm
Dialogue: 0,0:46:17.28,0:46:19.42,Default,,0,0,0,,going to ask for dual photo so
Dialogue: 0,0:46:19.65,0:46:20.17,Default,,0,0,0,,enable it.
Dialogue: 0,0:46:21.25,0:46:23.41,Default,,0,0,0,,And then as you are capturing on
Dialogue: 0,0:46:23.41,0:46:25.84,Default,,0,0,0,,a per photo request basis you
Dialogue: 0,0:46:25.84,0:46:27.32,Default,,0,0,0,,can fill out your settings by
Dialogue: 0,0:46:27.32,0:46:28.71,Default,,0,0,0,,saying I would like this
Dialogue: 0,0:46:28.71,0:46:30.54,Default,,0,0,0,,particular photo to be a dual
Dialogue: 0,0:46:30.54,0:46:32.25,Default,,0,0,0,,photo, give me both wide and
Dialogue: 0,0:46:32.25,0:46:32.55,Default,,0,0,0,,tele.
Dialogue: 0,0:46:34.32,0:46:36.29,Default,,0,0,0,,When you do that, the number of
Dialogue: 0,0:46:36.29,0:46:37.98,Default,,0,0,0,,photo callbacks that you get
Dialogue: 0,0:46:38.04,0:46:38.73,Default,,0,0,0,,doubles.
Dialogue: 0,0:46:38.89,0:46:39.93,Default,,0,0,0,,It's not just that you get two
Dialogue: 0,0:46:39.93,0:46:40.51,Default,,0,0,0,,callbacks.
Dialogue: 0,0:46:40.92,0:46:43.47,Default,,0,0,0,,Let's say you're asking for RAW
Dialogue: 0,0:46:43.47,0:46:45.80,Default,,0,0,0,,plus HEIF dual photo.
Dialogue: 0,0:46:45.80,0:46:47.22,Default,,0,0,0,,Well, that would be four because
Dialogue: 0,0:46:47.22,0:46:48.89,Default,,0,0,0,,you're going to get two wides
Dialogue: 0,0:46:48.89,0:46:52.42,Default,,0,0,0,,and two teles of RAW and HEIF.
Dialogue: 0,0:46:53.01,0:46:54.42,Default,,0,0,0,,So whatever you were expecting
Dialogue: 0,0:46:54.42,0:46:55.99,Default,,0,0,0,,to get before, the number of
Dialogue: 0,0:46:55.99,0:46:56.75,Default,,0,0,0,,callbacks will double.
Dialogue: 0,0:46:58.94,0:47:01.67,Default,,0,0,0,,Now, we support all of the same
Dialogue: 0,0:47:01.67,0:47:03.15,Default,,0,0,0,,gamut of features that we do
Dialogue: 0,0:47:03.15,0:47:04.97,Default,,0,0,0,,with depth, and that is you can
Dialogue: 0,0:47:04.97,0:47:07.69,Default,,0,0,0,,do flash with dual photo, auto
Dialogue: 0,0:47:07.69,0:47:10.56,Default,,0,0,0,,SIS, exposure brackets and you
Dialogue: 0,0:47:10.56,0:47:12.54,Default,,0,0,0,,can optionally get depth if you
Dialogue: 0,0:47:12.54,0:47:13.41,Default,,0,0,0,,need it.
Dialogue: 0,0:47:14.02,0:47:16.87,Default,,0,0,0,,How do we deal with zoom?
Dialogue: 0,0:47:17.06,0:47:20.14,Default,,0,0,0,,This is a problem of security
Dialogue: 0,0:47:20.14,0:47:21.35,Default,,0,0,0,,and confidence.
Dialogue: 0,0:47:21.75,0:47:23.18,Default,,0,0,0,,Let's say that your app only
Dialogue: 0,0:47:23.18,0:47:25.13,Default,,0,0,0,,shows the field of view of the
Dialogue: 0,0:47:25.13,0:47:25.61,Default,,0,0,0,,tele.
Dialogue: 0,0:47:26.40,0:47:28.26,Default,,0,0,0,,Well, the wide-angle camera has
Dialogue: 0,0:47:28.26,0:47:29.82,Default,,0,0,0,,more information, so if you take
Dialogue: 0,0:47:29.82,0:47:30.87,Default,,0,0,0,,a picture, you're actually
Dialogue: 0,0:47:30.87,0:47:32.99,Default,,0,0,0,,giving people something outside
Dialogue: 0,0:47:32.99,0:47:34.39,Default,,0,0,0,,of the viewable area and that
Dialogue: 0,0:47:34.39,0:47:35.70,Default,,0,0,0,,might be a privacy concern.
Dialogue: 0,0:47:36.16,0:47:38.31,Default,,0,0,0,,So if you are zooming, we
Dialogue: 0,0:47:38.31,0:47:40.22,Default,,0,0,0,,deliver dual photos, but with
Dialogue: 0,0:47:40.28,0:47:43.02,Default,,0,0,0,,the outside blackened so that
Dialogue: 0,0:47:43.02,0:47:44.23,Default,,0,0,0,,they match the field of view
Dialogue: 0,0:47:44.23,0:47:45.34,Default,,0,0,0,,that's seen in preview.
Dialogue: 0,0:47:45.78,0:47:46.88,Default,,0,0,0,,If you want the full image, you
Dialogue: 0,0:47:46.88,0:47:48.48,Default,,0,0,0,,can, just don't set the zoom to
Dialogue: 0,0:47:48.48,0:47:49.52,Default,,0,0,0,,anything other than one.
Dialogue: 0,0:47:50.50,0:47:52.14,Default,,0,0,0,,How do you know if it has this
Dialogue: 0,0:47:52.14,0:47:53.78,Default,,0,0,0,,blackened area on the outside?
Dialogue: 0,0:47:54.19,0:47:56.10,Default,,0,0,0,,Well, inside the image we store
Dialogue: 0,0:47:56.10,0:47:57.68,Default,,0,0,0,,a clean aperture rectangle that
Dialogue: 0,0:47:57.68,0:47:59.31,Default,,0,0,0,,defines the area with valid
Dialogue: 0,0:47:59.31,0:47:59.82,Default,,0,0,0,,pixels.
Dialogue: 0,0:47:59.82,0:48:03.86,Default,,0,0,0,,Dual photos can be delivered
Dialogue: 0,0:48:03.86,0:48:05.71,Default,,0,0,0,,with camera calibration data,
Dialogue: 0,0:48:05.71,0:48:06.00,Default,,0,0,0,,too.
Dialogue: 0,0:48:06.54,0:48:08.46,Default,,0,0,0,,Camera calibration data is the
Dialogue: 0,0:48:08.46,0:48:10.76,Default,,0,0,0,,kind of data that you need to do
Dialogue: 0,0:48:11.12,0:48:13.98,Default,,0,0,0,,augmented reality, virtual
Dialogue: 0,0:48:13.98,0:48:15.90,Default,,0,0,0,,reality, lens distortion
Dialogue: 0,0:48:15.90,0:48:17.09,Default,,0,0,0,,correction, et cetera.
Dialogue: 0,0:48:17.67,0:48:20.90,Default,,0,0,0,,So with both a wide and a tele
Dialogue: 0,0:48:21.38,0:48:23.85,Default,,0,0,0,,and camera calibration data, you
Dialogue: 0,0:48:23.85,0:48:25.42,Default,,0,0,0,,can make your own depth maps.
Dialogue: 0,0:48:25.80,0:48:27.00,Default,,0,0,0,,I challenge you to make one
Dialogue: 0,0:48:27.00,0:48:29.20,Default,,0,0,0,,better than Apple does.
Dialogue: 0,0:48:29.59,0:48:30.85,Default,,0,0,0,,You can also augment reality, of
Dialogue: 0,0:48:30.85,0:48:31.94,Default,,0,0,0,,course, because you get the
Dialogue: 0,0:48:31.94,0:48:32.64,Default,,0,0,0,,intrinsics.
Dialogue: 0,0:48:33.02,0:48:34.83,Default,,0,0,0,,Let's talk about the individual
Dialogue: 0,0:48:34.83,0:48:36.00,Default,,0,0,0,,properties of camera
Dialogue: 0,0:48:36.00,0:48:36.72,Default,,0,0,0,,calibration.
Dialogue: 0,0:48:36.72,0:48:37.91,Default,,0,0,0,,This is the last object that I'm
Dialogue: 0,0:48:37.91,0:48:38.93,Default,,0,0,0,,going to introduce tonight.
Dialogue: 0,0:48:39.88,0:48:42.60,Default,,0,0,0,,The AVCameraCalibrationData is
Dialogue: 0,0:48:42.60,0:48:44.38,Default,,0,0,0,,our model class for camera
Dialogue: 0,0:48:44.38,0:48:45.17,Default,,0,0,0,,calibrations.
Dialogue: 0,0:48:46.17,0:48:46.94,Default,,0,0,0,,Where does it live?
Dialogue: 0,0:48:47.15,0:48:49.08,Default,,0,0,0,,Well, if you ask for depth, you
Dialogue: 0,0:48:49.08,0:48:50.69,Default,,0,0,0,,get it with an AVDepthData.
Dialogue: 0,0:48:50.79,0:48:53.08,Default,,0,0,0,,It is a property of that.
Dialogue: 0,0:48:53.36,0:48:54.89,Default,,0,0,0,,You can also get it if you've
Dialogue: 0,0:48:54.89,0:48:57.28,Default,,0,0,0,,opted in from an AVCapturePhoto.
Dialogue: 0,0:48:57.28,0:48:59.83,Default,,0,0,0,,So you opt in by saying I would
Dialogue: 0,0:48:59.83,0:49:01.26,Default,,0,0,0,,like to camera calibration with
Dialogue: 0,0:49:01.26,0:49:03.17,Default,,0,0,0,,this photo, which works rather
Dialogue: 0,0:49:03.17,0:49:03.54,Default,,0,0,0,,nicely.
Dialogue: 0,0:49:03.54,0:49:04.43,Default,,0,0,0,,If you're doing dual photo
Dialogue: 0,0:49:04.43,0:49:06.02,Default,,0,0,0,,capture, you ask for dual photo
Dialogue: 0,0:49:06.02,0:49:07.17,Default,,0,0,0,,and you ask for the camera
Dialogue: 0,0:49:07.17,0:49:09.50,Default,,0,0,0,,calibrations, you get two photo
Dialogue: 0,0:49:09.50,0:49:10.87,Default,,0,0,0,,callbacks and you get the
Dialogue: 0,0:49:10.87,0:49:12.34,Default,,0,0,0,,calibrations for the wide, with
Dialogue: 0,0:49:12.41,0:49:13.76,Default,,0,0,0,,the wide result and the tele
Dialogue: 0,0:49:13.76,0:49:14.67,Default,,0,0,0,,with the tele result.
Dialogue: 0,0:49:16.21,0:49:17.50,Default,,0,0,0,,What does an intrinsicMatrix
Dialogue: 0,0:49:17.50,0:49:17.94,Default,,0,0,0,,look like?
Dialogue: 0,0:49:18.20,0:49:19.31,Default,,0,0,0,,I hope this is a little bit
Dialogue: 0,0:49:19.31,0:49:20.93,Default,,0,0,0,,familiar, since it's the same as
Dialogue: 0,0:49:20.98,0:49:22.26,Default,,0,0,0,,what we looked at earlier for
Dialogue: 0,0:49:22.26,0:49:23.61,Default,,0,0,0,,the streaming VideoDataOutput
Dialogue: 0,0:49:23.61,0:49:24.00,Default,,0,0,0,,case.
Dialogue: 0,0:49:24.70,0:49:27.15,Default,,0,0,0,,Again, it's a 3x3 matrix and the
Dialogue: 0,0:49:27.47,0:49:31.57,Default,,0,0,0,,CameraCalibrationData, it's used
Dialogue: 0,0:49:31.57,0:49:35.01,Default,,0,0,0,,for going from the 3D space to
Dialogue: 0,0:49:35.01,0:49:37.49,Default,,0,0,0,,the 2D space when flattening an
Dialogue: 0,0:49:37.49,0:49:37.93,Default,,0,0,0,,image.
Dialogue: 0,0:49:38.08,0:49:39.39,Default,,0,0,0,,You can apply the inverse when
Dialogue: 0,0:49:39.39,0:49:40.85,Default,,0,0,0,,going back to the 3D space.
Dialogue: 0,0:49:41.67,0:49:46.47,Default,,0,0,0,,It has pixel focal length which,
Dialogue: 0,0:49:46.47,0:49:48.50,Default,,0,0,0,,again, are two different
Dialogue: 0,0:49:48.50,0:49:49.60,Default,,0,0,0,,numbers, but because we have
Dialogue: 0,0:49:49.60,0:49:50.84,Default,,0,0,0,,square pixels, they are the same
Dialogue: 0,0:49:50.84,0:49:51.16,Default,,0,0,0,,number.
Dialogue: 0,0:49:53.04,0:49:55.60,Default,,0,0,0,,And it also has an x and y for
Dialogue: 0,0:49:55.60,0:49:56.85,Default,,0,0,0,,the optical center.
Dialogue: 0,0:49:58.46,0:50:00.25,Default,,0,0,0,,The pixel values are given at a
Dialogue: 0,0:50:00.25,0:50:02.94,Default,,0,0,0,,resolution of a reference frame.
Dialogue: 0,0:50:04.02,0:50:05.38,Default,,0,0,0,,Again, the depth data might be
Dialogue: 0,0:50:05.38,0:50:06.48,Default,,0,0,0,,very low resolution.
Dialogue: 0,0:50:06.48,0:50:07.47,Default,,0,0,0,,We don't want to give it to you
Dialogue: 0,0:50:07.47,0:50:08.78,Default,,0,0,0,,at that low resolution so,
Dialogue: 0,0:50:08.78,0:50:10.94,Default,,0,0,0,,therefore, we provide a separate
Dialogue: 0,0:50:11.10,0:50:12.12,Default,,0,0,0,,set of dimensions.
Dialogue: 0,0:50:12.29,0:50:13.56,Default,,0,0,0,,Typically, they're the full size
Dialogue: 0,0:50:13.56,0:50:14.92,Default,,0,0,0,,of the sensor, therefore, you
Dialogue: 0,0:50:14.92,0:50:17.37,Default,,0,0,0,,get a lot of accuracy, a lot of
Dialogue: 0,0:50:17.37,0:50:18.69,Default,,0,0,0,,resolution in the
Dialogue: 0,0:50:18.69,0:50:19.92,Default,,0,0,0,,intrinsicMatrix.
Dialogue: 0,0:50:19.98,0:50:24.18,Default,,0,0,0,,Next is the extrinsicMatrix.
Dialogue: 0,0:50:24.73,0:50:25.89,Default,,0,0,0,,This is a property that
Dialogue: 0,0:50:25.89,0:50:27.91,Default,,0,0,0,,describes the camera's pose in
Dialogue: 0,0:50:27.91,0:50:28.37,Default,,0,0,0,,the world.
Dialogue: 0,0:50:29.46,0:50:30.51,Default,,0,0,0,,You need it when you're working
Dialogue: 0,0:50:30.51,0:50:31.46,Default,,0,0,0,,with images from
Dialogue: 0,0:50:31.46,0:50:33.53,Default,,0,0,0,,stereo-rectified cameras to
Dialogue: 0,0:50:33.53,0:50:35.22,Default,,0,0,0,,triangulate where one is
Dialogue: 0,0:50:35.37,0:50:36.48,Default,,0,0,0,,compared to another one.
Dialogue: 0,0:50:37.01,0:50:39.04,Default,,0,0,0,,And our extrinsics are presented
Dialogue: 0,0:50:39.31,0:50:42.82,Default,,0,0,0,,as a single matrix, but kind of
Dialogue: 0,0:50:42.96,0:50:44.65,Default,,0,0,0,,two matrices squashed together.
Dialogue: 0,0:50:45.36,0:50:46.60,Default,,0,0,0,,So the first one, the one on the
Dialogue: 0,0:50:46.60,0:50:48.75,Default,,0,0,0,,left, is the rotation matrix.
Dialogue: 0,0:50:49.10,0:50:51.49,Default,,0,0,0,,It's a 3x3 that describes how
Dialogue: 0,0:50:51.49,0:50:53.68,Default,,0,0,0,,the camera is rotated with
Dialogue: 0,0:50:53.68,0:50:55.73,Default,,0,0,0,,respect to the world origin,
Dialogue: 0,0:50:55.73,0:50:56.83,Default,,0,0,0,,wherever that happens to be.
Dialogue: 0,0:50:57.31,0:50:59.27,Default,,0,0,0,,And there's also a 1x3 matrix
Dialogue: 0,0:50:59.35,0:51:00.49,Default,,0,0,0,,describing the camera's
Dialogue: 0,0:51:00.85,0:51:02.85,Default,,0,0,0,,translation, or sort of distance
Dialogue: 0,0:51:03.11,0:51:04.69,Default,,0,0,0,,from the world origin.
Dialogue: 0,0:51:05.76,0:51:07.57,Default,,0,0,0,,It's important to note that the
Dialogue: 0,0:51:07.57,0:51:10.40,Default,,0,0,0,,tele camera is the origin of the
Dialogue: 0,0:51:10.40,0:51:11.77,Default,,0,0,0,,world when you're using the dual
Dialogue: 0,0:51:11.77,0:51:13.21,Default,,0,0,0,,camera, which makes it very
Dialogue: 0,0:51:13.21,0:51:13.54,Default,,0,0,0,,easy.
Dialogue: 0,0:51:13.54,0:51:14.57,Default,,0,0,0,,If you're just getting a tele
Dialogue: 0,0:51:14.57,0:51:17.63,Default,,0,0,0,,image, the matrix that you get
Dialogue: 0,0:51:17.63,0:51:19.34,Default,,0,0,0,,will be an identity matrix.
Dialogue: 0,0:51:19.96,0:51:21.59,Default,,0,0,0,,If you're working with wide and
Dialogue: 0,0:51:21.62,0:51:23.61,Default,,0,0,0,,tele, then the wide will, of
Dialogue: 0,0:51:23.61,0:51:24.80,Default,,0,0,0,,course, not be an identity
Dialogue: 0,0:51:24.80,0:51:26.55,Default,,0,0,0,,matrix, since it's describing
Dialogue: 0,0:51:26.55,0:51:29.47,Default,,0,0,0,,its pose and distance from the
Dialogue: 0,0:51:29.70,0:51:31.37,Default,,0,0,0,,tele camera.
Dialogue: 0,0:51:31.73,0:51:32.90,Default,,0,0,0,,But using the extrinsics, you
Dialogue: 0,0:51:32.90,0:51:34.06,Default,,0,0,0,,could, for instance, compute the
Dialogue: 0,0:51:34.06,0:51:35.56,Default,,0,0,0,,baseline between the wide and
Dialogue: 0,0:51:35.56,0:51:35.95,Default,,0,0,0,,the tele.
Dialogue: 0,0:51:37.46,0:51:39.24,Default,,0,0,0,,There are also several
Dialogue: 0,0:51:39.24,0:51:40.15,Default,,0,0,0,,properties dealing with the
Dialogue: 0,0:51:40.15,0:51:41.59,Default,,0,0,0,,geometric distortions of the
Dialogue: 0,0:51:41.59,0:51:42.81,Default,,0,0,0,,lens, as we talked about
Dialogue: 0,0:51:42.81,0:51:43.17,Default,,0,0,0,,earlier.
Dialogue: 0,0:51:43.81,0:51:44.91,Default,,0,0,0,,These are useful for when you
Dialogue: 0,0:51:44.91,0:51:46.98,Default,,0,0,0,,need to make either an image or
Dialogue: 0,0:51:46.98,0:51:48.71,Default,,0,0,0,,a depth map rectilinear.
Dialogue: 0,0:51:49.94,0:51:51.92,Default,,0,0,0,,There are two properties that
Dialogue: 0,0:51:51.92,0:51:52.90,Default,,0,0,0,,you need to be concerned with.
Dialogue: 0,0:51:52.90,0:51:53.52,Default,,0,0,0,,The first is
Dialogue: 0,0:51:53.57,0:51:55.65,Default,,0,0,0,,lensDistortionCenter.
Dialogue: 0,0:51:56.65,0:51:58.17,Default,,0,0,0,,This describes the point on the
Dialogue: 0,0:51:58.17,0:51:59.94,Default,,0,0,0,,sensor that coincides with the
Dialogue: 0,0:51:59.94,0:52:02.87,Default,,0,0,0,,center of the lens' distortion.
Dialogue: 0,0:52:03.19,0:52:05.21,Default,,0,0,0,,This is frequently different
Dialogue: 0,0:52:05.21,0:52:06.51,Default,,0,0,0,,from the optical center of the
Dialogue: 0,0:52:06.51,0:52:06.90,Default,,0,0,0,,lens.
Dialogue: 0,0:52:07.12,0:52:08.20,Default,,0,0,0,,It's like if you looked at all
Dialogue: 0,0:52:08.20,0:52:09.97,Default,,0,0,0,,of the distortions, radial
Dialogue: 0,0:52:09.97,0:52:11.31,Default,,0,0,0,,distortions on the lens sort of
Dialogue: 0,0:52:11.31,0:52:13.18,Default,,0,0,0,,like tree rings, this would be
Dialogue: 0,0:52:13.18,0:52:15.28,Default,,0,0,0,,the center of the tree rings.
Dialogue: 0,0:52:16.23,0:52:17.96,Default,,0,0,0,,Also, along with this distortion
Dialogue: 0,0:52:17.96,0:52:19.42,Default,,0,0,0,,center we have a
Dialogue: 0,0:52:19.42,0:52:22.41,Default,,0,0,0,,lensDistortionLookupTable, which
Dialogue: 0,0:52:22.41,0:52:23.86,Default,,0,0,0,,you can think of as being a
Dialogue: 0,0:52:23.86,0:52:26.69,Default,,0,0,0,,number of floating point dots
Dialogue: 0,0:52:27.23,0:52:28.00,Default,,0,0,0,,connecting the
Dialogue: 0,0:52:28.00,0:52:29.52,Default,,0,0,0,,lensDistortionCenter to the
Dialogue: 0,0:52:29.52,0:52:30.85,Default,,0,0,0,,longest radius.
Dialogue: 0,0:52:31.20,0:52:32.08,Default,,0,0,0,,Again, if you drew little
Dialogue: 0,0:52:32.08,0:52:34.09,Default,,0,0,0,,circles from each of these dots,
Dialogue: 0,0:52:34.34,0:52:35.13,Default,,0,0,0,,you would get something that
Dialogue: 0,0:52:35.13,0:52:36.23,Default,,0,0,0,,looks like tree rings that would
Dialogue: 0,0:52:36.23,0:52:37.69,Default,,0,0,0,,show you the radial distortions
Dialogue: 0,0:52:37.69,0:52:38.31,Default,,0,0,0,,of the lens.
Dialogue: 0,0:52:39.22,0:52:41.26,Default,,0,0,0,,The lensDistortionLookupTable is
Dialogue: 0,0:52:41.26,0:52:43.10,Default,,0,0,0,,a C array of floats that are
Dialogue: 0,0:52:43.10,0:52:43.90,Default,,0,0,0,,wrapped in a data.
Dialogue: 0,0:52:45.25,0:52:46.93,Default,,0,0,0,,If each and every point along
Dialogue: 0,0:52:46.93,0:52:49.26,Default,,0,0,0,,those dotted lines was a 0, you
Dialogue: 0,0:52:49.26,0:52:50.66,Default,,0,0,0,,would have the one and only
Dialogue: 0,0:52:50.72,0:52:52.02,Default,,0,0,0,,perfect lens in the world.
Dialogue: 0,0:52:52.18,0:52:54.03,Default,,0,0,0,,It has no radial distortions at
Dialogue: 0,0:52:54.03,0:52:54.30,Default,,0,0,0,,all.
Dialogue: 0,0:52:54.57,0:52:57.01,Default,,0,0,0,,If there is a positive value, it
Dialogue: 0,0:52:57.01,0:52:58.02,Default,,0,0,0,,indicates that there is a
Dialogue: 0,0:52:58.02,0:52:59.82,Default,,0,0,0,,lengthening of the radius there.
Dialogue: 0,0:53:00.52,0:53:01.98,Default,,0,0,0,,If you have a negative value, it
Dialogue: 0,0:53:01.98,0:53:03.68,Default,,0,0,0,,indicates that it was shrunk
Dialogue: 0,0:53:03.68,0:53:03.91,Default,,0,0,0,,there.
Dialogue: 0,0:53:04.36,0:53:06.20,Default,,0,0,0,,But looking at this entire table
Dialogue: 0,0:53:06.33,0:53:07.92,Default,,0,0,0,,together, you can sort of get a
Dialogue: 0,0:53:07.92,0:53:10.59,Default,,0,0,0,,feel for where the bumps in the
Dialogue: 0,0:53:10.59,0:53:11.13,Default,,0,0,0,,lens are.
Dialogue: 0,0:53:12.24,0:53:14.72,Default,,0,0,0,,To apply distortion correction
Dialogue: 0,0:53:14.72,0:53:16.10,Default,,0,0,0,,to an image you'd begin with an
Dialogue: 0,0:53:16.10,0:53:18.40,Default,,0,0,0,,empty destination buffer and
Dialogue: 0,0:53:18.40,0:53:19.23,Default,,0,0,0,,then iterate through it
Dialogue: 0,0:53:19.23,0:53:21.32,Default,,0,0,0,,row-by-row and for each point
Dialogue: 0,0:53:21.81,0:53:22.42,Default,,0,0,0,,you would use the
Dialogue: 0,0:53:22.42,0:53:24.43,Default,,0,0,0,,lensDistortionLookupTable to
Dialogue: 0,0:53:24.43,0:53:26.19,Default,,0,0,0,,find the corresponding value in
Dialogue: 0,0:53:26.19,0:53:27.98,Default,,0,0,0,,the distorted image, and then
Dialogue: 0,0:53:28.02,0:53:29.30,Default,,0,0,0,,write that value to the right
Dialogue: 0,0:53:29.30,0:53:30.79,Default,,0,0,0,,position in your output buffer.
Dialogue: 0,0:53:31.56,0:53:33.54,Default,,0,0,0,,This is extremely tricky code to
Dialogue: 0,0:53:33.54,0:53:33.84,Default,,0,0,0,,write.
Dialogue: 0,0:53:34.08,0:53:34.79,Default,,0,0,0,,We know this.
Dialogue: 0,0:53:34.91,0:53:36.86,Default,,0,0,0,,So, we've provided a reference
Dialogue: 0,0:53:36.86,0:53:38.74,Default,,0,0,0,,implementation for you in
Dialogue: 0,0:53:38.74,0:53:41.44,Default,,0,0,0,,AVCameraCalibrationData.h. We
Dialogue: 0,0:53:41.52,0:53:44.82,Default,,0,0,0,,actually put code in a header
Dialogue: 0,0:53:44.82,0:53:45.18,Default,,0,0,0,,file.
Dialogue: 0,0:53:45.89,0:53:46.87,Default,,0,0,0,,It's all commented out.
Dialogue: 0,0:53:46.87,0:53:48.36,Default,,0,0,0,,It's a big objective C function.
Dialogue: 0,0:53:48.83,0:53:50.17,Default,,0,0,0,,Please take a look at it.
Dialogue: 0,0:53:50.17,0:53:53.15,Default,,0,0,0,,It describes how to rectify an
Dialogue: 0,0:53:53.15,0:53:55.63,Default,,0,0,0,,image or how to rewarp an image,
Dialogue: 0,0:53:55.86,0:53:57.36,Default,,0,0,0,,depending on which table you
Dialogue: 0,0:53:57.36,0:53:59.17,Default,,0,0,0,,pass it.
Dialogue: 0,0:53:59.69,0:54:00.56,Default,,0,0,0,,There is also, as you might
Dialogue: 0,0:54:00.56,0:54:02.46,Default,,0,0,0,,expect, the inverse of that
Dialogue: 0,0:54:02.46,0:54:04.49,Default,,0,0,0,,table, which describes how to go
Dialogue: 0,0:54:04.85,0:54:08.11,Default,,0,0,0,,from the warped back to
Dialogue: 0,0:54:08.31,0:54:08.79,Default,,0,0,0,,unwarped.
Dialogue: 0,0:54:10.82,0:54:12.27,Default,,0,0,0,,It's really easier to show you
Dialogue: 0,0:54:12.27,0:54:12.63,Default,,0,0,0,,with a demo.
Dialogue: 0,0:54:12.63,0:54:12.98,Default,,0,0,0,,Let's do a demo.
Dialogue: 0,0:54:18.29,0:54:20.08,Default,,0,0,0,,This will be our fourth and
Dialogue: 0,0:54:20.34,0:54:22.42,Default,,0,0,0,,final sample app of the day, and
Dialogue: 0,0:54:22.99,0:54:24.87,Default,,0,0,0,,it's called Straighten Up.
Dialogue: 0,0:54:25.08,0:54:26.18,Default,,0,0,0,,I bet you can guess what it
Dialogue: 0,0:54:26.22,0:54:26.53,Default,,0,0,0,,does.
Dialogue: 0,0:54:28.63,0:54:30.54,Default,,0,0,0,,This is an app that uses the
Dialogue: 0,0:54:30.54,0:54:33.08,Default,,0,0,0,,AVCameraCalibrationData,
Dialogue: 0,0:54:33.08,0:54:34.56,Default,,0,0,0,,specifically the lens distortion
Dialogue: 0,0:54:34.56,0:54:36.61,Default,,0,0,0,,characterizations, to make an
Dialogue: 0,0:54:36.61,0:54:37.85,Default,,0,0,0,,image rectilinear.
Dialogue: 0,0:54:38.90,0:54:41.58,Default,,0,0,0,,This morning I went outside and
Dialogue: 0,0:54:41.58,0:54:43.65,Default,,0,0,0,,I took a series of dual photos.
Dialogue: 0,0:54:44.05,0:54:44.98,Default,,0,0,0,,You can tell that they're dual
Dialogue: 0,0:54:44.98,0:54:46.55,Default,,0,0,0,,photos and that I was zoomed in
Dialogue: 0,0:54:46.55,0:54:48.09,Default,,0,0,0,,to 2X because of the black
Dialogue: 0,0:54:48.45,0:54:50.29,Default,,0,0,0,,border around them.
Dialogue: 0,0:54:50.29,0:54:52.45,Default,,0,0,0,,This one is, of course, from the
Dialogue: 0,0:54:52.58,0:54:55.95,Default,,0,0,0,,tele and this is the distorted
Dialogue: 0,0:54:55.95,0:54:56.41,Default,,0,0,0,,image.
Dialogue: 0,0:54:57.43,0:54:59.15,Default,,0,0,0,,Now, when I press the Undistort
Dialogue: 0,0:54:59.15,0:55:01.13,Default,,0,0,0,,button, you'll see something
Dialogue: 0,0:55:01.13,0:55:02.73,Default,,0,0,0,,that's a little bit subtle.
Dialogue: 0,0:55:07.05,0:55:08.16,Default,,0,0,0,,You can definitely see it, but
Dialogue: 0,0:55:08.16,0:55:08.84,Default,,0,0,0,,it's pretty subtle.
Dialogue: 0,0:55:09.34,0:55:12.68,Default,,0,0,0,,Typically telephoto lenses have
Dialogue: 0,0:55:12.68,0:55:13.99,Default,,0,0,0,,less curvature so they have
Dialogue: 0,0:55:14.11,0:55:15.96,Default,,0,0,0,,fewer radial distortions at the
Dialogue: 0,0:55:16.15,0:55:19.24,Default,,0,0,0,,edges than wide lenses.
Dialogue: 0,0:55:19.53,0:55:20.77,Default,,0,0,0,,I'll zoom in to a portion so you
Dialogue: 0,0:55:20.77,0:55:22.31,Default,,0,0,0,,can see the difference.
Dialogue: 0,0:55:22.66,0:55:24.49,Default,,0,0,0,,This is rectilinear, straight
Dialogue: 0,0:55:24.49,0:55:26.61,Default,,0,0,0,,lines are straight, and this is
Dialogue: 0,0:55:26.61,0:55:27.15,Default,,0,0,0,,distorted.
Dialogue: 0,0:55:28.01,0:55:29.98,Default,,0,0,0,,Now, if I go into the wide
Dialogue: 0,0:55:29.98,0:55:33.91,Default,,0,0,0,,image, again, we don't have the
Dialogue: 0,0:55:33.91,0:55:38.18,Default,,0,0,0,,corners, but you can see in the
Dialogue: 0,0:55:38.18,0:55:39.32,Default,,0,0,0,,image data that we do have
Dialogue: 0,0:55:39.32,0:55:41.52,Default,,0,0,0,,already that the distortions are
Dialogue: 0,0:55:41.52,0:55:42.21,Default,,0,0,0,,more prominent.
Dialogue: 0,0:55:43.66,0:55:46.53,Default,,0,0,0,,So distorted, undistorted.
Dialogue: 0,0:55:46.77,0:55:48.43,Default,,0,0,0,,Distorted, undistorted.
Dialogue: 0,0:55:48.43,0:55:49.47,Default,,0,0,0,,You can definitely see around
Dialogue: 0,0:55:49.47,0:55:51.28,Default,,0,0,0,,the edges that they are pulling
Dialogue: 0,0:55:51.28,0:55:51.85,Default,,0,0,0,,in more.
Dialogue: 0,0:55:54.42,0:55:55.41,Default,,0,0,0,,Undistorted.
Dialogue: 0,0:55:55.69,0:55:57.08,Default,,0,0,0,,Distorted, undistorted.
Dialogue: 0,0:55:59.15,0:55:59.45,Default,,0,0,0,,All right.
Dialogue: 0,0:55:59.57,0:55:59.98,Default,,0,0,0,,Back to slides.
Dialogue: 0,0:56:07.62,0:56:10.05,Default,,0,0,0,,Time for the wrap-up.
Dialogue: 0,0:56:10.05,0:56:13.12,Default,,0,0,0,,iPhone 7 Plus dual camera is not
Dialogue: 0,0:56:13.21,0:56:14.86,Default,,0,0,0,,a time-of-flight camera system.
Dialogue: 0,0:56:14.86,0:56:15.39,Default,,0,0,0,,It's a?
Dialogue: 0,0:56:16.41,0:56:17.13,Default,,0,0,0,,>> [Group] Disparity.
Dialogue: 0,0:56:17.13,0:56:18.13,Default,,0,0,0,,>> Disparity system.
Dialogue: 0,0:56:18.13,0:56:19.48,Default,,0,0,0,,If you leave with only one piece
Dialogue: 0,0:56:19.48,0:56:20.70,Default,,0,0,0,,of knowledge, it's that, and I
Dialogue: 0,0:56:20.70,0:56:22.19,Default,,0,0,0,,hope you know how disparity
Dialogue: 0,0:56:22.19,0:56:23.19,Default,,0,0,0,,differs from depth.
Dialogue: 0,0:56:24.68,0:56:25.72,Default,,0,0,0,,Also, the canonical
Dialogue: 0,0:56:25.72,0:56:27.15,Default,,0,0,0,,representation on our platform
Dialogue: 0,0:56:27.15,0:56:29.57,Default,,0,0,0,,for depth is AVDepthData.
Dialogue: 0,0:56:30.60,0:56:32.58,Default,,0,0,0,,We learned about intrinsics,
Dialogue: 0,0:56:32.58,0:56:34.90,Default,,0,0,0,,extrinsics, lens distortion
Dialogue: 0,0:56:34.90,0:56:35.34,Default,,0,0,0,,info.
Dialogue: 0,0:56:35.45,0:56:37.14,Default,,0,0,0,,These are all properties of an
Dialogue: 0,0:56:37.14,0:56:38.72,Default,,0,0,0,,AVCameraCalibrationData.
Dialogue: 0,0:56:40.38,0:56:41.13,Default,,0,0,0,,We learned about the
Dialogue: 0,0:56:41.13,0:56:43.56,Default,,0,0,0,,AVCaptureDepthDataOutput, and
Dialogue: 0,0:56:43.56,0:56:45.60,Default,,0,0,0,,that it provides streaming depth
Dialogue: 0,0:56:45.97,0:56:47.56,Default,,0,0,0,,which you can filter, or not.
Dialogue: 0,0:56:48.14,0:56:50.98,Default,,0,0,0,,And we learned that you can
Dialogue: 0,0:56:50.98,0:56:52.70,Default,,0,0,0,,capture photos using
Dialogue: 0,0:56:52.70,0:56:55.34,Default,,0,0,0,,AVCapturePhotoOutput and have
Dialogue: 0,0:56:55.34,0:56:56.95,Default,,0,0,0,,depth delivery enabled.
Dialogue: 0,0:56:58.62,0:57:00.45,Default,,0,0,0,,Finally, we spent a little bit
Dialogue: 0,0:57:00.45,0:57:01.70,Default,,0,0,0,,of time talking about the dual
Dialogue: 0,0:57:01.70,0:57:03.74,Default,,0,0,0,,camera, dual photo delivery
Dialogue: 0,0:57:04.07,0:57:05.90,Default,,0,0,0,,which produces a wide and a tele
Dialogue: 0,0:57:05.90,0:57:07.63,Default,,0,0,0,,for a single image with which
Dialogue: 0,0:57:07.63,0:57:09.05,Default,,0,0,0,,you can do interesting computer
Dialogue: 0,0:57:09.05,0:57:12.48,Default,,0,0,0,,vision tasks, and I hope you do.
Dialogue: 0,0:57:12.72,0:57:13.86,Default,,0,0,0,,We have three pieces of sample
Dialogue: 0,0:57:13.86,0:57:14.84,Default,,0,0,0,,code that are available right
Dialogue: 0,0:57:14.84,0:57:16.22,Default,,0,0,0,,now and are associated with this
Dialogue: 0,0:57:16.22,0:57:19.23,Default,,0,0,0,,session; AVCam, PhotoFilter and
Dialogue: 0,0:57:19.23,0:57:19.64,Default,,0,0,0,,Wiggle Me.
Dialogue: 0,0:57:21.18,0:57:23.08,Default,,0,0,0,,For more information, here is
Dialogue: 0,0:57:23.83,0:57:24.79,Default,,0,0,0,,the URL for the site.
Dialogue: 0,0:57:26.35,0:57:29.24,Default,,0,0,0,,And don't tune me out just yet.
Dialogue: 0,0:57:29.85,0:57:31.29,Default,,0,0,0,,Directly following this session
Dialogue: 0,0:57:31.29,0:57:32.41,Default,,0,0,0,,there is an informal
Dialogue: 0,0:57:32.41,0:57:35.05,Default,,0,0,0,,get-together for developers with
Dialogue: 0,0:57:35.05,0:57:36.60,Default,,0,0,0,,an interest in photography.
Dialogue: 0,0:57:37.02,0:57:38.95,Default,,0,0,0,,[Whispering] That's all of you.
Dialogue: 0,0:57:39.12,0:57:40.82,Default,,0,0,0,,So you can come and mingle with
Dialogue: 0,0:57:40.85,0:57:43.13,Default,,0,0,0,,members of the Apple Media
Dialogue: 0,0:57:43.13,0:57:44.33,Default,,0,0,0,,Technologies Group.
Dialogue: 0,0:57:45.44,0:57:46.30,Default,,0,0,0,,You can ask questions, of
Dialogue: 0,0:57:46.30,0:57:49.37,Default,,0,0,0,,course, or we can just talk and
Dialogue: 0,0:57:49.37,0:57:49.86,Default,,0,0,0,,socialize.
Dialogue: 0,0:57:50.43,0:57:52.29,Default,,0,0,0,,Tomorrow there is a sister
Dialogue: 0,0:57:52.29,0:57:54.44,Default,,0,0,0,,session at 11:00 a.m. where
Dialogue: 0,0:57:54.44,0:57:56.02,Default,,0,0,0,,you'll learn how to read and
Dialogue: 0,0:57:56.02,0:57:57.73,Default,,0,0,0,,manipulate the depth data that's
Dialogue: 0,0:57:57.73,0:57:58.69,Default,,0,0,0,,in image files.
Dialogue: 0,0:57:58.90,0:58:00.18,Default,,0,0,0,,Today we just briefly touched on
Dialogue: 0,0:58:00.18,0:58:01.45,Default,,0,0,0,,the surface of what you can do
Dialogue: 0,0:58:01.45,0:58:03.47,Default,,0,0,0,,with images with depth.
Dialogue: 0,0:58:04.05,0:58:05.53,Default,,0,0,0,,Tomorrow you get a whole host of
Dialogue: 0,0:58:05.53,0:58:05.94,Default,,0,0,0,,demos.
Dialogue: 0,0:58:05.94,0:58:06.95,Default,,0,0,0,,So I really hope you'll make
Dialogue: 0,0:58:06.95,0:58:07.96,Default,,0,0,0,,time for that tomorrow.
Dialogue: 0,0:58:08.35,0:58:10.71,Default,,0,0,0,,If you do, I'd deeply appreciate
Dialogue: 0,0:58:10.71,0:58:10.84,Default,,0,0,0,,it [group groaning].
Dialogue: 0,0:58:12.31,0:58:14.35,Default,,0,0,0,,And finally, I will be
Dialogue: 0,0:58:14.35,0:58:15.98,Default,,0,0,0,,presenting a dedicated session
Dialogue: 0,0:58:16.02,0:58:18.21,Default,,0,0,0,,on working with HEIF on Friday
Dialogue: 0,0:58:18.21,0:58:19.82,Default,,0,0,0,,morning that I also hope you'll
Dialogue: 0,0:58:20.63,0:58:21.09,Default,,0,0,0,,attend.
Dialogue: 0,0:58:21.38,0:58:24.14,Default,,0,0,0,,In that one I will delve deeply
Dialogue: 0,0:58:24.35,0:58:25.76,Default,,0,0,0,,into the AVCapturePhoto
Dialogue: 0,0:58:25.76,0:58:26.51,Default,,0,0,0,,interface.
Dialogue: 0,0:58:26.65,0:58:28.82,Default,,0,0,0,,Thank you, and enjoy the rest of
Dialogue: 0,0:58:28.82,0:58:28.94,Default,,0,0,0,,the show.
Dialogue: 0,0:58:29.52,0:58:32.50,Default,,0,0,0,,[ Applause ]
