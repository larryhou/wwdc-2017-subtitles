[Script Info]
; Script generated by FFmpeg/Lavc57.89.100
ScriptType: v4.00+
PlayResX: 384
PlayResY: 288

[V4+ Styles]
Format: Name, Fontname, Fontsize, PrimaryColour, SecondaryColour, OutlineColour, BackColour, Bold, Italic, Underline, StrikeOut, ScaleX, ScaleY, Spacing, Angle, BorderStyle, Outline, Shadow, Alignment, MarginL, MarginR, MarginV, Encoding
Style: Default,Arial,16,&Hffffff,&Hffffff,&H0,&H0,0,0,0,0,100,100,0,0,1,1,0,2,10,10,10,0

[Events]
Format: Layer, Start, End, Style, Name, MarginL, MarginR, MarginV, Effect, Text
Dialogue: 0,0:00:28.62,0:00:30.32,Default,,0,0,0,,My name is Krishna and I'm from
Dialogue: 0,0:00:30.32,0:00:31.56,Default,,0,0,0,,the Core ML Engineering team,
Dialogue: 0,0:00:32.03,0:00:33.84,Default,,0,0,0,,and today we're going to talk
Dialogue: 0,0:00:33.84,0:00:36.29,Default,,0,0,0,,about Core ML in Depth.
Dialogue: 0,0:00:37.18,0:00:39.05,Default,,0,0,0,,This year, we introduced Core
Dialogue: 0,0:00:39.10,0:00:39.37,Default,,0,0,0,,ML.
Dialogue: 0,0:00:39.85,0:00:41.78,Default,,0,0,0,,It's the easiest way for you to
Dialogue: 0,0:00:41.78,0:00:42.88,Default,,0,0,0,,integrate machine learning
Dialogue: 0,0:00:42.88,0:00:44.57,Default,,0,0,0,,models in your applications.
Dialogue: 0,0:00:45.57,0:00:49.27,Default,,0,0,0,,Core ML is available on macOS,
Dialogue: 0,0:00:49.27,0:00:51.94,Default,,0,0,0,,iOS, watchOS, and tvOS.
Dialogue: 0,0:00:52.10,0:00:55.79,Default,,0,0,0,,We had a session on Tuesday that
Dialogue: 0,0:00:55.79,0:00:56.62,Default,,0,0,0,,introduced Core ML.
Dialogue: 0,0:00:56.62,0:00:58.35,Default,,0,0,0,,For those of you that missed
Dialogue: 0,0:00:58.35,0:00:59.96,Default,,0,0,0,,that session, let's just take a
Dialogue: 0,0:00:59.96,0:01:01.73,Default,,0,0,0,,couple moments to recap some of
Dialogue: 0,0:01:01.73,0:01:02.82,Default,,0,0,0,,the key things we learned in
Dialogue: 0,0:01:02.82,0:01:03.35,Default,,0,0,0,,that session.
Dialogue: 0,0:01:04.38,0:01:06.37,Default,,0,0,0,,Now the first and the most
Dialogue: 0,0:01:06.37,0:01:08.93,Default,,0,0,0,,important thing about Core ML is
Dialogue: 0,0:01:08.93,0:01:09.98,Default,,0,0,0,,that you can think of your
Dialogue: 0,0:01:09.98,0:01:11.82,Default,,0,0,0,,machine learning models just
Dialogue: 0,0:01:11.82,0:01:14.08,Default,,0,0,0,,like code, and you interact with
Dialogue: 0,0:01:14.08,0:01:16.47,Default,,0,0,0,,them just like any other Swift
Dialogue: 0,0:01:17.71,0:01:17.88,Default,,0,0,0,,class.
Dialogue: 0,0:01:18.29,0:01:20.08,Default,,0,0,0,,Your workflow looks a bit like
Dialogue: 0,0:01:20.08,0:01:20.30,Default,,0,0,0,,this.
Dialogue: 0,0:01:21.14,0:01:22.06,Default,,0,0,0,,You start with a machine
Dialogue: 0,0:01:22.06,0:01:24.13,Default,,0,0,0,,learning model, you drag and
Dialogue: 0,0:01:24.13,0:01:26.90,Default,,0,0,0,,drop that model into Xcode,
Dialogue: 0,0:01:26.90,0:01:28.09,Default,,0,0,0,,Xcode will automatically
Dialogue: 0,0:01:28.09,0:01:30.00,Default,,0,0,0,,generate a Swift or an Objective
Dialogue: 0,0:01:30.00,0:01:31.96,Default,,0,0,0,,C interface for you to program
Dialogue: 0,0:01:31.96,0:01:32.90,Default,,0,0,0,,against that model.
Dialogue: 0,0:01:33.73,0:01:35.47,Default,,0,0,0,,You write your application code,
Dialogue: 0,0:01:35.47,0:01:36.35,Default,,0,0,0,,you build it.
Dialogue: 0,0:01:37.03,0:01:39.36,Default,,0,0,0,,Xcode will bundle both the code
Dialogue: 0,0:01:39.36,0:01:40.91,Default,,0,0,0,,as well as the model in your
Dialogue: 0,0:01:41.70,0:01:41.77,Default,,0,0,0,,app.
Dialogue: 0,0:01:43.02,0:01:45.04,Default,,0,0,0,,In that session, we also saw a
Dialogue: 0,0:01:45.04,0:01:46.62,Default,,0,0,0,,little demo of a flower
Dialogue: 0,0:01:46.62,0:01:47.04,Default,,0,0,0,,predictor.
Dialogue: 0,0:01:47.83,0:01:49.18,Default,,0,0,0,,It was an application where
Dialogue: 0,0:01:49.18,0:01:51.13,Default,,0,0,0,,given a picture, let's say this
Dialogue: 0,0:01:51.13,0:01:53.29,Default,,0,0,0,,pink rose, the application is
Dialogue: 0,0:01:53.33,0:01:54.59,Default,,0,0,0,,supposed to tell you what kind
Dialogue: 0,0:01:54.59,0:01:55.89,Default,,0,0,0,,of a flower it was and how
Dialogue: 0,0:01:55.89,0:01:56.96,Default,,0,0,0,,confident it was.
Dialogue: 0,0:01:58.53,0:02:00.59,Default,,0,0,0,,We saw that in order to use that
Dialogue: 0,0:02:00.59,0:02:02.03,Default,,0,0,0,,or build that application, it
Dialogue: 0,0:02:02.03,0:02:03.43,Default,,0,0,0,,just took a few lines of code.
Dialogue: 0,0:02:04.13,0:02:06.16,Default,,0,0,0,,One line of code to instantiate
Dialogue: 0,0:02:06.16,0:02:08.35,Default,,0,0,0,,the model, and one line of code
Dialogue: 0,0:02:08.59,0:02:10.61,Default,,0,0,0,,to make a prediction from that
Dialogue: 0,0:02:11.54,0:02:11.71,Default,,0,0,0,,model.
Dialogue: 0,0:02:11.84,0:02:13.43,Default,,0,0,0,,So in this session, we're going
Dialogue: 0,0:02:13.43,0:02:14.39,Default,,0,0,0,,to pick up from where we left
Dialogue: 0,0:02:14.39,0:02:15.79,Default,,0,0,0,,off and we're going to talk a
Dialogue: 0,0:02:15.79,0:02:16.66,Default,,0,0,0,,little bit more about the
Dialogue: 0,0:02:16.66,0:02:18.00,Default,,0,0,0,,different kinds of use cases,
Dialogue: 0,0:02:18.00,0:02:19.30,Default,,0,0,0,,all the cool stuff you guys can
Dialogue: 0,0:02:19.30,0:02:20.05,Default,,0,0,0,,do with Core ML.
Dialogue: 0,0:02:20.73,0:02:22.99,Default,,0,0,0,,We're then going to talk about
Dialogue: 0,0:02:22.99,0:02:25.09,Default,,0,0,0,,how Core ML is optimized for the
Dialogue: 0,0:02:25.09,0:02:26.74,Default,,0,0,0,,hardware on which it runs for or
Dialogue: 0,0:02:26.74,0:02:28.60,Default,,0,0,0,,runs on, and what that means for
Dialogue: 0,0:02:28.60,0:02:30.34,Default,,0,0,0,,you as a developer.
Dialogue: 0,0:02:31.00,0:02:32.55,Default,,0,0,0,,Finally, we're going to talk
Dialogue: 0,0:02:32.55,0:02:34.11,Default,,0,0,0,,about how you can obtain Core ML
Dialogue: 0,0:02:34.11,0:02:35.46,Default,,0,0,0,,models for use in all your
Dialogue: 0,0:02:35.46,0:02:36.06,Default,,0,0,0,,applications.
Dialogue: 0,0:02:36.26,0:02:38.04,Default,,0,0,0,,So it's going to be a fun
Dialogue: 0,0:02:38.09,0:02:39.39,Default,,0,0,0,,session with a couple demos,
Dialogue: 0,0:02:39.91,0:02:40.68,Default,,0,0,0,,let's get started.
Dialogue: 0,0:02:41.83,0:02:43.56,Default,,0,0,0,,So you've already seen an
Dialogue: 0,0:02:43.56,0:02:45.20,Default,,0,0,0,,example of an app that used
Dialogue: 0,0:02:45.20,0:02:46.66,Default,,0,0,0,,images, the flower predictor.
Dialogue: 0,0:02:47.30,0:02:48.43,Default,,0,0,0,,But with Core ML you can do a
Dialogue: 0,0:02:48.43,0:02:49.84,Default,,0,0,0,,lot more than just images.
Dialogue: 0,0:02:50.64,0:02:52.11,Default,,0,0,0,,You can work with gestures,
Dialogue: 0,0:02:52.46,0:02:53.97,Default,,0,0,0,,let's say handwriting detection
Dialogue: 0,0:02:53.97,0:02:54.59,Default,,0,0,0,,on the watch.
Dialogue: 0,0:02:55.77,0:02:57.18,Default,,0,0,0,,You can work with video, let's
Dialogue: 0,0:02:57.18,0:02:58.19,Default,,0,0,0,,say you want to do credit card
Dialogue: 0,0:02:58.19,0:02:58.61,Default,,0,0,0,,detection.
Dialogue: 0,0:02:59.88,0:03:02.35,Default,,0,0,0,,You can work with audio, and you
Dialogue: 0,0:03:02.35,0:03:04.02,Default,,0,0,0,,can even work with text.
Dialogue: 0,0:03:05.37,0:03:07.09,Default,,0,0,0,,Now by taking inputs of all of
Dialogue: 0,0:03:07.09,0:03:08.81,Default,,0,0,0,,these different types, you can
Dialogue: 0,0:03:08.81,0:03:10.14,Default,,0,0,0,,build a large variety of
Dialogue: 0,0:03:10.14,0:03:10.88,Default,,0,0,0,,applications.
Dialogue: 0,0:03:12.31,0:03:13.46,Default,,0,0,0,,Let's say you want to build an
Dialogue: 0,0:03:13.46,0:03:14.79,Default,,0,0,0,,application that as you type
Dialogue: 0,0:03:14.79,0:03:16.76,Default,,0,0,0,,some text it tells you if it's a
Dialogue: 0,0:03:16.76,0:03:19.12,Default,,0,0,0,,happy text or a sad text or a
Dialogue: 0,0:03:19.12,0:03:20.43,Default,,0,0,0,,passive aggressive text or
Dialogue: 0,0:03:20.43,0:03:21.11,Default,,0,0,0,,angry.
Dialogue: 0,0:03:22.21,0:03:23.25,Default,,0,0,0,,You can do that with Sentiment
Dialogue: 0,0:03:23.25,0:03:25.19,Default,,0,0,0,,Analysis, and we'll see a little
Dialogue: 0,0:03:25.38,0:03:27.54,Default,,0,0,0,,demo of that today.
Dialogue: 0,0:03:27.71,0:03:29.03,Default,,0,0,0,,You can -- with Style Transfer
Dialogue: 0,0:03:29.03,0:03:30.37,Default,,0,0,0,,you can even make pictures of
Dialogue: 0,0:03:30.37,0:03:31.76,Default,,0,0,0,,your family look like Vincent
Dialogue: 0,0:03:31.76,0:03:32.56,Default,,0,0,0,,Van Gogh paintings.
Dialogue: 0,0:03:34.09,0:03:35.40,Default,,0,0,0,,And with Gesture Recognition,
Dialogue: 0,0:03:35.66,0:03:37.22,Default,,0,0,0,,you can have a whole new way to
Dialogue: 0,0:03:37.22,0:03:38.06,Default,,0,0,0,,take inputs to your
Dialogue: 0,0:03:38.06,0:03:38.75,Default,,0,0,0,,applications.
Dialogue: 0,0:03:39.63,0:03:41.31,Default,,0,0,0,,Now all of these are amazing
Dialogue: 0,0:03:41.31,0:03:43.57,Default,,0,0,0,,possibilities because with Core
Dialogue: 0,0:03:43.57,0:03:45.94,Default,,0,0,0,,ML you can use a large variety
Dialogue: 0,0:03:45.94,0:03:46.56,Default,,0,0,0,,of models.
Dialogue: 0,0:03:47.66,0:03:49.12,Default,,0,0,0,,You can use Classical Machine
Dialogue: 0,0:03:49.12,0:03:50.62,Default,,0,0,0,,Learning Models like Generalized
Dialogue: 0,0:03:50.62,0:03:52.12,Default,,0,0,0,,Linear Models, Trees, and
Dialogue: 0,0:03:52.18,0:03:53.18,Default,,0,0,0,,Support Vector Machines.
Dialogue: 0,0:03:53.90,0:03:55.63,Default,,0,0,0,,Now these ones are great because
Dialogue: 0,0:03:55.69,0:03:57.66,Default,,0,0,0,,they are small, you can make
Dialogue: 0,0:03:57.66,0:03:59.00,Default,,0,0,0,,fast predictions with them and
Dialogue: 0,0:03:59.00,0:03:59.91,Default,,0,0,0,,they are on any device.
Dialogue: 0,0:04:00.94,0:04:03.12,Default,,0,0,0,,But you can also work with a
Dialogue: 0,0:04:03.12,0:04:04.80,Default,,0,0,0,,large variety of Neural
Dialogue: 0,0:04:05.20,0:04:05.58,Default,,0,0,0,,Networks.
Dialogue: 0,0:04:05.58,0:04:07.17,Default,,0,0,0,,We have support for over 30
Dialogue: 0,0:04:07.17,0:04:08.59,Default,,0,0,0,,different layer types and that's
Dialogue: 0,0:04:08.78,0:04:09.19,Default,,0,0,0,,huge.
Dialogue: 0,0:04:09.99,0:04:10.95,Default,,0,0,0,,You can do things like
Dialogue: 0,0:04:10.95,0:04:12.30,Default,,0,0,0,,Feedforward and Convolution
Dialogue: 0,0:04:12.30,0:04:13.52,Default,,0,0,0,,Linear Networks for all your
Dialogue: 0,0:04:13.52,0:04:14.62,Default,,0,0,0,,image and video-based
Dialogue: 0,0:04:14.62,0:04:16.61,Default,,0,0,0,,applications, and you can also
Dialogue: 0,0:04:16.61,0:04:17.92,Default,,0,0,0,,do things like Recurrent Neural
Dialogue: 0,0:04:17.92,0:04:19.61,Default,,0,0,0,,Networks or LSDMs for all of
Dialogue: 0,0:04:19.61,0:04:21.11,Default,,0,0,0,,your text-based applications.
Dialogue: 0,0:04:22.02,0:04:23.53,Default,,0,0,0,,We'll take a look at Recurrent
Dialogue: 0,0:04:23.53,0:04:24.95,Default,,0,0,0,,Neural Networks in today's
Dialogue: 0,0:04:25.67,0:04:25.99,Default,,0,0,0,,session.
Dialogue: 0,0:04:26.64,0:04:29.39,Default,,0,0,0,,In fact, with Core ML you can
Dialogue: 0,0:04:29.39,0:04:31.02,Default,,0,0,0,,also combine models of various
Dialogue: 0,0:04:31.02,0:04:31.70,Default,,0,0,0,,different types.
Dialogue: 0,0:04:31.70,0:04:33.65,Default,,0,0,0,,So you can take, let's say, a
Dialogue: 0,0:04:33.65,0:04:35.06,Default,,0,0,0,,Neural Network and combine it
Dialogue: 0,0:04:35.06,0:04:37.13,Default,,0,0,0,,with a Tree and then you can get
Dialogue: 0,0:04:37.13,0:04:38.28,Default,,0,0,0,,one big model with that.
Dialogue: 0,0:04:38.62,0:04:39.82,Default,,0,0,0,,So this concept is called a
Dialogue: 0,0:04:39.82,0:04:40.37,Default,,0,0,0,,Pipeline.
Dialogue: 0,0:04:40.79,0:04:44.71,Default,,0,0,0,,But most importantly for you as
Dialogue: 0,0:04:44.71,0:04:46.17,Default,,0,0,0,,a developer, we want you to
Dialogue: 0,0:04:46.17,0:04:47.64,Default,,0,0,0,,focus on the code that you're
Dialogue: 0,0:04:47.64,0:04:49.31,Default,,0,0,0,,writing in your apps and not on
Dialogue: 0,0:04:49.31,0:04:50.80,Default,,0,0,0,,the specific complexities of the
Dialogue: 0,0:04:50.80,0:04:51.83,Default,,0,0,0,,model that's running there.
Dialogue: 0,0:04:52.43,0:04:56.00,Default,,0,0,0,,And we achieve that by giving
Dialogue: 0,0:04:56.00,0:04:57.60,Default,,0,0,0,,you a functional abstraction
Dialogue: 0,0:04:57.60,0:04:58.24,Default,,0,0,0,,viewer models.
Dialogue: 0,0:04:58.79,0:05:00.45,Default,,0,0,0,,So all you need to care is your
Dialogue: 0,0:05:00.45,0:05:02.30,Default,,0,0,0,,models are prediction functions
Dialogue: 0,0:05:02.30,0:05:04.33,Default,,0,0,0,,that take in some inputs and
Dialogue: 0,0:05:04.33,0:05:05.29,Default,,0,0,0,,give out some outputs.
Dialogue: 0,0:05:06.19,0:05:08.26,Default,,0,0,0,,And these inputs and outputs can
Dialogue: 0,0:05:08.26,0:05:09.72,Default,,0,0,0,,be of five different types;
Dialogue: 0,0:05:10.41,0:05:13.73,Default,,0,0,0,,numeric, categorical, images,
Dialogue: 0,0:05:14.38,0:05:16.08,Default,,0,0,0,,arrays, and dictionaries.
Dialogue: 0,0:05:17.48,0:05:19.09,Default,,0,0,0,,Now let's just take a little
Dialogue: 0,0:05:19.09,0:05:20.09,Default,,0,0,0,,look at each of these five
Dialogue: 0,0:05:20.14,0:05:21.62,Default,,0,0,0,,different types.
Dialogue: 0,0:05:22.14,0:05:23.99,Default,,0,0,0,,So numerics and categories are
Dialogue: 0,0:05:23.99,0:05:25.96,Default,,0,0,0,,exposed to you in Swift as
Dialogue: 0,0:05:26.06,0:05:28.11,Default,,0,0,0,,doubles, integers or strings.
Dialogue: 0,0:05:28.11,0:05:29.13,Default,,0,0,0,,So it's very natural.
Dialogue: 0,0:05:30.04,0:05:31.90,Default,,0,0,0,,We have a little example of an
Dialogue: 0,0:05:31.90,0:05:33.31,Default,,0,0,0,,application that uses these two
Dialogue: 0,0:05:33.31,0:05:35.03,Default,,0,0,0,,types on developer.apple.com.
Dialogue: 0,0:05:35.56,0:05:37.10,Default,,0,0,0,,It's an application that does
Dialogue: 0,0:05:37.10,0:05:38.09,Default,,0,0,0,,house price prediction.
Dialogue: 0,0:05:39.00,0:05:40.16,Default,,0,0,0,,So some of the inputs to this
Dialogue: 0,0:05:40.16,0:05:41.94,Default,,0,0,0,,model are numeric, that is
Dialogue: 0,0:05:41.94,0:05:43.17,Default,,0,0,0,,they're continuous so you can go
Dialogue: 0,0:05:43.17,0:05:44.71,Default,,0,0,0,,from zero to infinity.
Dialogue: 0,0:05:45.61,0:05:47.69,Default,,0,0,0,,And some of them are categorical
Dialogue: 0,0:05:47.81,0:05:50.20,Default,,0,0,0,,or discrete, so you go zero, 1,
Dialogue: 0,0:05:50.25,0:05:52.94,Default,,0,0,0,,2, 3, 4.
Dialogue: 0,0:05:53.15,0:05:54.57,Default,,0,0,0,,You've already seen an example
Dialogue: 0,0:05:54.57,0:05:55.38,Default,,0,0,0,,of using images.
Dialogue: 0,0:05:55.95,0:05:57.23,Default,,0,0,0,,Now these images are exposed to
Dialogue: 0,0:05:57.23,0:05:58.88,Default,,0,0,0,,you as CVPixelBuffers.
Dialogue: 0,0:05:59.67,0:06:02.79,Default,,0,0,0,,For the more complex things like
Dialogue: 0,0:06:02.86,0:06:04.46,Default,,0,0,0,,gestures, audio and video, we
Dialogue: 0,0:06:04.46,0:06:06.29,Default,,0,0,0,,have a new type called
Dialogue: 0,0:06:06.29,0:06:08.93,Default,,0,0,0,,MLMultiArray to encapsulate a
Dialogue: 0,0:06:08.93,0:06:10.13,Default,,0,0,0,,multidimensional array.
Dialogue: 0,0:06:10.67,0:06:13.36,Default,,0,0,0,,And for a lot of your text-based
Dialogue: 0,0:06:13.36,0:06:14.80,Default,,0,0,0,,applications, you'll be
Dialogue: 0,0:06:14.80,0:06:16.14,Default,,0,0,0,,interacting with dictionaries.
Dialogue: 0,0:06:16.87,0:06:17.76,Default,,0,0,0,,Here are the dictionaries.
Dialogue: 0,0:06:17.76,0:06:19.17,Default,,0,0,0,,The keys are either strings or
Dialogue: 0,0:06:19.17,0:06:21.10,Default,,0,0,0,,integers, and the values are
Dialogue: 0,0:06:21.16,0:06:21.49,Default,,0,0,0,,doubles.
Dialogue: 0,0:06:22.75,0:06:24.54,Default,,0,0,0,,Let's take a little look at
Dialogue: 0,0:06:24.54,0:06:26.14,Default,,0,0,0,,using Text and working with
Dialogue: 0,0:06:26.14,0:06:26.65,Default,,0,0,0,,Dictionaries.
Dialogue: 0,0:06:27.33,0:06:30.66,Default,,0,0,0,,And we're going to do that with
Dialogue: 0,0:06:30.66,0:06:32.45,Default,,0,0,0,,an application of Sentiment
Dialogue: 0,0:06:32.45,0:06:32.95,Default,,0,0,0,,Analysis.
Dialogue: 0,0:06:33.89,0:06:35.21,Default,,0,0,0,,Now I've always wanted this app
Dialogue: 0,0:06:35.25,0:06:36.97,Default,,0,0,0,,where if I type some text I want
Dialogue: 0,0:06:36.97,0:06:38.69,Default,,0,0,0,,the UI to pop and reflect the
Dialogue: 0,0:06:38.69,0:06:39.50,Default,,0,0,0,,mood that I'm in.
Dialogue: 0,0:06:40.01,0:06:42.09,Default,,0,0,0,,So if I say Core ML is awesome!
Dialogue: 0,0:06:42.09,0:06:42.93,Default,,0,0,0,,I love using it!
Dialogue: 0,0:06:43.14,0:06:44.29,Default,,0,0,0,,I want it to go green and I
Dialogue: 0,0:06:44.29,0:06:47.23,Default,,0,0,0,,want, like, a happy face.
Dialogue: 0,0:06:47.23,0:06:49.01,Default,,0,0,0,,And if I talk to you about, say,
Dialogue: 0,0:06:49.01,0:06:49.94,Default,,0,0,0,,how bad the lunch was.
Dialogue: 0,0:06:49.94,0:06:50.94,Default,,0,0,0,,Like, today's lunch was
Dialogue: 0,0:06:50.94,0:06:52.04,Default,,0,0,0,,disappointing and sad.
Dialogue: 0,0:06:52.04,0:06:52.78,Default,,0,0,0,,I want it to go red.
Dialogue: 0,0:06:52.78,0:06:55.59,Default,,0,0,0,,So that's what I want to do.
Dialogue: 0,0:06:55.92,0:06:57.92,Default,,0,0,0,,So what does it take to build an
Dialogue: 0,0:06:57.92,0:06:58.90,Default,,0,0,0,,application like this?
Dialogue: 0,0:06:59.47,0:07:00.49,Default,,0,0,0,,So I'm going to start with an
Dialogue: 0,0:07:00.49,0:07:02.46,Default,,0,0,0,,app shell where the user can
Dialogue: 0,0:07:02.46,0:07:03.23,Default,,0,0,0,,type in some text.
Dialogue: 0,0:07:04.68,0:07:05.99,Default,,0,0,0,,As soon as the user hits the
Dialogue: 0,0:07:05.99,0:07:07.66,Default,,0,0,0,,space bar, I'm going to take all
Dialogue: 0,0:07:07.66,0:07:09.33,Default,,0,0,0,,of that text, give it to a
Dialogue: 0,0:07:09.33,0:07:11.09,Default,,0,0,0,,machine learning model, and get
Dialogue: 0,0:07:11.09,0:07:12.52,Default,,0,0,0,,back a sentiment prediction.
Dialogue: 0,0:07:13.62,0:07:14.78,Default,,0,0,0,,So the sentiment prediction is
Dialogue: 0,0:07:14.78,0:07:16.32,Default,,0,0,0,,either going to be happy,
Dialogue: 0,0:07:16.32,0:07:17.44,Default,,0,0,0,,neutral or sad.
Dialogue: 0,0:07:18.53,0:07:19.73,Default,,0,0,0,,As soon as I get back this
Dialogue: 0,0:07:19.78,0:07:21.14,Default,,0,0,0,,prediction, I'm going to go back
Dialogue: 0,0:07:21.14,0:07:23.51,Default,,0,0,0,,and quickly update the UI to
Dialogue: 0,0:07:23.51,0:07:24.50,Default,,0,0,0,,reflect the mode I'm in.
Dialogue: 0,0:07:25.67,0:07:26.94,Default,,0,0,0,,The most important thing for you
Dialogue: 0,0:07:26.94,0:07:28.43,Default,,0,0,0,,to note is all of this can
Dialogue: 0,0:07:28.43,0:07:30.63,Default,,0,0,0,,happen real time on the device
Dialogue: 0,0:07:30.63,0:07:32.53,Default,,0,0,0,,as the user is typing, so it
Dialogue: 0,0:07:32.53,0:07:34.16,Default,,0,0,0,,makes for an amazing experience.
Dialogue: 0,0:07:34.77,0:07:37.47,Default,,0,0,0,,So let's see how you can go
Dialogue: 0,0:07:37.47,0:07:38.50,Default,,0,0,0,,ahead and build that app.
Dialogue: 0,0:07:39.32,0:07:40.44,Default,,0,0,0,,Well, the most important thing
Dialogue: 0,0:07:40.44,0:07:42.80,Default,,0,0,0,,here is the model, and for this
Dialogue: 0,0:07:42.80,0:07:43.84,Default,,0,0,0,,we're going to use a Sentiment
Dialogue: 0,0:07:43.84,0:07:44.58,Default,,0,0,0,,Analysis model.
Dialogue: 0,0:07:45.28,0:07:46.21,Default,,0,0,0,,But for this sent Sentiment
Dialogue: 0,0:07:46.21,0:07:47.29,Default,,0,0,0,,Analysis model is going to
Dialogue: 0,0:07:47.29,0:07:49.41,Default,,0,0,0,,operate on word counts not on
Dialogue: 0,0:07:49.41,0:07:50.85,Default,,0,0,0,,the raw text, but on word
Dialogue: 0,0:07:50.85,0:07:51.35,Default,,0,0,0,,counts.
Dialogue: 0,0:07:52.07,0:07:53.37,Default,,0,0,0,,So these word counts will be
Dialogue: 0,0:07:53.37,0:07:54.91,Default,,0,0,0,,represented as dictionaries
Dialogue: 0,0:07:55.88,0:07:57.97,Default,,0,0,0,,where the keys are the words and
Dialogue: 0,0:07:57.97,0:07:59.33,Default,,0,0,0,,the values are the number of
Dialogue: 0,0:07:59.33,0:08:00.61,Default,,0,0,0,,times that word appears in a
Dialogue: 0,0:08:00.65,0:08:01.01,Default,,0,0,0,,sentence.
Dialogue: 0,0:08:01.80,0:08:03.45,Default,,0,0,0,,So Core ML is awesome.
Dialogue: 0,0:08:03.45,0:08:04.28,Default,,0,0,0,,I love using it.
Dialogue: 0,0:08:04.28,0:08:05.66,Default,,0,0,0,,Translates to a dictionary that
Dialogue: 0,0:08:05.66,0:08:06.47,Default,,0,0,0,,looks a bit like this.
Dialogue: 0,0:08:07.82,0:08:09.38,Default,,0,0,0,,So once I have my Word Counts I
Dialogue: 0,0:08:09.47,0:08:10.86,Default,,0,0,0,,can pass that to my Sentiment
Dialogue: 0,0:08:10.86,0:08:12.80,Default,,0,0,0,,Analysis model and I can get
Dialogue: 0,0:08:12.80,0:08:13.45,Default,,0,0,0,,back a prediction.
Dialogue: 0,0:08:13.98,0:08:16.36,Default,,0,0,0,,In this case it's "happy".
Dialogue: 0,0:08:16.56,0:08:17.76,Default,,0,0,0,,But you might wonder, okay, how
Dialogue: 0,0:08:17.76,0:08:19.35,Default,,0,0,0,,do I go for my raw text to word
Dialogue: 0,0:08:19.35,0:08:19.79,Default,,0,0,0,,count.
Dialogue: 0,0:08:20.49,0:08:21.62,Default,,0,0,0,,Well, you might have already
Dialogue: 0,0:08:21.62,0:08:23.34,Default,,0,0,0,,seen the session on NLP, but you
Dialogue: 0,0:08:23.42,0:08:25.36,Default,,0,0,0,,can use the already existing
Dialogue: 0,0:08:25.36,0:08:27.65,Default,,0,0,0,,tools in the NSLinguisticTagger
Dialogue: 0,0:08:27.78,0:08:29.37,Default,,0,0,0,,to tokenize and count number of
Dialogue: 0,0:08:29.37,0:08:29.70,Default,,0,0,0,,words.
Dialogue: 0,0:08:30.20,0:08:32.86,Default,,0,0,0,,So I'll use NLP to preprocess my
Dialogue: 0,0:08:32.86,0:08:34.27,Default,,0,0,0,,texts, specifically the
Dialogue: 0,0:08:34.27,0:08:36.19,Default,,0,0,0,,NSLinguisticTagger, and then I'm
Dialogue: 0,0:08:36.19,0:08:37.50,Default,,0,0,0,,going to get my word counts
Dialogue: 0,0:08:37.95,0:08:39.33,Default,,0,0,0,,which I'll then give to a model
Dialogue: 0,0:08:39.70,0:08:40.73,Default,,0,0,0,,and get a prediction out of it.
Dialogue: 0,0:08:41.84,0:08:43.31,Default,,0,0,0,,So with that, you can build an
Dialogue: 0,0:08:43.31,0:08:44.24,Default,,0,0,0,,application like this.
Dialogue: 0,0:08:44.77,0:08:46.24,Default,,0,0,0,,But let's not just talk about
Dialogue: 0,0:08:46.24,0:08:47.20,Default,,0,0,0,,it, let's go ahead and do it.
Dialogue: 0,0:08:48.38,0:08:51.99,Default,,0,0,0,,So I'm going to walk over and
Dialogue: 0,0:08:51.99,0:08:56.91,Default,,0,0,0,,open up Xcode.
Dialogue: 0,0:08:57.04,0:08:59.43,Default,,0,0,0,,So what I have here is Xcode and
Dialogue: 0,0:08:59.43,0:09:00.04,Default,,0,0,0,,a simulator.
Dialogue: 0,0:09:00.74,0:09:02.19,Default,,0,0,0,,The simulator is now running an
Dialogue: 0,0:09:02.19,0:09:02.63,Default,,0,0,0,,app shell.
Dialogue: 0,0:09:03.15,0:09:04.11,Default,,0,0,0,,The app shell doesn't have the
Dialogue: 0,0:09:04.11,0:09:05.31,Default,,0,0,0,,model in there, so if I type
Dialogue: 0,0:09:05.31,0:09:07.81,Default,,0,0,0,,something, let's say, Core ML is
Dialogue: 0,0:09:09.04,0:09:11.83,Default,,0,0,0,,amazing, amazing fun, nothing
Dialogue: 0,0:09:11.83,0:09:13.27,Default,,0,0,0,,really happens to the UI.
Dialogue: 0,0:09:13.81,0:09:14.95,Default,,0,0,0,,So what we're going to do right
Dialogue: 0,0:09:14.95,0:09:16.38,Default,,0,0,0,,now is we're going to go ahead
Dialogue: 0,0:09:16.38,0:09:17.42,Default,,0,0,0,,and incorporate the machine
Dialogue: 0,0:09:17.42,0:09:19.22,Default,,0,0,0,,learning model in here so that
Dialogue: 0,0:09:19.22,0:09:20.53,Default,,0,0,0,,this app is going to become much
Dialogue: 0,0:09:20.53,0:09:21.22,Default,,0,0,0,,more vibrant.
Dialogue: 0,0:09:21.22,0:09:24.30,Default,,0,0,0,,So the first thing I'm going to
Dialogue: 0,0:09:24.30,0:09:27.72,Default,,0,0,0,,do is open up Finder and drag
Dialogue: 0,0:09:27.72,0:09:29.29,Default,,0,0,0,,the Sentiment Analysis model
Dialogue: 0,0:09:29.53,0:09:30.25,Default,,0,0,0,,into Xcode.
Dialogue: 0,0:09:30.79,0:09:33.73,Default,,0,0,0,,Let's go take a look at what
Dialogue: 0,0:09:33.73,0:09:34.35,Default,,0,0,0,,this model is.
Dialogue: 0,0:09:35.28,0:09:38.25,Default,,0,0,0,,So as you can see, this is a
Dialogue: 0,0:09:38.25,0:09:39.49,Default,,0,0,0,,Sentiment Analysis model.
Dialogue: 0,0:09:40.21,0:09:41.26,Default,,0,0,0,,The type of this model is a
Dialogue: 0,0:09:41.26,0:09:43.03,Default,,0,0,0,,Pipeline Classifier, so it does
Dialogue: 0,0:09:43.03,0:09:44.21,Default,,0,0,0,,a couple different things before
Dialogue: 0,0:09:44.21,0:09:45.33,Default,,0,0,0,,it gives the final prediction.
Dialogue: 0,0:09:46.69,0:09:49.14,Default,,0,0,0,,It's only 167 kilobytes, so it's
Dialogue: 0,0:09:49.14,0:09:49.88,Default,,0,0,0,,pretty tiny.
Dialogue: 0,0:09:51.26,0:09:53.46,Default,,0,0,0,,And the inputs to this model are
Dialogue: 0,0:09:53.46,0:09:55.36,Default,,0,0,0,,word counts, and the word counts
Dialogue: 0,0:09:55.46,0:09:58.48,Default,,0,0,0,,are dictionaries where the key
Dialogue: 0,0:09:58.48,0:09:59.58,Default,,0,0,0,,is the word and the value is the
Dialogue: 0,0:09:59.58,0:10:00.80,Default,,0,0,0,,number of time that word
Dialogue: 0,0:10:00.80,0:10:01.19,Default,,0,0,0,,appeared.
Dialogue: 0,0:10:01.92,0:10:03.21,Default,,0,0,0,,And I get two outputs from this
Dialogue: 0,0:10:03.21,0:10:05.56,Default,,0,0,0,,model, a Sentiment Label, that's
Dialogue: 0,0:10:05.56,0:10:06.37,Default,,0,0,0,,one of two things.
Dialogue: 0,0:10:06.62,0:10:08.68,Default,,0,0,0,,It's either good or bad.
Dialogue: 0,0:10:08.68,0:10:11.55,Default,,0,0,0,,And a Sentiment Score, which is
Dialogue: 0,0:10:11.55,0:10:13.70,Default,,0,0,0,,a probability associated with
Dialogue: 0,0:10:13.70,0:10:15.33,Default,,0,0,0,,the good sentiment or the bad
Dialogue: 0,0:10:15.33,0:10:15.72,Default,,0,0,0,,sentiment.
Dialogue: 0,0:10:16.76,0:10:17.66,Default,,0,0,0,,So that's a dictionary.
Dialogue: 0,0:10:18.35,0:10:19.65,Default,,0,0,0,,So what I'm going to use in this
Dialogue: 0,0:10:19.65,0:10:20.93,Default,,0,0,0,,application is I'm going to use
Dialogue: 0,0:10:20.93,0:10:23.15,Default,,0,0,0,,the Sentiment Score to determine
Dialogue: 0,0:10:23.42,0:10:25.31,Default,,0,0,0,,within a range of zero to 1 how
Dialogue: 0,0:10:25.31,0:10:26.87,Default,,0,0,0,,nice this text was, and that's
Dialogue: 0,0:10:26.87,0:10:27.94,Default,,0,0,0,,what I'm going to be using to
Dialogue: 0,0:10:27.94,0:10:29.43,Default,,0,0,0,,update my UI.
Dialogue: 0,0:10:30.72,0:10:32.85,Default,,0,0,0,,So let me go ahead and include
Dialogue: 0,0:10:33.20,0:10:34.79,Default,,0,0,0,,this model in the target of my
Dialogue: 0,0:10:34.79,0:10:37.77,Default,,0,0,0,,application, and then Xcode will
Dialogue: 0,0:10:37.77,0:10:39.07,Default,,0,0,0,,automatically generate a nice
Dialogue: 0,0:10:39.07,0:10:39.96,Default,,0,0,0,,interface for me.
Dialogue: 0,0:10:40.62,0:10:41.71,Default,,0,0,0,,So I can go back to my
Dialogue: 0,0:10:41.71,0:10:43.47,Default,,0,0,0,,ViewController and now I'm going
Dialogue: 0,0:10:43.47,0:10:44.54,Default,,0,0,0,,to implement the logic to
Dialogue: 0,0:10:44.90,0:10:46.00,Default,,0,0,0,,incorporate this Machine
Dialogue: 0,0:10:46.00,0:10:46.87,Default,,0,0,0,,Learning Model in there.
Dialogue: 0,0:10:47.57,0:10:48.57,Default,,0,0,0,,So for that, I'm going to
Dialogue: 0,0:10:48.57,0:10:50.24,Default,,0,0,0,,implement this function, predict
Dialogue: 0,0:10:50.24,0:10:51.89,Default,,0,0,0,,SentimentScoreFromRawText.
Dialogue: 0,0:10:52.24,0:10:53.46,Default,,0,0,0,,So this function is going to
Dialogue: 0,0:10:53.46,0:10:54.67,Default,,0,0,0,,take a sentence which is the
Dialogue: 0,0:10:54.67,0:10:55.82,Default,,0,0,0,,entire string.
Dialogue: 0,0:10:56.53,0:10:57.82,Default,,0,0,0,,It gets called every time the
Dialogue: 0,0:10:57.82,0:11:00.01,Default,,0,0,0,,user types a space, and what it
Dialogue: 0,0:11:00.01,0:11:01.45,Default,,0,0,0,,returns is a double value
Dialogue: 0,0:11:01.79,0:11:03.41,Default,,0,0,0,,between zero and 1, where zero
Dialogue: 0,0:11:03.41,0:11:05.22,Default,,0,0,0,,is really, really sad and 1 is
Dialogue: 0,0:11:05.22,0:11:05.99,Default,,0,0,0,,really, really happy.
Dialogue: 0,0:11:07.91,0:11:09.09,Default,,0,0,0,,So the first thing I want to do
Dialogue: 0,0:11:09.09,0:11:10.26,Default,,0,0,0,,is I'm going to instantiate this
Dialogue: 0,0:11:10.26,0:11:11.75,Default,,0,0,0,,model, and I can simply do that
Dialogue: 0,0:11:11.75,0:11:13.24,Default,,0,0,0,,by saying let model =
Dialogue: 0,0:11:13.29,0:11:14.29,Default,,0,0,0,,SentimentAnalysis.
Dialogue: 0,0:11:15.38,0:11:16.96,Default,,0,0,0,,And then I'm going to predict
Dialogue: 0,0:11:16.96,0:11:19.16,Default,,0,0,0,,use this model to make this
Dialogue: 0,0:11:19.19,0:11:19.66,Default,,0,0,0,,prediction.
Dialogue: 0,0:11:19.98,0:11:21.08,Default,,0,0,0,,But as you can see, the input
Dialogue: 0,0:11:21.08,0:11:22.68,Default,,0,0,0,,here is a sentence but what I
Dialogue: 0,0:11:22.68,0:11:24.12,Default,,0,0,0,,really want is a word count.
Dialogue: 0,0:11:25.00,0:11:26.15,Default,,0,0,0,,So I've already implemented this
Dialogue: 0,0:11:26.15,0:11:26.90,Default,,0,0,0,,function called
Dialogue: 0,0:11:26.90,0:11:28.11,Default,,0,0,0,,tokenizeAndCountWords.
Dialogue: 0,0:11:28.55,0:11:29.54,Default,,0,0,0,,This function uses the
Dialogue: 0,0:11:29.54,0:11:31.18,Default,,0,0,0,,NSLinguisticTagger to tokenize
Dialogue: 0,0:11:31.18,0:11:32.26,Default,,0,0,0,,the sentence and then count the
Dialogue: 0,0:11:32.26,0:11:33.88,Default,,0,0,0,,number of tokens in that
Dialogue: 0,0:11:33.88,0:11:34.30,Default,,0,0,0,,sentence.
Dialogue: 0,0:11:34.64,0:11:35.70,Default,,0,0,0,,So I'm going to skip over that
Dialogue: 0,0:11:35.70,0:11:38.55,Default,,0,0,0,,and I'm just going to call that
Dialogue: 0,0:11:38.55,0:11:39.00,Default,,0,0,0,,function.
Dialogue: 0,0:11:39.00,0:11:39.86,Default,,0,0,0,,So I'm going to say let
Dialogue: 0,0:11:39.86,0:11:41.49,Default,,0,0,0,,WordCounts =
Dialogue: 0,0:11:41.78,0:11:43.79,Default,,0,0,0,,tokenizeAndCountWords sentence.
Dialogue: 0,0:11:44.90,0:11:46.04,Default,,0,0,0,,And then I'm going to use this
Dialogue: 0,0:11:46.04,0:11:47.32,Default,,0,0,0,,word count and provide that to
Dialogue: 0,0:11:47.32,0:11:47.78,Default,,0,0,0,,my model.
Dialogue: 0,0:11:47.78,0:11:49.69,Default,,0,0,0,,So I'm going to say if let
Dialogue: 0,0:11:49.69,0:11:52.12,Default,,0,0,0,,prediction = try
Dialogue: 0,0:11:52.12,0:11:54.17,Default,,0,0,0,,model.prediction(wordCounts),
Dialogue: 0,0:11:54.74,0:11:56.25,Default,,0,0,0,,and simply pass that wordCount
Dialogue: 0,0:11:56.25,0:11:56.53,Default,,0,0,0,,there.
Dialogue: 0,0:11:57.46,0:11:59.12,Default,,0,0,0,,And if this succeeds, I'm going
Dialogue: 0,0:11:59.12,0:12:01.46,Default,,0,0,0,,to use the prediction object to
Dialogue: 0,0:12:01.46,0:12:03.19,Default,,0,0,0,,get out the sentiment score, but
Dialogue: 0,0:12:03.19,0:12:04.47,Default,,0,0,0,,because I want a value between
Dialogue: 0,0:12:04.47,0:12:05.65,Default,,0,0,0,,zero and 1 I'm going to get the
Dialogue: 0,0:12:05.65,0:12:06.67,Default,,0,0,0,,score and not the label.
Dialogue: 0,0:12:07.18,0:12:08.41,Default,,0,0,0,,So I'll take the sentiment score
Dialogue: 0,0:12:08.41,0:12:09.73,Default,,0,0,0,,associated with the sentiment
Dialogue: 0,0:12:09.73,0:12:11.29,Default,,0,0,0,,"good" and I'll return that to
Dialogue: 0,0:12:11.29,0:12:11.67,Default,,0,0,0,,my UI.
Dialogue: 0,0:12:11.67,0:12:13.61,Default,,0,0,0,,And if this fails, by any
Dialogue: 0,0:12:13.61,0:12:14.77,Default,,0,0,0,,chance, I'm going to go down
Dialogue: 0,0:12:14.77,0:12:15.45,Default,,0,0,0,,0.5.
Dialogue: 0,0:12:15.64,0:12:16.49,Default,,0,0,0,,So I have a little error
Dialogue: 0,0:12:16.49,0:12:19.64,Default,,0,0,0,,handling here as well.
Dialogue: 0,0:12:19.84,0:12:20.99,Default,,0,0,0,,So I'm going to go ahead and
Dialogue: 0,0:12:20.99,0:12:21.93,Default,,0,0,0,,build that application.
Dialogue: 0,0:12:22.33,0:12:23.85,Default,,0,0,0,,So during this process, as you
Dialogue: 0,0:12:23.85,0:12:25.20,Default,,0,0,0,,might be aware, the model and
Dialogue: 0,0:12:25.20,0:12:26.63,Default,,0,0,0,,the code are both getting
Dialogue: 0,0:12:26.63,0:12:28.54,Default,,0,0,0,,packaged and getting shipped to
Dialogue: 0,0:12:28.54,0:12:29.12,Default,,0,0,0,,the device.
Dialogue: 0,0:12:29.78,0:12:31.52,Default,,0,0,0,,Another thing to note is that
Dialogue: 0,0:12:31.52,0:12:33.24,Default,,0,0,0,,the compiler, the Core ML
Dialogue: 0,0:12:33.24,0:12:35.35,Default,,0,0,0,,compiler gets shipped as part of
Dialogue: 0,0:12:35.35,0:12:36.38,Default,,0,0,0,,the Xcode pool chain.
Dialogue: 0,0:12:36.55,0:12:37.65,Default,,0,0,0,,So if you want to compile them
Dialogue: 0,0:12:37.65,0:12:38.88,Default,,0,0,0,,all or run the code generator
Dialogue: 0,0:12:38.88,0:12:40.31,Default,,0,0,0,,yourself, you can use the
Dialogue: 0,0:12:40.31,0:12:41.05,Default,,0,0,0,,compiler directly.
Dialogue: 0,0:12:42.62,0:12:44.83,Default,,0,0,0,,So now let's go use this app and
Dialogue: 0,0:12:44.83,0:12:45.84,Default,,0,0,0,,let's type something nice.
Dialogue: 0,0:12:46.72,0:12:49.47,Default,,0,0,0,,Let's type "Core ML is amazing
Dialogue: 0,0:12:49.51,0:12:49.71,Default,,0,0,0,,fun."
Dialogue: 0,0:12:49.71,0:12:50.36,Default,,0,0,0,,That's what I want to write.
Dialogue: 0,0:12:51.19,0:12:53.61,Default,,0,0,0,,"Core ML is amazing fun and I
Dialogue: 0,0:12:53.61,0:12:54.55,Default,,0,0,0,,love using it."
Dialogue: 0,0:12:55.55,0:12:56.85,Default,,0,0,0,,So immediately you saw the UI
Dialogue: 0,0:12:56.92,0:12:58.24,Default,,0,0,0,,popped and I got a little green
Dialogue: 0,0:12:58.24,0:12:59.49,Default,,0,0,0,,and I'm happy and, you know,
Dialogue: 0,0:12:59.64,0:13:00.16,Default,,0,0,0,,this is great.
Dialogue: 0,0:13:01.52,0:13:03.71,Default,,0,0,0,,[ Applause ]
Dialogue: 0,0:13:04.21,0:13:05.85,Default,,0,0,0,,But now I want to type something
Dialogue: 0,0:13:05.85,0:13:07.36,Default,,0,0,0,,bad, but I don't really want to
Dialogue: 0,0:13:07.36,0:13:08.53,Default,,0,0,0,,make fun of anything or anyone
Dialogue: 0,0:13:08.53,0:13:09.61,Default,,0,0,0,,so I want to talk about how my
Dialogue: 0,0:13:09.61,0:13:11.19,Default,,0,0,0,,life is terrible without CoreML.
Dialogue: 0,0:13:12.52,0:13:15.36,Default,,0,0,0,,"Life without CoreML is sloppy,
Dialogue: 0,0:13:16.52,0:13:19.90,Default,,0,0,0,,terrible and sad."
Dialogue: 0,0:13:20.81,0:13:22.40,Default,,0,0,0,,So obviously the UI is really
Dialogue: 0,0:13:22.48,0:13:23.72,Default,,0,0,0,,sad because, you know, life
Dialogue: 0,0:13:23.72,0:13:25.11,Default,,0,0,0,,without Core ML is really sad.
Dialogue: 0,0:13:26.05,0:13:27.75,Default,,0,0,0,,So what we really saw was a
Dialogue: 0,0:13:27.92,0:13:30.49,Default,,0,0,0,,seamless integration between NLP
Dialogue: 0,0:13:30.49,0:13:32.06,Default,,0,0,0,,and Core ML, so I built this
Dialogue: 0,0:13:32.06,0:13:33.59,Default,,0,0,0,,Sentiment Analysis Model and I
Dialogue: 0,0:13:33.59,0:13:35.26,Default,,0,0,0,,was able to make my application
Dialogue: 0,0:13:35.26,0:13:36.51,Default,,0,0,0,,a lot more vibrant.
Dialogue: 0,0:13:36.63,0:13:38.26,Default,,0,0,0,,And all of this was happening in
Dialogue: 0,0:13:38.26,0:13:39.98,Default,,0,0,0,,real time on the device as the
Dialogue: 0,0:13:39.98,0:13:40.70,Default,,0,0,0,,user typed it.
Dialogue: 0,0:13:42.08,0:13:46.00,Default,,0,0,0,,So that was pretty cool.
Dialogue: 0,0:13:46.20,0:13:48.26,Default,,0,0,0,,Let's go recap the two main
Dialogue: 0,0:13:48.26,0:13:49.30,Default,,0,0,0,,things that we talked about in
Dialogue: 0,0:13:49.30,0:13:49.72,Default,,0,0,0,,this demo.
Dialogue: 0,0:13:50.45,0:13:52.20,Default,,0,0,0,,So the first thing was that the
Dialogue: 0,0:13:52.20,0:13:54.14,Default,,0,0,0,,preprocess text we use the
Dialogue: 0,0:13:54.14,0:13:55.05,Default,,0,0,0,,NSLinguisticTagger.
Dialogue: 0,0:13:55.52,0:13:58.59,Default,,0,0,0,,The second thing was that once I
Dialogue: 0,0:13:58.59,0:14:00.11,Default,,0,0,0,,got those word counts I could
Dialogue: 0,0:14:00.11,0:14:01.55,Default,,0,0,0,,then give it to a model and get
Dialogue: 0,0:14:01.55,0:14:03.54,Default,,0,0,0,,a prediction out of it.
Dialogue: 0,0:14:03.85,0:14:05.13,Default,,0,0,0,,And this is a pattern you're
Dialogue: 0,0:14:05.13,0:14:06.89,Default,,0,0,0,,going to encounter a lot with
Dialogue: 0,0:14:06.89,0:14:08.76,Default,,0,0,0,,text based applications because
Dialogue: 0,0:14:08.76,0:14:11.07,Default,,0,0,0,,most text space applications do
Dialogue: 0,0:14:11.07,0:14:13.11,Default,,0,0,0,,not work directly on raw text.
Dialogue: 0,0:14:13.67,0:14:15.84,Default,,0,0,0,,There's always a little bit of
Dialogue: 0,0:14:15.84,0:14:16.95,Default,,0,0,0,,preprocessing that you have to
Dialogue: 0,0:14:16.95,0:14:17.40,Default,,0,0,0,,do for it.
Dialogue: 0,0:14:17.97,0:14:20.62,Default,,0,0,0,,But that was really a simple
Dialogue: 0,0:14:20.62,0:14:21.13,Default,,0,0,0,,example.
Dialogue: 0,0:14:21.13,0:14:22.44,Default,,0,0,0,,It was an introductory example.
Dialogue: 0,0:14:22.97,0:14:24.28,Default,,0,0,0,,Let's step our game, let's get
Dialogue: 0,0:14:24.28,0:14:24.97,Default,,0,0,0,,to the next level.
Dialogue: 0,0:14:25.67,0:14:26.73,Default,,0,0,0,,Let's talk about something
Dialogue: 0,0:14:26.73,0:14:28.30,Default,,0,0,0,,you've all interacted with on a
Dialogue: 0,0:14:28.30,0:14:29.25,Default,,0,0,0,,daily basis.
Dialogue: 0,0:14:29.92,0:14:31.51,Default,,0,0,0,,This is the Apple keyboard.
Dialogue: 0,0:14:32.50,0:14:33.92,Default,,0,0,0,,Now, when you type words in the
Dialogue: 0,0:14:33.92,0:14:35.53,Default,,0,0,0,,Apple keyboard, as you might all
Dialogue: 0,0:14:35.53,0:14:36.87,Default,,0,0,0,,be aware, you get very
Dialogue: 0,0:14:36.87,0:14:38.82,Default,,0,0,0,,contextual predictions of what's
Dialogue: 0,0:14:38.88,0:14:40.34,Default,,0,0,0,,the next most likely word you're
Dialogue: 0,0:14:40.34,0:14:40.73,Default,,0,0,0,,going to type.
Dialogue: 0,0:14:41.42,0:14:43.18,Default,,0,0,0,,So if I say, "I'm not sure if
Dialogue: 0,0:14:43.18,0:14:45.88,Default,,0,0,0,,Oliver will eat oysters, but he
Dialogue: 0,0:14:45.88,0:14:46.53,Default,,0,0,0,,will."
Dialogue: 0,0:14:46.67,0:14:48.22,Default,,0,0,0,,They keyboard tells you "so",
Dialogue: 0,0:14:48.22,0:14:50.07,Default,,0,0,0,,"totally" and "love" are three
Dialogue: 0,0:14:50.07,0:14:52.20,Default,,0,0,0,,likely words you're going to
Dialogue: 0,0:14:52.78,0:14:53.17,Default,,0,0,0,,type next.
Dialogue: 0,0:14:53.17,0:14:54.77,Default,,0,0,0,,So how do you go about building
Dialogue: 0,0:14:54.77,0:14:56.17,Default,,0,0,0,,something as sophisticated as
Dialogue: 0,0:14:56.17,0:14:56.42,Default,,0,0,0,,this?
Dialogue: 0,0:14:57.26,0:14:58.42,Default,,0,0,0,,So this is a predictive
Dialogue: 0,0:14:58.42,0:15:00.36,Default,,0,0,0,,keyboard, and the machine
Dialogue: 0,0:15:00.36,0:15:02.86,Default,,0,0,0,,learning task here is to make a
Dialogue: 0,0:15:02.86,0:15:05.11,Default,,0,0,0,,prediction for the next word.
Dialogue: 0,0:15:05.82,0:15:07.71,Default,,0,0,0,,The model that's being used here
Dialogue: 0,0:15:07.79,0:15:08.99,Default,,0,0,0,,or the model that will be used
Dialogue: 0,0:15:08.99,0:15:11.05,Default,,0,0,0,,in an application like this is
Dialogue: 0,0:15:11.49,0:15:13.12,Default,,0,0,0,,usually a model that takes the
Dialogue: 0,0:15:13.25,0:15:14.15,Default,,0,0,0,,sequence of words.
Dialogue: 0,0:15:14.39,0:15:16.32,Default,,0,0,0,,So "I'm not sure Oliver will eat
Dialogue: 0,0:15:16.32,0:15:17.54,Default,,0,0,0,,oysters, but he will."
Dialogue: 0,0:15:17.54,0:15:18.75,Default,,0,0,0,,is a sequence of words.
Dialogue: 0,0:15:18.75,0:15:20.59,Default,,0,0,0,,I give that as input to the
Dialogue: 0,0:15:20.59,0:15:22.05,Default,,0,0,0,,model and I get a prediction.
Dialogue: 0,0:15:23.19,0:15:24.62,Default,,0,0,0,,So you might wonder, okay,
Dialogue: 0,0:15:24.62,0:15:26.43,Default,,0,0,0,,what's the difference between
Dialogue: 0,0:15:26.43,0:15:28.05,Default,,0,0,0,,this model that we just saw and
Dialogue: 0,0:15:28.05,0:15:29.14,Default,,0,0,0,,the Sentiment Analysis one?
Dialogue: 0,0:15:29.14,0:15:30.56,Default,,0,0,0,,They look the same to me.
Dialogue: 0,0:15:31.50,0:15:34.27,Default,,0,0,0,,The key difference is that here
Dialogue: 0,0:15:34.34,0:15:35.93,Default,,0,0,0,,the input is a sequence of
Dialogue: 0,0:15:35.93,0:15:36.24,Default,,0,0,0,,words.
Dialogue: 0,0:15:36.87,0:15:38.55,Default,,0,0,0,,So if you jumble up the words
Dialogue: 0,0:15:38.55,0:15:39.95,Default,,0,0,0,,and give it to the model you're
Dialogue: 0,0:15:39.95,0:15:41.07,Default,,0,0,0,,going to get a completely
Dialogue: 0,0:15:41.07,0:15:41.77,Default,,0,0,0,,different prediction.
Dialogue: 0,0:15:43.54,0:15:44.88,Default,,0,0,0,,And to do something like this,
Dialogue: 0,0:15:44.88,0:15:46.25,Default,,0,0,0,,most machine learning models
Dialogue: 0,0:15:46.45,0:15:48.17,Default,,0,0,0,,will have a notion of state
Dialogue: 0,0:15:48.17,0:15:50.09,Default,,0,0,0,,that's associated with them, and
Dialogue: 0,0:15:50.09,0:15:51.00,Default,,0,0,0,,that's how they get this
Dialogue: 0,0:15:51.00,0:15:51.46,Default,,0,0,0,,behavior.
Dialogue: 0,0:15:52.17,0:15:54.19,Default,,0,0,0,,And the state gets passed along
Dialogue: 0,0:15:54.42,0:15:55.77,Default,,0,0,0,,as every prediction is made.
Dialogue: 0,0:15:56.25,0:15:58.14,Default,,0,0,0,,So it's like a baton in a relay
Dialogue: 0,0:15:58.14,0:15:58.41,Default,,0,0,0,,race.
Dialogue: 0,0:15:58.63,0:15:59.25,Default,,0,0,0,,Every time you make a
Dialogue: 0,0:15:59.25,0:16:00.66,Default,,0,0,0,,prediction, take the state and
Dialogue: 0,0:16:00.66,0:16:02.91,Default,,0,0,0,,pass it along.
Dialogue: 0,0:16:03.06,0:16:04.42,Default,,0,0,0,,We're going to do something like
Dialogue: 0,0:16:04.42,0:16:06.62,Default,,0,0,0,,this using an LSDM, usually.
Dialogue: 0,0:16:06.89,0:16:08.55,Default,,0,0,0,,Specifically, like a [inaudible]
Dialogue: 0,0:16:08.55,0:16:09.26,Default,,0,0,0,,network.
Dialogue: 0,0:16:09.70,0:16:11.06,Default,,0,0,0,,But with Core ML, all of this is
Dialogue: 0,0:16:11.06,0:16:12.03,Default,,0,0,0,,going to be a lot easier.
Dialogue: 0,0:16:12.61,0:16:13.77,Default,,0,0,0,,So, let's take a look at what
Dialogue: 0,0:16:13.77,0:16:16.06,Default,,0,0,0,,you do but we'll do it with a
Dialogue: 0,0:16:16.06,0:16:17.36,Default,,0,0,0,,little more fun application.
Dialogue: 0,0:16:17.74,0:16:18.76,Default,,0,0,0,,We'll do it with a Shakespeare
Dialogue: 0,0:16:18.76,0:16:19.14,Default,,0,0,0,,Keyboard.
Dialogue: 0,0:16:19.79,0:16:20.71,Default,,0,0,0,,So instead of a regular
Dialogue: 0,0:16:20.71,0:16:22.38,Default,,0,0,0,,keyboard, this keyboard is going
Dialogue: 0,0:16:22.38,0:16:23.07,Default,,0,0,0,,to make me sound like
Dialogue: 0,0:16:23.07,0:16:23.48,Default,,0,0,0,,Shakespeare.
Dialogue: 0,0:16:24.18,0:16:26.34,Default,,0,0,0,,So if I say, "Shall I compare?"
Dialogue: 0,0:16:26.66,0:16:28.22,Default,,0,0,0,,It should say "thee", "summers",
Dialogue: 0,0:16:28.22,0:16:29.32,Default,,0,0,0,,"day" are the next three words
Dialogue: 0,0:16:29.32,0:16:31.85,Default,,0,0,0,,I'm likely to type.
Dialogue: 0,0:16:32.03,0:16:33.63,Default,,0,0,0,,So, what's really the difference
Dialogue: 0,0:16:33.63,0:16:35.26,Default,,0,0,0,,between the Shakespeare Keyboard
Dialogue: 0,0:16:35.26,0:16:36.47,Default,,0,0,0,,and the regular keyboard?
Dialogue: 0,0:16:36.47,0:16:38.72,Default,,0,0,0,,It's really the model that's
Dialogue: 0,0:16:38.77,0:16:39.98,Default,,0,0,0,,predicting the next word.
Dialogue: 0,0:16:40.51,0:16:42.08,Default,,0,0,0,,So one of those models is
Dialogue: 0,0:16:42.14,0:16:43.64,Default,,0,0,0,,trained on Shakespeare data and
Dialogue: 0,0:16:44.13,0:16:45.94,Default,,0,0,0,,another one is just trained on
Dialogue: 0,0:16:45.94,0:16:47.05,Default,,0,0,0,,regular English data.
Dialogue: 0,0:16:47.96,0:16:49.39,Default,,0,0,0,,So this concept is the Language
Dialogue: 0,0:16:49.39,0:16:49.69,Default,,0,0,0,,Model.
Dialogue: 0,0:16:50.58,0:16:52.32,Default,,0,0,0,,So I just threw so many new
Dialogue: 0,0:16:52.32,0:16:53.54,Default,,0,0,0,,concepts at you, a Language
Dialogue: 0,0:16:53.54,0:16:54.86,Default,,0,0,0,,Model, Sequences, LSDM, but
Dialogue: 0,0:16:54.86,0:16:57.20,Default,,0,0,0,,don't worry, with Core ML this
Dialogue: 0,0:16:57.20,0:16:58.26,Default,,0,0,0,,should be a lot easier.
Dialogue: 0,0:16:58.80,0:16:59.62,Default,,0,0,0,,Let's see how you would do
Dialogue: 0,0:16:59.62,0:17:00.24,Default,,0,0,0,,something like this.
Dialogue: 0,0:17:01.41,0:17:04.10,Default,,0,0,0,,So I start with a model and I'm
Dialogue: 0,0:17:04.10,0:17:05.48,Default,,0,0,0,,going to give it the first word,
Dialogue: 0,0:17:05.48,0:17:07.19,Default,,0,0,0,,let's say in this case, "Shall".
Dialogue: 0,0:17:08.27,0:17:09.61,Default,,0,0,0,,That's the current word.
Dialogue: 0,0:17:10.60,0:17:12.24,Default,,0,0,0,,And what I'll get back from the
Dialogue: 0,0:17:12.24,0:17:13.53,Default,,0,0,0,,model are two things.
Dialogue: 0,0:17:14.65,0:17:16.24,Default,,0,0,0,,A set of choices for the next
Dialogue: 0,0:17:16.24,0:17:16.53,Default,,0,0,0,,word.
Dialogue: 0,0:17:16.83,0:17:19.32,Default,,0,0,0,,So in this case I get basically
Dialogue: 0,0:17:19.32,0:17:20.73,Default,,0,0,0,,a probability associated with
Dialogue: 0,0:17:20.73,0:17:23.27,Default,,0,0,0,,all the set of next words, and
Dialogue: 0,0:17:23.78,0:17:25.42,Default,,0,0,0,,I'm also going to get a state
Dialogue: 0,0:17:25.72,0:17:27.26,Default,,0,0,0,,associated with this prediction.
Dialogue: 0,0:17:28.62,0:17:29.99,Default,,0,0,0,,So I'll take these next word
Dialogue: 0,0:17:29.99,0:17:31.60,Default,,0,0,0,,choices and I'll give them to
Dialogue: 0,0:17:31.60,0:17:32.02,Default,,0,0,0,,the user.
Dialogue: 0,0:17:32.02,0:17:34.38,Default,,0,0,0,,The user will either select one
Dialogue: 0,0:17:34.38,0:17:35.82,Default,,0,0,0,,of those three words or maybe
Dialogue: 0,0:17:35.82,0:17:37.18,Default,,0,0,0,,they'll type their own word.
Dialogue: 0,0:17:37.18,0:17:38.92,Default,,0,0,0,,Either way I get a next word.
Dialogue: 0,0:17:40.34,0:17:41.91,Default,,0,0,0,,I'll use that next word, pass it
Dialogue: 0,0:17:41.91,0:17:42.98,Default,,0,0,0,,back to the model for the next
Dialogue: 0,0:17:42.98,0:17:44.79,Default,,0,0,0,,prediction, and I'm also going
Dialogue: 0,0:17:44.79,0:17:46.11,Default,,0,0,0,,to take the state, pass it back
Dialogue: 0,0:17:46.11,0:17:47.02,Default,,0,0,0,,to the model for the next
Dialogue: 0,0:17:47.02,0:17:47.39,Default,,0,0,0,,prediction.
Dialogue: 0,0:17:48.41,0:17:50.23,Default,,0,0,0,,So in steady state every time
Dialogue: 0,0:17:50.23,0:17:51.17,Default,,0,0,0,,you're going to do two things.
Dialogue: 0,0:17:51.65,0:17:52.58,Default,,0,0,0,,You're going to take the current
Dialogue: 0,0:17:52.58,0:17:53.85,Default,,0,0,0,,word in the state and give it to
Dialogue: 0,0:17:53.85,0:17:55.54,Default,,0,0,0,,the model, and what you'll get
Dialogue: 0,0:17:55.54,0:17:57.03,Default,,0,0,0,,back are the set of choices for
Dialogue: 0,0:17:57.03,0:17:58.36,Default,,0,0,0,,the next word and some state.
Dialogue: 0,0:17:59.26,0:18:00.02,Default,,0,0,0,,And the second thing you're
Dialogue: 0,0:18:00.02,0:18:00.73,Default,,0,0,0,,going to do is you're going to
Dialogue: 0,0:18:00.73,0:18:02.04,Default,,0,0,0,,pass that all back to the model
Dialogue: 0,0:18:02.04,0:18:02.82,Default,,0,0,0,,for the next prediction.
Dialogue: 0,0:18:03.24,0:18:04.30,Default,,0,0,0,,So, it's pretty simple.
Dialogue: 0,0:18:05.08,0:18:06.07,Default,,0,0,0,,Let's see what the code would
Dialogue: 0,0:18:06.07,0:18:07.95,Default,,0,0,0,,look like to do something like
Dialogue: 0,0:18:08.86,0:18:08.96,Default,,0,0,0,,that.
Dialogue: 0,0:18:09.19,0:18:10.69,Default,,0,0,0,,So I'm going to start by saying
Dialogue: 0,0:18:10.69,0:18:11.54,Default,,0,0,0,,let output =
Dialogue: 0,0:18:11.54,0:18:12.67,Default,,0,0,0,,model.prediction(input).
Dialogue: 0,0:18:12.67,0:18:15.77,Default,,0,0,0,,I'll take the probabilities
Dialogue: 0,0:18:15.77,0:18:17.06,Default,,0,0,0,,associated with the next word
Dialogue: 0,0:18:17.06,0:18:18.69,Default,,0,0,0,,and I'll give it to a function
Dialogue: 0,0:18:18.69,0:18:20.49,Default,,0,0,0,,say displayTopPredictions which
Dialogue: 0,0:18:20.83,0:18:22.29,Default,,0,0,0,,says selects the top 3 and gives
Dialogue: 0,0:18:22.29,0:18:23.70,Default,,0,0,0,,that to the user.
Dialogue: 0,0:18:24.64,0:18:26.20,Default,,0,0,0,,The user is either going to
Dialogue: 0,0:18:26.24,0:18:27.58,Default,,0,0,0,,select one of those 3 words or
Dialogue: 0,0:18:27.58,0:18:29.24,Default,,0,0,0,,maybe type their own, either way
Dialogue: 0,0:18:29.24,0:18:30.70,Default,,0,0,0,,I'll get that from this function
Dialogue: 0,0:18:30.70,0:18:33.01,Default,,0,0,0,,getWordFromUser and I'll pass
Dialogue: 0,0:18:33.01,0:18:34.35,Default,,0,0,0,,that back to the input as the
Dialogue: 0,0:18:34.35,0:18:34.91,Default,,0,0,0,,current word.
Dialogue: 0,0:18:35.40,0:18:36.83,Default,,0,0,0,,I'll take the state, pass it
Dialogue: 0,0:18:36.83,0:18:38.70,Default,,0,0,0,,along to the model again.
Dialogue: 0,0:18:39.25,0:18:41.41,Default,,0,0,0,,So in just a few lines of code,
Dialogue: 0,0:18:41.71,0:18:43.28,Default,,0,0,0,,you can integrate a more less
Dialogue: 0,0:18:43.33,0:18:44.99,Default,,0,0,0,,complex as an LSDM that involves
Dialogue: 0,0:18:44.99,0:18:46.88,Default,,0,0,0,,state, the language model,
Dialogue: 0,0:18:46.88,0:18:48.30,Default,,0,0,0,,keyboard, all sorts of things in
Dialogue: 0,0:18:48.30,0:18:49.30,Default,,0,0,0,,just a few lines of code.
Dialogue: 0,0:18:49.85,0:18:51.04,Default,,0,0,0,,So that was about the different
Dialogue: 0,0:18:51.04,0:18:52.41,Default,,0,0,0,,sets of use cases and a little
Dialogue: 0,0:18:52.41,0:18:53.25,Default,,0,0,0,,bit about text.
Dialogue: 0,0:18:54.42,0:18:55.74,Default,,0,0,0,,Now let's talk about how Core ML
Dialogue: 0,0:18:56.24,0:18:58.01,Default,,0,0,0,,is optimized for the hardware on
Dialogue: 0,0:18:58.01,0:18:59.53,Default,,0,0,0,,which it runs and most
Dialogue: 0,0:18:59.53,0:19:01.11,Default,,0,0,0,,importantly what that means for
Dialogue: 0,0:19:01.11,0:19:02.20,Default,,0,0,0,,all of you when you're building
Dialogue: 0,0:19:03.15,0:19:03.28,Default,,0,0,0,,apps.
Dialogue: 0,0:19:04.10,0:19:05.51,Default,,0,0,0,,So we're going to motivate that
Dialogue: 0,0:19:05.51,0:19:07.58,Default,,0,0,0,,with a little video of real time
Dialogue: 0,0:19:07.58,0:19:08.37,Default,,0,0,0,,object detection.
Dialogue: 0,0:19:09.34,0:19:10.93,Default,,0,0,0,,What's important to note here is
Dialogue: 0,0:19:10.93,0:19:13.98,Default,,0,0,0,,that the camera feed is live
Dialogue: 0,0:19:13.98,0:19:15.56,Default,,0,0,0,,going to a model, and a
Dialogue: 0,0:19:15.56,0:19:17.24,Default,,0,0,0,,relatively powerful model, and
Dialogue: 0,0:19:17.24,0:19:18.20,Default,,0,0,0,,you're getting accurate
Dialogue: 0,0:19:18.20,0:19:20.31,Default,,0,0,0,,predictions as you see, live.
Dialogue: 0,0:19:21.20,0:19:22.85,Default,,0,0,0,,And this is only possible
Dialogue: 0,0:19:23.01,0:19:24.37,Default,,0,0,0,,because Core ML is super
Dialogue: 0,0:19:24.37,0:19:25.80,Default,,0,0,0,,optimized for the hardware on
Dialogue: 0,0:19:25.80,0:19:26.42,Default,,0,0,0,,which it runs.
Dialogue: 0,0:19:27.13,0:19:28.59,Default,,0,0,0,,And in this case, the model runs
Dialogue: 0,0:19:28.59,0:19:30.16,Default,,0,0,0,,in about, say, under 50
Dialogue: 0,0:19:30.16,0:19:30.82,Default,,0,0,0,,milliseconds.
Dialogue: 0,0:19:31.49,0:19:34.94,Default,,0,0,0,,I was hoping nobody laugh
Dialogue: 0,0:19:34.94,0:19:36.61,Default,,0,0,0,,because this joke has been said
Dialogue: 0,0:19:36.72,0:19:37.68,Default,,0,0,0,,7 times already.
Dialogue: 0,0:19:38.52,0:19:41.87,Default,,0,0,0,,[ Laughter and Applause ]
Dialogue: 0,0:19:42.37,0:19:44.24,Default,,0,0,0,,So what really matters for you
Dialogue: 0,0:19:44.24,0:19:45.65,Default,,0,0,0,,is that Core ML is built on top
Dialogue: 0,0:19:45.65,0:19:46.93,Default,,0,0,0,,of the performance primitives,
Dialogue: 0,0:19:47.33,0:19:49.10,Default,,0,0,0,,Accelerate and MPS.
Dialogue: 0,0:19:49.63,0:19:50.82,Default,,0,0,0,,But more importantly, it
Dialogue: 0,0:19:50.82,0:19:52.36,Default,,0,0,0,,completely hides the hardware
Dialogue: 0,0:19:52.36,0:19:53.46,Default,,0,0,0,,from you so you don't have to
Dialogue: 0,0:19:53.46,0:19:54.70,Default,,0,0,0,,worry about whether it's running
Dialogue: 0,0:19:54.70,0:19:56.64,Default,,0,0,0,,on the CPU or the GPU.
Dialogue: 0,0:19:57.23,0:19:58.61,Default,,0,0,0,,So that demo that you saw, you
Dialogue: 0,0:19:58.61,0:19:59.93,Default,,0,0,0,,might ask, okay, how many knobs
Dialogue: 0,0:19:59.93,0:20:01.13,Default,,0,0,0,,did I have to turn to get that
Dialogue: 0,0:20:01.13,0:20:01.53,Default,,0,0,0,,to work?
Dialogue: 0,0:20:01.53,0:20:02.92,Default,,0,0,0,,Well it's zero.
Dialogue: 0,0:20:03.15,0:20:04.08,Default,,0,0,0,,That's the performance you'll
Dialogue: 0,0:20:04.08,0:20:05.14,Default,,0,0,0,,get out of the box.
Dialogue: 0,0:20:06.52,0:20:11.77,Default,,0,0,0,,[ Applause ]
Dialogue: 0,0:20:12.27,0:20:14.41,Default,,0,0,0,,So specifically that demo that
Dialogue: 0,0:20:14.41,0:20:16.36,Default,,0,0,0,,you saw and flower predictor
Dialogue: 0,0:20:16.36,0:20:18.15,Default,,0,0,0,,that you saw earlier, those two
Dialogue: 0,0:20:18.15,0:20:20.70,Default,,0,0,0,,were compute heavy tasks, and we
Dialogue: 0,0:20:20.70,0:20:22.37,Default,,0,0,0,,knew that so we showed you them
Dialogue: 0,0:20:22.37,0:20:23.25,Default,,0,0,0,,on the GPU.
Dialogue: 0,0:20:24.05,0:20:25.53,Default,,0,0,0,,Whereas some of the text based
Dialogue: 0,0:20:25.53,0:20:27.32,Default,,0,0,0,,demos like Sentiment Analysis
Dialogue: 0,0:20:27.32,0:20:29.15,Default,,0,0,0,,and Next Word Prediction, these
Dialogue: 0,0:20:29.15,0:20:30.76,Default,,0,0,0,,were memory heavy tasks and
Dialogue: 0,0:20:30.76,0:20:32.25,Default,,0,0,0,,that's why we showed you them on
Dialogue: 0,0:20:32.25,0:20:32.83,Default,,0,0,0,,the CPU.
Dialogue: 0,0:20:33.91,0:20:35.35,Default,,0,0,0,,But most importantly, they all
Dialogue: 0,0:20:35.40,0:20:36.80,Default,,0,0,0,,just run on Core ML so you don't
Dialogue: 0,0:20:36.80,0:20:38.01,Default,,0,0,0,,have to worry about where it's
Dialogue: 0,0:20:38.01,0:20:38.31,Default,,0,0,0,,running.
Dialogue: 0,0:20:38.49,0:20:39.64,Default,,0,0,0,,We've got your back.
Dialogue: 0,0:20:40.40,0:20:42.30,Default,,0,0,0,,And this kind of abstraction
Dialogue: 0,0:20:42.30,0:20:43.75,Default,,0,0,0,,lets us do powerful things.
Dialogue: 0,0:20:44.38,0:20:46.01,Default,,0,0,0,,So for the Image Captioning, for
Dialogue: 0,0:20:46.01,0:20:47.71,Default,,0,0,0,,example, where part of that
Dialogue: 0,0:20:47.71,0:20:49.60,Default,,0,0,0,,model is compute heavy and part
Dialogue: 0,0:20:49.60,0:20:51.34,Default,,0,0,0,,of that model is memory heavy,
Dialogue: 0,0:20:51.54,0:20:53.10,Default,,0,0,0,,we automatically contact Switch
Dialogue: 0,0:20:53.10,0:20:55.35,Default,,0,0,0,,from the GPU to the CPU so that
Dialogue: 0,0:20:55.35,0:20:56.91,Default,,0,0,0,,you can get the best of both
Dialogue: 0,0:20:57.55,0:20:57.70,Default,,0,0,0,,worlds.
Dialogue: 0,0:20:58.84,0:21:01.14,Default,,0,0,0,,So this was all about use cases
Dialogue: 0,0:21:01.14,0:21:03.66,Default,,0,0,0,,and performance, but Core ML is
Dialogue: 0,0:21:03.66,0:21:04.65,Default,,0,0,0,,much more than just the
Dialogue: 0,0:21:04.65,0:21:05.24,Default,,0,0,0,,framework.
Dialogue: 0,0:21:05.69,0:21:06.90,Default,,0,0,0,,It's a file format and a
Dialogue: 0,0:21:06.96,0:21:08.80,Default,,0,0,0,,collection of tools to help you
Dialogue: 0,0:21:08.80,0:21:10.13,Default,,0,0,0,,get more and more models that
Dialogue: 0,0:21:10.13,0:21:11.19,Default,,0,0,0,,you can use in your apps.
Dialogue: 0,0:21:11.71,0:21:12.94,Default,,0,0,0,,And to talk about that, I'd like
Dialogue: 0,0:21:12.94,0:21:13.87,Default,,0,0,0,,to invite my friend and
Dialogue: 0,0:21:13.87,0:21:14.87,Default,,0,0,0,,colleague, Zach.
Dialogue: 0,0:21:16.52,0:21:22.74,Default,,0,0,0,,[ Applause ]
Dialogue: 0,0:21:23.24,0:21:23.88,Default,,0,0,0,,>> Thanks, Krishna.
Dialogue: 0,0:21:25.04,0:21:27.18,Default,,0,0,0,,Hi. My name is Zach and I'm an
Dialogue: 0,0:21:27.18,0:21:29.51,Default,,0,0,0,,engineer on the Core ML
Dialogue: 0,0:21:29.51,0:21:30.19,Default,,0,0,0,,Engineering Team.
Dialogue: 0,0:21:31.52,0:21:34.00,Default,,0,0,0,,[ Applause ]
Dialogue: 0,0:21:34.50,0:21:35.68,Default,,0,0,0,,And I'm really excited to talk
Dialogue: 0,0:21:35.73,0:21:37.86,Default,,0,0,0,,to you today about the Core ML
Dialogue: 0,0:21:38.01,0:21:39.72,Default,,0,0,0,,Model Format and where you can
Dialogue: 0,0:21:39.72,0:21:41.53,Default,,0,0,0,,get models in this format for
Dialogue: 0,0:21:41.53,0:21:43.36,Default,,0,0,0,,use in your apps.
Dialogue: 0,0:21:44.18,0:21:46.14,Default,,0,0,0,,So by now, you've seen this
Dialogue: 0,0:21:46.14,0:21:48.01,Default,,0,0,0,,diagram many times and this
Dialogue: 0,0:21:48.01,0:21:50.15,Default,,0,0,0,,shows how easy it is to use a
Dialogue: 0,0:21:50.15,0:21:51.21,Default,,0,0,0,,Machine Learning Model.
Dialogue: 0,0:21:51.39,0:21:52.82,Default,,0,0,0,,Simply drag and drop it into
Dialogue: 0,0:21:53.08,0:21:54.11,Default,,0,0,0,,Xcode and you get a code
Dialogue: 0,0:21:54.11,0:21:54.60,Default,,0,0,0,,interface.
Dialogue: 0,0:21:55.33,0:21:56.36,Default,,0,0,0,,But by now you're probably
Dialogue: 0,0:21:56.36,0:21:58.36,Default,,0,0,0,,wondering where do these models
Dialogue: 0,0:21:58.36,0:21:58.86,Default,,0,0,0,,come from?
Dialogue: 0,0:21:59.31,0:22:02.08,Default,,0,0,0,,Well, there are really two
Dialogue: 0,0:22:02.08,0:22:04.15,Default,,0,0,0,,places you can look for Machine
Dialogue: 0,0:22:04.15,0:22:05.49,Default,,0,0,0,,Learning Models in the Core ML
Dialogue: 0,0:22:05.49,0:22:06.08,Default,,0,0,0,,Model Format.
Dialogue: 0,0:22:06.93,0:22:09.22,Default,,0,0,0,,The first is the example models
Dialogue: 0,0:22:09.44,0:22:10.97,Default,,0,0,0,,on developer.apple.com.
Dialogue: 0,0:22:11.69,0:22:13.15,Default,,0,0,0,,These are a variety of
Dialogue: 0,0:22:13.21,0:22:15.34,Default,,0,0,0,,pre-trained models already in
Dialogue: 0,0:22:15.48,0:22:17.32,Default,,0,0,0,,the Core ML Model Format and
Dialogue: 0,0:22:17.32,0:22:18.64,Default,,0,0,0,,this is the easiest way to get
Dialogue: 0,0:22:18.64,0:22:20.09,Default,,0,0,0,,started if you're new to machine
Dialogue: 0,0:22:20.09,0:22:20.33,Default,,0,0,0,,learning.
Dialogue: 0,0:22:21.43,0:22:23.46,Default,,0,0,0,,But we also know there's a whole
Dialogue: 0,0:22:23.46,0:22:24.82,Default,,0,0,0,,wide world of machine learning
Dialogue: 0,0:22:24.82,0:22:25.30,Default,,0,0,0,,out there.
Dialogue: 0,0:22:26.00,0:22:27.20,Default,,0,0,0,,There are a lot of existing
Dialogue: 0,0:22:27.26,0:22:29.20,Default,,0,0,0,,popular training tools and a lot
Dialogue: 0,0:22:29.20,0:22:31.01,Default,,0,0,0,,of existing models out there in
Dialogue: 0,0:22:31.01,0:22:32.06,Default,,0,0,0,,these formats already.
Dialogue: 0,0:22:32.63,0:22:33.98,Default,,0,0,0,,So we want to make it possible
Dialogue: 0,0:22:34.19,0:22:35.80,Default,,0,0,0,,to take machine learning models,
Dialogue: 0,0:22:36.09,0:22:37.55,Default,,0,0,0,,trained using the most popular
Dialogue: 0,0:22:37.55,0:22:40.15,Default,,0,0,0,,tools, and use them in your apps
Dialogue: 0,0:22:40.15,0:22:40.49,Default,,0,0,0,,today.
Dialogue: 0,0:22:42.16,0:22:44.28,Default,,0,0,0,,So to that end, we've created
Dialogue: 0,0:22:44.54,0:22:45.55,Default,,0,0,0,,Core ML Tools.
Dialogue: 0,0:22:46.24,0:22:47.95,Default,,0,0,0,,It's a converter package that
Dialogue: 0,0:22:47.95,0:22:49.71,Default,,0,0,0,,takes models in a variety of
Dialogue: 0,0:22:49.75,0:22:51.61,Default,,0,0,0,,popular formats and converts
Dialogue: 0,0:22:51.66,0:22:53.06,Default,,0,0,0,,them into the Core ML Model
Dialogue: 0,0:22:53.06,0:22:56.55,Default,,0,0,0,,Format and it's open source.
Dialogue: 0,0:22:57.52,0:23:02.79,Default,,0,0,0,,[ Applause ]
Dialogue: 0,0:23:03.29,0:23:04.57,Default,,0,0,0,,We've released Core ML Tools
Dialogue: 0,0:23:04.57,0:23:06.42,Default,,0,0,0,,under the permissive BSD license
Dialogue: 0,0:23:06.74,0:23:09.42,Default,,0,0,0,,so that there are no barriers to
Dialogue: 0,0:23:12.09,0:23:12.30,Default,,0,0,0,,adoption.
Dialogue: 0,0:23:12.43,0:23:14.85,Default,,0,0,0,,So to get a model off the
Dialogue: 0,0:23:14.85,0:23:16.06,Default,,0,0,0,,internet somewhere, you're going
Dialogue: 0,0:23:16.06,0:23:17.40,Default,,0,0,0,,to start with a model in a
Dialogue: 0,0:23:17.40,0:23:18.12,Default,,0,0,0,,different format.
Dialogue: 0,0:23:18.12,0:23:18.81,Default,,0,0,0,,Let's say Caffe.
Dialogue: 0,0:23:19.93,0:23:21.32,Default,,0,0,0,,So Caffe is a really popular
Dialogue: 0,0:23:21.32,0:23:22.59,Default,,0,0,0,,deep learning training library.
Dialogue: 0,0:23:23.13,0:23:25.08,Default,,0,0,0,,If you're starting with a model
Dialogue: 0,0:23:25.08,0:23:26.95,Default,,0,0,0,,in, say, Caffe Format, the way
Dialogue: 0,0:23:26.95,0:23:28.14,Default,,0,0,0,,that you get it into Core ML
Dialogue: 0,0:23:28.14,0:23:29.48,Default,,0,0,0,,Model Format and to use it in
Dialogue: 0,0:23:29.48,0:23:31.11,Default,,0,0,0,,your application is to run it
Dialogue: 0,0:23:31.20,0:23:32.97,Default,,0,0,0,,through a converter from Core ML
Dialogue: 0,0:23:32.97,0:23:33.34,Default,,0,0,0,,Tools.
Dialogue: 0,0:23:34.21,0:23:36.16,Default,,0,0,0,,Or if you don't find a model out
Dialogue: 0,0:23:36.16,0:23:37.39,Default,,0,0,0,,there that does what you want,
Dialogue: 0,0:23:37.92,0:23:39.00,Default,,0,0,0,,you can start with your own
Dialogue: 0,0:23:39.00,0:23:40.83,Default,,0,0,0,,training data and use any of a
Dialogue: 0,0:23:40.83,0:23:42.42,Default,,0,0,0,,variety of these popular tools
Dialogue: 0,0:23:42.64,0:23:43.95,Default,,0,0,0,,to train your own model in that
Dialogue: 0,0:23:43.95,0:23:44.33,Default,,0,0,0,,format.
Dialogue: 0,0:23:44.83,0:23:46.33,Default,,0,0,0,,From there, again, you run the
Dialogue: 0,0:23:46.33,0:23:48.19,Default,,0,0,0,,converter to produce a model in
Dialogue: 0,0:23:48.19,0:23:49.80,Default,,0,0,0,,Core ML Model Format and the
Dialogue: 0,0:23:49.80,0:23:51.15,Default,,0,0,0,,rest of the workflow stays
Dialogue: 0,0:23:51.15,0:23:52.00,Default,,0,0,0,,exactly the same.
Dialogue: 0,0:23:52.41,0:23:53.69,Default,,0,0,0,,Simply drag and drop the model
Dialogue: 0,0:23:53.69,0:23:55.07,Default,,0,0,0,,into Xcode and you get a code
Dialogue: 0,0:23:55.07,0:23:55.73,Default,,0,0,0,,interface.
Dialogue: 0,0:23:56.52,0:24:01.50,Default,,0,0,0,,[ Applause ]
Dialogue: 0,0:24:04.05,0:24:06.30,Default,,0,0,0,,Using Core ML Tools is as easy
Dialogue: 0,0:24:06.30,0:24:08.72,Default,,0,0,0,,as pip install coremltools which
Dialogue: 0,0:24:08.75,0:24:09.73,Default,,0,0,0,,downloads and installs the
Dialogue: 0,0:24:09.73,0:24:10.31,Default,,0,0,0,,package.
Dialogue: 0,0:24:10.89,0:24:12.55,Default,,0,0,0,,This is a python package with
Dialogue: 0,0:24:12.60,0:24:14.30,Default,,0,0,0,,converters for a variety of
Dialogue: 0,0:24:14.36,0:24:16.17,Default,,0,0,0,,popular training tools, and most
Dialogue: 0,0:24:16.17,0:24:17.83,Default,,0,0,0,,of these tools are already in
Dialogue: 0,0:24:17.83,0:24:18.34,Default,,0,0,0,,python.
Dialogue: 0,0:24:18.60,0:24:19.78,Default,,0,0,0,,So to be part of that machine
Dialogue: 0,0:24:19.78,0:24:21.40,Default,,0,0,0,,learning ecosystem, this is a
Dialogue: 0,0:24:21.40,0:24:25.04,Default,,0,0,0,,python library as well.
Dialogue: 0,0:24:25.24,0:24:26.80,Default,,0,0,0,,Let's look at the breakdown of
Dialogue: 0,0:24:26.80,0:24:28.12,Default,,0,0,0,,what's inside this package.
Dialogue: 0,0:24:28.87,0:24:30.49,Default,,0,0,0,,At the very top are each of the
Dialogue: 0,0:24:30.49,0:24:32.47,Default,,0,0,0,,converters, and this is a set of
Dialogue: 0,0:24:32.56,0:24:34.59,Default,,0,0,0,,converters, one for each popular
Dialogue: 0,0:24:34.59,0:24:35.39,Default,,0,0,0,,training library.
Dialogue: 0,0:24:36.62,0:24:38.44,Default,,0,0,0,,Underneath that, we have Core ML
Dialogue: 0,0:24:38.44,0:24:40.08,Default,,0,0,0,,bindings and a converter
Dialogue: 0,0:24:40.08,0:24:41.64,Default,,0,0,0,,library, and this is what we've
Dialogue: 0,0:24:41.64,0:24:43.06,Default,,0,0,0,,used to build all of the
Dialogue: 0,0:24:43.06,0:24:43.65,Default,,0,0,0,,converters.
Dialogue: 0,0:24:43.99,0:24:45.81,Default,,0,0,0,,So here the Core ML bindings
Dialogue: 0,0:24:46.17,0:24:47.96,Default,,0,0,0,,allow you to call directly into
Dialogue: 0,0:24:47.96,0:24:49.75,Default,,0,0,0,,Core ML from python and get
Dialogue: 0,0:24:49.75,0:24:51.22,Default,,0,0,0,,backup prediction, and that's
Dialogue: 0,0:24:51.39,0:24:53.05,Default,,0,0,0,,really useful to verify that the
Dialogue: 0,0:24:53.25,0:24:54.68,Default,,0,0,0,,prediction you get for a
Dialogue: 0,0:24:54.68,0:24:56.16,Default,,0,0,0,,converted model is exactly the
Dialogue: 0,0:24:56.16,0:24:57.60,Default,,0,0,0,,same as the prediction you would
Dialogue: 0,0:24:57.60,0:24:59.15,Default,,0,0,0,,get with the original training
Dialogue: 0,0:24:59.15,0:24:59.65,Default,,0,0,0,,framework.
Dialogue: 0,0:25:00.49,0:25:01.52,Default,,0,0,0,,We also have a converter
Dialogue: 0,0:25:01.52,0:25:03.20,Default,,0,0,0,,library, which is a high-level
Dialogue: 0,0:25:03.20,0:25:05.30,Default,,0,0,0,,API for building converters, and
Dialogue: 0,0:25:05.30,0:25:06.70,Default,,0,0,0,,its shared code among all of
Dialogue: 0,0:25:06.70,0:25:08.02,Default,,0,0,0,,these converters so that make it
Dialogue: 0,0:25:08.02,0:25:09.25,Default,,0,0,0,,really easy to build new
Dialogue: 0,0:25:09.25,0:25:10.74,Default,,0,0,0,,converters for new formats.
Dialogue: 0,0:25:12.20,0:25:13.81,Default,,0,0,0,,Underneath all of that is the
Dialogue: 0,0:25:13.81,0:25:15.14,Default,,0,0,0,,Core ML Specification.
Dialogue: 0,0:25:15.98,0:25:18.15,Default,,0,0,0,,This is a read and write API to
Dialogue: 0,0:25:18.15,0:25:20.43,Default,,0,0,0,,the Core ML Model Format
Dialogue: 0,0:25:20.43,0:25:20.96,Default,,0,0,0,,directly.
Dialogue: 0,0:25:21.47,0:25:23.27,Default,,0,0,0,,So all of the individual fields
Dialogue: 0,0:25:23.42,0:25:26.56,Default,,0,0,0,,can be accessed here.
Dialogue: 0,0:25:27.02,0:25:28.27,Default,,0,0,0,,We've designed the package this
Dialogue: 0,0:25:28.27,0:25:30.84,Default,,0,0,0,,way so that it's compatible and
Dialogue: 0,0:25:30.84,0:25:31.51,Default,,0,0,0,,extensible.
Dialogue: 0,0:25:32.13,0:25:33.91,Default,,0,0,0,,At the top level, the converters
Dialogue: 0,0:25:33.91,0:25:36.76,Default,,0,0,0,,give Core ML compatibility with
Dialogue: 0,0:25:36.76,0:25:38.24,Default,,0,0,0,,a variety of popular tools.
Dialogue: 0,0:25:39.78,0:25:41.55,Default,,0,0,0,,Underneath that, the Core ML
Dialogue: 0,0:25:41.55,0:25:43.56,Default,,0,0,0,,Bindings, Converter Library, and
Dialogue: 0,0:25:43.69,0:25:45.54,Default,,0,0,0,,the Core ML Specification make
Dialogue: 0,0:25:45.54,0:25:47.60,Default,,0,0,0,,this package extensible so it's
Dialogue: 0,0:25:47.60,0:25:49.69,Default,,0,0,0,,easy to build new converters and
Dialogue: 0,0:25:49.72,0:25:51.70,Default,,0,0,0,,to build converters for a lot of
Dialogue: 0,0:25:51.70,0:25:52.90,Default,,0,0,0,,existing formats that aren't
Dialogue: 0,0:25:52.93,0:25:53.27,Default,,0,0,0,,there yet.
Dialogue: 0,0:25:53.92,0:25:55.69,Default,,0,0,0,,And because this is open source,
Dialogue: 0,0:25:56.18,0:25:57.86,Default,,0,0,0,,it's easy to take this package
Dialogue: 0,0:25:58.17,0:25:59.64,Default,,0,0,0,,and even integrate it into
Dialogue: 0,0:25:59.64,0:26:01.48,Default,,0,0,0,,another open source library and
Dialogue: 0,0:26:01.48,0:26:02.74,Default,,0,0,0,,build new converters on top.
Dialogue: 0,0:26:02.74,0:26:03.77,Default,,0,0,0,,And there are no restrictions
Dialogue: 0,0:26:03.77,0:26:04.02,Default,,0,0,0,,here.
Dialogue: 0,0:26:04.13,0:26:06.98,Default,,0,0,0,,This is BSD licensed.
Dialogue: 0,0:26:07.52,0:26:10.50,Default,,0,0,0,,[ Applause ]
Dialogue: 0,0:26:13.23,0:26:15.27,Default,,0,0,0,,The Core ML Model Format is a
Dialogue: 0,0:26:15.27,0:26:17.26,Default,,0,0,0,,single document format and it
Dialogue: 0,0:26:17.26,0:26:19.22,Default,,0,0,0,,encapsulates both the functional
Dialogue: 0,0:26:19.22,0:26:20.74,Default,,0,0,0,,description of the model in
Dialogue: 0,0:26:20.74,0:26:22.54,Default,,0,0,0,,terms of its inputs and outputs,
Dialogue: 0,0:26:22.97,0:26:24.13,Default,,0,0,0,,as well as the trained
Dialogue: 0,0:26:24.16,0:26:25.18,Default,,0,0,0,,parameters of the model.
Dialogue: 0,0:26:25.58,0:26:27.66,Default,,0,0,0,,So to look at an example, for a
Dialogue: 0,0:26:27.66,0:26:29.09,Default,,0,0,0,,simple model like a Linear
Dialogue: 0,0:26:29.09,0:26:30.72,Default,,0,0,0,,Regression, this would be the
Dialogue: 0,0:26:30.72,0:26:32.06,Default,,0,0,0,,set of weights and offset that
Dialogue: 0,0:26:32.06,0:26:33.17,Default,,0,0,0,,are learned at training time.
Dialogue: 0,0:26:33.68,0:26:35.25,Default,,0,0,0,,And for a more complex model
Dialogue: 0,0:26:35.25,0:26:36.68,Default,,0,0,0,,like a Neural Network, this
Dialogue: 0,0:26:36.68,0:26:38.48,Default,,0,0,0,,actually encapsulates both the
Dialogue: 0,0:26:38.48,0:26:40.41,Default,,0,0,0,,structure of the network as well
Dialogue: 0,0:26:40.41,0:26:41.87,Default,,0,0,0,,as the learned weights at
Dialogue: 0,0:26:41.87,0:26:42.42,Default,,0,0,0,,training time.
Dialogue: 0,0:26:43.24,0:26:44.98,Default,,0,0,0,,And this is a public file format
Dialogue: 0,0:26:45.15,0:26:46.60,Default,,0,0,0,,and it's fully documented on
Dialogue: 0,0:26:46.60,0:26:51.19,Default,,0,0,0,,developer.apple.com.
Dialogue: 0,0:26:51.75,0:26:53.02,Default,,0,0,0,,When you look at a Machine
Dialogue: 0,0:26:53.02,0:26:55.27,Default,,0,0,0,,Learning Model in Xcode, you see
Dialogue: 0,0:26:55.27,0:26:56.55,Default,,0,0,0,,a view something like this.
Dialogue: 0,0:26:56.55,0:26:57.78,Default,,0,0,0,,You get all of the metadata and
Dialogue: 0,0:26:57.87,0:26:59.94,Default,,0,0,0,,the functional interface, and
Dialogue: 0,0:27:00.05,0:27:02.12,Default,,0,0,0,,what we now see is that that's
Dialogue: 0,0:27:02.12,0:27:04.09,Default,,0,0,0,,entirely powered by this Core ML
Dialogue: 0,0:27:04.09,0:27:04.71,Default,,0,0,0,,Model Format.
Dialogue: 0,0:27:04.77,0:27:06.13,Default,,0,0,0,,So the Single Document Format
Dialogue: 0,0:27:06.21,0:27:07.53,Default,,0,0,0,,contains all the information
Dialogue: 0,0:27:07.78,0:27:09.51,Default,,0,0,0,,Xcode needs to give you a UI on
Dialogue: 0,0:27:09.69,0:27:11.32,Default,,0,0,0,,top of this model and to let
Dialogue: 0,0:27:11.32,0:27:12.82,Default,,0,0,0,,your code call it and then to
Dialogue: 0,0:27:12.82,0:27:14.85,Default,,0,0,0,,execute it on device.
Dialogue: 0,0:27:16.36,0:27:18.88,Default,,0,0,0,,The Core ML converters all work
Dialogue: 0,0:27:18.88,0:27:19.45,Default,,0,0,0,,in the same way.
Dialogue: 0,0:27:20.10,0:27:21.89,Default,,0,0,0,,They start by taking a model in
Dialogue: 0,0:27:21.89,0:27:23.47,Default,,0,0,0,,a source format, for instance
Dialogue: 0,0:27:23.53,0:27:25.94,Default,,0,0,0,,Caffe, and converting it into
Dialogue: 0,0:27:25.94,0:27:27.07,Default,,0,0,0,,the Core ML Model Format.
Dialogue: 0,0:27:28.25,0:27:30.43,Default,,0,0,0,,There's a set of unified APIs to
Dialogue: 0,0:27:30.43,0:27:31.91,Default,,0,0,0,,convert these models from a
Dialogue: 0,0:27:31.91,0:27:33.66,Default,,0,0,0,,variety of formats into Core ML
Dialogue: 0,0:27:33.66,0:27:34.05,Default,,0,0,0,,Format.
Dialogue: 0,0:27:34.45,0:27:35.51,Default,,0,0,0,,So if you know how to convert
Dialogue: 0,0:27:35.51,0:27:36.96,Default,,0,0,0,,from one format, you know how to
Dialogue: 0,0:27:37.00,0:27:38.37,Default,,0,0,0,,convert from all formats.
Dialogue: 0,0:27:39.03,0:27:43.37,Default,,0,0,0,,Let's take an example and look
Dialogue: 0,0:27:43.37,0:27:44.92,Default,,0,0,0,,more closely at how we would
Dialogue: 0,0:27:44.92,0:27:46.42,Default,,0,0,0,,convert a Caffe model.
Dialogue: 0,0:27:47.47,0:27:48.92,Default,,0,0,0,,Caffe works a bit like this.
Dialogue: 0,0:27:49.15,0:27:50.63,Default,,0,0,0,,It has several files to
Dialogue: 0,0:27:50.63,0:27:51.55,Default,,0,0,0,,represent the model.
Dialogue: 0,0:27:52.24,0:27:54.56,Default,,0,0,0,,The .caffemodel file represents
Dialogue: 0,0:27:54.72,0:27:56.04,Default,,0,0,0,,the learned weights in that
Dialogue: 0,0:27:56.13,0:27:58.85,Default,,0,0,0,,model which the .prototxt file
Dialogue: 0,0:27:59.13,0:28:00.63,Default,,0,0,0,,represents the structure of the
Dialogue: 0,0:28:00.63,0:28:01.28,Default,,0,0,0,,Neural Network.
Dialogue: 0,0:28:02.52,0:28:04.17,Default,,0,0,0,,When Caffe is doing inference,
Dialogue: 0,0:28:04.81,0:28:06.13,Default,,0,0,0,,you would start by taking an
Dialogue: 0,0:28:06.13,0:28:07.88,Default,,0,0,0,,image, say, like a rose like
Dialogue: 0,0:28:07.92,0:28:10.16,Default,,0,0,0,,this, and you'd pass it into
Dialogue: 0,0:28:10.16,0:28:11.21,Default,,0,0,0,,Caffe with these two files.
Dialogue: 0,0:28:11.80,0:28:13.35,Default,,0,0,0,,And Caffe would give back an
Dialogue: 0,0:28:13.43,0:28:15.15,Default,,0,0,0,,index of a class label like,
Dialogue: 0,0:28:15.25,0:28:16.24,Default,,0,0,0,,say, 74.
Dialogue: 0,0:28:17.19,0:28:18.70,Default,,0,0,0,,Then there's a third file, a
Dialogue: 0,0:28:18.70,0:28:21.23,Default,,0,0,0,,labels.txt that maps those
Dialogue: 0,0:28:21.23,0:28:23.36,Default,,0,0,0,,indices to string class labels
Dialogue: 0,0:28:23.58,0:28:24.19,Default,,0,0,0,,like "Rose".
Dialogue: 0,0:28:25.07,0:28:26.61,Default,,0,0,0,,So it's important to note that
Dialogue: 0,0:28:26.66,0:28:28.89,Default,,0,0,0,,those 3 files really encapsulate
Dialogue: 0,0:28:28.89,0:28:30.30,Default,,0,0,0,,together all of the information
Dialogue: 0,0:28:30.30,0:28:31.72,Default,,0,0,0,,in the model, and so that's
Dialogue: 0,0:28:31.72,0:28:33.16,Default,,0,0,0,,what's needed for conversion
Dialogue: 0,0:28:33.16,0:28:34.23,Default,,0,0,0,,into the Core ML Format.
Dialogue: 0,0:28:35.90,0:28:38.61,Default,,0,0,0,,So now, let's look at an example
Dialogue: 0,0:28:38.61,0:28:40.40,Default,,0,0,0,,of converting a Caffe model into
Dialogue: 0,0:28:40.40,0:28:42.53,Default,,0,0,0,,a Core ML Model.
Dialogue: 0,0:28:43.52,0:28:46.50,Default,,0,0,0,,[ Applause ]
Dialogue: 0,0:28:51.07,0:28:52.71,Default,,0,0,0,,I'm going to start by opening an
Dialogue: 0,0:28:52.71,0:28:54.23,Default,,0,0,0,,interactive python prompt here.
Dialogue: 0,0:28:54.70,0:28:56.47,Default,,0,0,0,,So we can type python code and
Dialogue: 0,0:28:56.47,0:28:58.72,Default,,0,0,0,,see the output in the real time.
Dialogue: 0,0:28:59.54,0:29:00.85,Default,,0,0,0,,So I'm going to start by
Dialogue: 0,0:29:00.91,0:29:02.65,Default,,0,0,0,,importing coremltools.
Dialogue: 0,0:29:02.65,0:29:03.84,Default,,0,0,0,,Again, this is the name of that
Dialogue: 0,0:29:03.92,0:29:04.79,Default,,0,0,0,,package in python.
Dialogue: 0,0:29:04.79,0:29:09.28,Default,,0,0,0,,And as soon as that's done, I
Dialogue: 0,0:29:09.28,0:29:11.01,Default,,0,0,0,,can just type coremltools.
Dialogue: 0,0:29:11.47,0:29:12.71,Default,,0,0,0,,And when I'm working with a new
Dialogue: 0,0:29:12.71,0:29:14.51,Default,,0,0,0,,python package, the first thing
Dialogue: 0,0:29:14.51,0:29:16.44,Default,,0,0,0,,I like to do is tab complete on
Dialogue: 0,0:29:16.56,0:29:17.74,Default,,0,0,0,,it and see what's available in
Dialogue: 0,0:29:17.74,0:29:18.14,Default,,0,0,0,,the API.
Dialogue: 0,0:29:19.45,0:29:21.47,Default,,0,0,0,,So here on tab complete, we can
Dialogue: 0,0:29:21.53,0:29:23.32,Default,,0,0,0,,see that coremltools contains
Dialogue: 0,0:29:23.42,0:29:25.03,Default,,0,0,0,,converters which is each of
Dialogue: 0,0:29:25.03,0:29:26.36,Default,,0,0,0,,those high-level converters from
Dialogue: 0,0:29:26.36,0:29:27.91,Default,,0,0,0,,another format into the Core ML
Dialogue: 0,0:29:27.91,0:29:30.65,Default,,0,0,0,,Format, as well as models,
Dialogue: 0,0:29:30.82,0:29:32.74,Default,,0,0,0,,specification version and utils
Dialogue: 0,0:29:33.20,0:29:34.51,Default,,0,0,0,,which are the framework bindings
Dialogue: 0,0:29:34.58,0:29:36.26,Default,,0,0,0,,and the converter library, and
Dialogue: 0,0:29:36.29,0:29:37.64,Default,,0,0,0,,together with those you can
Dialogue: 0,0:29:37.64,0:29:38.95,Default,,0,0,0,,build a new converter and test
Dialogue: 0,0:29:39.20,0:29:40.04,Default,,0,0,0,,that it gives the same
Dialogue: 0,0:29:40.04,0:29:41.22,Default,,0,0,0,,predictions as the original
Dialogue: 0,0:29:41.22,0:29:41.99,Default,,0,0,0,,training framework.
Dialogue: 0,0:29:42.65,0:29:44.96,Default,,0,0,0,,And the .protonamesbase which
Dialogue: 0,0:29:44.96,0:29:46.69,Default,,0,0,0,,contains the read and write APIs
Dialogue: 0,0:29:46.90,0:29:48.27,Default,,0,0,0,,for the Core ML Model Format.
Dialogue: 0,0:29:49.13,0:29:50.16,Default,,0,0,0,,Today we're going to focus on
Dialogue: 0,0:29:50.16,0:29:50.75,Default,,0,0,0,,the converters.
Dialogue: 0,0:29:51.55,0:29:53.18,Default,,0,0,0,,So again, if I do .converters
Dialogue: 0,0:29:53.28,0:29:54.74,Default,,0,0,0,,and then tab complete once more,
Dialogue: 0,0:29:55.14,0:29:56.57,Default,,0,0,0,,I can see all of the converters
Dialogue: 0,0:29:56.57,0:29:57.75,Default,,0,0,0,,that are available in this name
Dialogue: 0,0:29:57.75,0:29:58.55,Default,,0,0,0,,space right now.
Dialogue: 0,0:29:58.62,0:30:00.85,Default,,0,0,0,,So there's caffe, keras, libsvn,
Dialogue: 0,0:30:01.07,0:30:02.65,Default,,0,0,0,,scikit-learn, and xgboost.
Dialogue: 0,0:30:03.05,0:30:04.07,Default,,0,0,0,,And today we're going to focus
Dialogue: 0,0:30:04.07,0:30:04.63,Default,,0,0,0,,on Caffe.
Dialogue: 0,0:30:05.45,0:30:07.42,Default,,0,0,0,,So once more I'll do .caffe and
Dialogue: 0,0:30:07.58,0:30:08.61,Default,,0,0,0,,tab complete and see what's
Dialogue: 0,0:30:08.61,0:30:09.12,Default,,0,0,0,,available.
Dialogue: 0,0:30:09.12,0:30:10.35,Default,,0,0,0,,And it just tab completed for
Dialogue: 0,0:30:10.35,0:30:10.55,Default,,0,0,0,,me.
Dialogue: 0,0:30:10.76,0:30:12.40,Default,,0,0,0,,Convert. So it's that simple.
Dialogue: 0,0:30:12.40,0:30:13.49,Default,,0,0,0,,There's just one function in
Dialogue: 0,0:30:13.49,0:30:15.43,Default,,0,0,0,,here called convert, and let's
Dialogue: 0,0:30:15.43,0:30:17.23,Default,,0,0,0,,look at how we would use that.
Dialogue: 0,0:30:18.76,0:30:22.60,Default,,0,0,0,,So first I'm going to start by
Dialogue: 0,0:30:22.68,0:30:23.68,Default,,0,0,0,,setting up the inputs.
Dialogue: 0,0:30:24.01,0:30:25.77,Default,,0,0,0,,So I know I have a Caffe model
Dialogue: 0,0:30:26.67,0:30:27.72,Default,,0,0,0,,defined by two files.
Dialogue: 0,0:30:27.79,0:30:29.52,Default,,0,0,0,,So I'm going to say caffemodel =
Dialogue: 0,0:30:29.64,0:30:30.79,Default,,0,0,0,,and I'm going to give a two pole
Dialogue: 0,0:30:31.07,0:30:32.51,Default,,0,0,0,,of two strings pointing to the
Dialogue: 0,0:30:32.51,0:30:34.20,Default,,0,0,0,,file names of that Caffe Model,
Dialogue: 0,0:30:34.48,0:30:37.33,Default,,0,0,0,,which are flowers.caffemodel and
Dialogue: 0,0:30:37.40,0:30:38.88,Default,,0,0,0,,flowers.prototxt.
Dialogue: 0,0:30:39.05,0:30:40.79,Default,,0,0,0,,And together those represent the
Dialogue: 0,0:30:40.79,0:30:42.54,Default,,0,0,0,,learned weights in the network
Dialogue: 0,0:30:42.54,0:30:43.43,Default,,0,0,0,,as well as the network
Dialogue: 0,0:30:43.43,0:30:43.94,Default,,0,0,0,,structure.
Dialogue: 0,0:30:44.49,0:30:48.64,Default,,0,0,0,,Next I'm going to set up a class
Dialogue: 0,0:30:48.69,0:30:49.36,Default,,0,0,0,,label file.
Dialogue: 0,0:30:49.36,0:30:52.67,Default,,0,0,0,,So I'm going to say labels = and
Dialogue: 0,0:30:52.67,0:30:54.44,Default,,0,0,0,,I have labels.txt here.
Dialogue: 0,0:30:55.36,0:30:56.82,Default,,0,0,0,,And that represents the mapping
Dialogue: 0,0:30:56.91,0:30:58.71,Default,,0,0,0,,of numeric indices to string
Dialogue: 0,0:30:58.71,0:30:59.45,Default,,0,0,0,,class labels.
Dialogue: 0,0:31:00.89,0:31:02.22,Default,,0,0,0,,Now to run the converter.
Dialogue: 0,0:31:02.49,0:31:03.38,Default,,0,0,0,,It's very simple.
Dialogue: 0,0:31:03.69,0:31:05.13,Default,,0,0,0,,All I have to do is say
Dialogue: 0,0:31:05.24,0:31:10.29,Default,,0,0,0,,coremlmodel = coremltools
Dialogue: 0,0:31:10.68,0:31:13.63,Default,,0,0,0,,.converters.caffe.convert and it
Dialogue: 0,0:31:13.63,0:31:16.50,Default,,0,0,0,,all tab completes, and I'm just
Dialogue: 0,0:31:16.50,0:31:18.47,Default,,0,0,0,,going to pass in that caffemodel
Dialogue: 0,0:31:19.07,0:31:21.29,Default,,0,0,0,,and classlabels = labels.
Dialogue: 0,0:31:21.86,0:31:22.89,Default,,0,0,0,,So I'm just passing in those
Dialogue: 0,0:31:22.89,0:31:23.60,Default,,0,0,0,,three files.
Dialogue: 0,0:31:24.38,0:31:27.43,Default,,0,0,0,,And when the converter finishes,
Dialogue: 0,0:31:27.77,0:31:29.42,Default,,0,0,0,,what I get back is a Core ML
Dialogue: 0,0:31:29.42,0:31:29.74,Default,,0,0,0,,Model.
Dialogue: 0,0:31:30.52,0:31:32.12,Default,,0,0,0,,Right here in python, I can
Dialogue: 0,0:31:32.12,0:31:34.00,Default,,0,0,0,,print out the model and see the
Dialogue: 0,0:31:34.00,0:31:36.40,Default,,0,0,0,,interface that I get with that
Dialogue: 0,0:31:36.40,0:31:36.72,Default,,0,0,0,,model.
Dialogue: 0,0:31:37.29,0:31:38.52,Default,,0,0,0,,So I can see that it has one
Dialogue: 0,0:31:38.52,0:31:41.16,Default,,0,0,0,,input named "data" and that
Dialogue: 0,0:31:41.16,0:31:43.24,Default,,0,0,0,,input is a multi-array which
Dialogue: 0,0:31:43.24,0:31:46.41,Default,,0,0,0,,shaped 3 by 227 by 227 and typed
Dialogue: 0,0:31:46.49,0:31:46.86,Default,,0,0,0,,double.
Dialogue: 0,0:31:47.10,0:31:49.17,Default,,0,0,0,,And we'll get back to that in a
Dialogue: 0,0:31:49.17,0:31:49.44,Default,,0,0,0,,minute.
Dialogue: 0,0:31:50.18,0:31:51.57,Default,,0,0,0,,It also has 2 outputs.
Dialogue: 0,0:31:52.13,0:31:54.05,Default,,0,0,0,,One is named "prob" and it's a
Dialogue: 0,0:31:54.05,0:31:56.10,Default,,0,0,0,,dictionary with string keys, so
Dialogue: 0,0:31:56.10,0:31:57.18,Default,,0,0,0,,that's going to represent the
Dialogue: 0,0:31:57.18,0:31:59.28,Default,,0,0,0,,probabilities for each possible
Dialogue: 0,0:31:59.28,0:31:59.98,Default,,0,0,0,,class label.
Dialogue: 0,0:32:00.97,0:32:02.39,Default,,0,0,0,,And another output named
Dialogue: 0,0:32:02.39,0:32:03.91,Default,,0,0,0,,classLabel as a string, and
Dialogue: 0,0:32:04.01,0:32:05.19,Default,,0,0,0,,that's simply going to be the
Dialogue: 0,0:32:05.19,0:32:06.35,Default,,0,0,0,,most likely class label.
Dialogue: 0,0:32:06.54,0:32:07.69,Default,,0,0,0,,So for convenience, you don't
Dialogue: 0,0:32:07.69,0:32:08.37,Default,,0,0,0,,have to look at all the
Dialogue: 0,0:32:08.37,0:32:09.75,Default,,0,0,0,,probabilities to find out which
Dialogue: 0,0:32:09.75,0:32:10.66,Default,,0,0,0,,one is the most likely.
Dialogue: 0,0:32:13.28,0:32:15.70,Default,,0,0,0,,But looking at this, I know that
Dialogue: 0,0:32:15.70,0:32:17.71,Default,,0,0,0,,this input type is not quite the
Dialogue: 0,0:32:17.71,0:32:19.15,Default,,0,0,0,,interface that I wanted the
Dialogue: 0,0:32:19.15,0:32:21.44,Default,,0,0,0,,model to have, so I can go back
Dialogue: 0,0:32:21.83,0:32:22.86,Default,,0,0,0,,and run the converter with
Dialogue: 0,0:32:22.86,0:32:24.73,Default,,0,0,0,,another parameter to modify the
Dialogue: 0,0:32:24.73,0:32:26.37,Default,,0,0,0,,input type because instead of a
Dialogue: 0,0:32:26.37,0:32:28.22,Default,,0,0,0,,multi-array, I would like for
Dialogue: 0,0:32:28.22,0:32:29.98,Default,,0,0,0,,this model to take an image as
Dialogue: 0,0:32:29.98,0:32:30.25,Default,,0,0,0,,input.
Dialogue: 0,0:32:31.90,0:32:33.67,Default,,0,0,0,,So I'm going to go back and add
Dialogue: 0,0:32:34.34,0:32:36.31,Default,,0,0,0,,image input names = data.
Dialogue: 0,0:32:36.92,0:32:38.25,Default,,0,0,0,,And again, just looking at the
Dialogue: 0,0:32:38.25,0:32:39.45,Default,,0,0,0,,output here, you can see that
Dialogue: 0,0:32:39.48,0:32:41.36,Default,,0,0,0,,the input name is data, so it's
Dialogue: 0,0:32:41.36,0:32:42.79,Default,,0,0,0,,going to know what to do with
Dialogue: 0,0:32:43.85,0:32:44.94,Default,,0,0,0,,that input.
Dialogue: 0,0:32:45.16,0:32:46.74,Default,,0,0,0,,If I run the converter once more
Dialogue: 0,0:32:47.13,0:32:48.16,Default,,0,0,0,,and then again print out the
Dialogue: 0,0:32:48.16,0:32:50.82,Default,,0,0,0,,model interface, now I see that
Dialogue: 0,0:32:50.82,0:32:52.67,Default,,0,0,0,,the input named data is an image
Dialogue: 0,0:32:52.94,0:32:55.49,Default,,0,0,0,,with width 227, height 227, and
Dialogue: 0,0:32:55.53,0:32:56.64,Default,,0,0,0,,color space RGB.
Dialogue: 0,0:32:59.52,0:33:03.73,Default,,0,0,0,,[ Applause ]
Dialogue: 0,0:33:04.23,0:33:05.38,Default,,0,0,0,,Now that we have a Core ML
Dialogue: 0,0:33:05.38,0:33:07.67,Default,,0,0,0,,Model, let's check and make sure
Dialogue: 0,0:33:07.67,0:33:09.06,Default,,0,0,0,,that the conversion succeeded
Dialogue: 0,0:33:09.38,0:33:10.65,Default,,0,0,0,,and thus we get correct
Dialogue: 0,0:33:10.76,0:33:12.13,Default,,0,0,0,,predictions with this Core ML
Dialogue: 0,0:33:12.13,0:33:12.47,Default,,0,0,0,,Model.
Dialogue: 0,0:33:13.83,0:33:15.49,Default,,0,0,0,,I'm going to start by importing
Dialogue: 0,0:33:15.49,0:33:16.97,Default,,0,0,0,,the python image library so that
Dialogue: 0,0:33:16.97,0:33:18.70,Default,,0,0,0,,I can work with images and pass
Dialogue: 0,0:33:18.70,0:33:19.89,Default,,0,0,0,,an image directly into the
Dialogue: 0,0:33:19.89,0:33:20.23,Default,,0,0,0,,model.
Dialogue: 0,0:33:20.86,0:33:23.10,Default,,0,0,0,,So I'm going to say from PIL
Dialogue: 0,0:33:23.55,0:33:28.20,Default,,0,0,0,,input Image and then Rose =
Dialogue: 0,0:33:28.33,0:33:30.95,Default,,0,0,0,,Image.open rose.jpg.
Dialogue: 0,0:33:31.74,0:33:34.13,Default,,0,0,0,,And just to prove to you I've
Dialogue: 0,0:33:34.13,0:33:36.76,Default,,0,0,0,,got nothing up my sleeve, I'm
Dialogue: 0,0:33:36.76,0:33:39.98,Default,,0,0,0,,going to call rose.show and show
Dialogue: 0,0:33:39.98,0:33:41.90,Default,,0,0,0,,you that this is indeed a
Dialogue: 0,0:33:41.90,0:33:43.57,Default,,0,0,0,,picture of a rose.
Dialogue: 0,0:33:47.04,0:33:49.04,Default,,0,0,0,,[ Applause ]
Dialogue: 0,0:33:49.06,0:33:49.97,Default,,0,0,0,,You don't need to clap for that.
Dialogue: 0,0:33:50.52,0:33:52.72,Default,,0,0,0,,[ Laughter ]
Dialogue: 0,0:33:53.22,0:33:55.45,Default,,0,0,0,,So now that I've shown that this
Dialogue: 0,0:33:55.45,0:33:56.85,Default,,0,0,0,,image actually does represent a
Dialogue: 0,0:33:56.85,0:33:58.18,Default,,0,0,0,,rose, let's see if the model
Dialogue: 0,0:33:58.18,0:33:58.71,Default,,0,0,0,,agrees.
Dialogue: 0,0:33:59.49,0:34:01.48,Default,,0,0,0,,So checking the prediction is as
Dialogue: 0,0:34:01.48,0:34:02.81,Default,,0,0,0,,easy as calling
Dialogue: 0,0:34:02.91,0:34:06.47,Default,,0,0,0,,coremlmodel.predict, and this is
Dialogue: 0,0:34:06.53,0:34:08.60,Default,,0,0,0,,that Core ML framework binding
Dialogue: 0,0:34:08.70,0:34:09.86,Default,,0,0,0,,that we talked about earlier.
Dialogue: 0,0:34:10.96,0:34:11.86,Default,,0,0,0,,And we're going to pass the
Dialogue: 0,0:34:11.86,0:34:14.77,Default,,0,0,0,,input named data the value rose.
Dialogue: 0,0:34:16.42,0:34:17.59,Default,,0,0,0,,And immediately we get back a
Dialogue: 0,0:34:17.59,0:34:20.10,Default,,0,0,0,,prediction of class label rose.
Dialogue: 0,0:34:21.52,0:34:26.20,Default,,0,0,0,,[ Applause ]
Dialogue: 0,0:34:26.70,0:34:27.73,Default,,0,0,0,,But let's make sure the model --
Dialogue: 0,0:34:27.73,0:34:29.21,Default,,0,0,0,,let's make sure it's not a fluke
Dialogue: 0,0:34:29.21,0:34:30.18,Default,,0,0,0,,and let's make sure the model
Dialogue: 0,0:34:30.18,0:34:31.34,Default,,0,0,0,,really knows that this is a
Dialogue: 0,0:34:31.34,0:34:31.69,Default,,0,0,0,,rose.
Dialogue: 0,0:34:32.02,0:34:32.98,Default,,0,0,0,,So we're going to scroll down
Dialogue: 0,0:34:32.98,0:34:34.40,Default,,0,0,0,,through the class probabilities
Dialogue: 0,0:34:34.99,0:34:36.38,Default,,0,0,0,,until we see rose here.
Dialogue: 0,0:34:37.94,0:34:39.14,Default,,0,0,0,,And we can see that the model is
Dialogue: 0,0:34:39.14,0:34:40.46,Default,,0,0,0,,actually very confident that
Dialogue: 0,0:34:40.46,0:34:41.10,Default,,0,0,0,,this is a rose.
Dialogue: 0,0:34:41.10,0:34:44.03,Default,,0,0,0,,So this is .991 out of 1
Dialogue: 0,0:34:44.46,0:34:45.93,Default,,0,0,0,,confidence that this is a rose.
Dialogue: 0,0:34:45.99,0:34:47.40,Default,,0,0,0,,So I'm going to conclude that
Dialogue: 0,0:34:47.45,0:34:49.20,Default,,0,0,0,,probably this model did convert
Dialogue: 0,0:34:49.20,0:34:49.66,Default,,0,0,0,,correctly.
Dialogue: 0,0:34:50.43,0:34:51.83,Default,,0,0,0,,If I was doing this in a real
Dialogue: 0,0:34:51.83,0:34:53.30,Default,,0,0,0,,application, I would want to
Dialogue: 0,0:34:53.30,0:34:54.47,Default,,0,0,0,,actually test this a bit more
Dialogue: 0,0:34:54.47,0:34:55.83,Default,,0,0,0,,rigorously so I would provide
Dialogue: 0,0:34:55.83,0:34:57.40,Default,,0,0,0,,more than one example and I
Dialogue: 0,0:34:57.43,0:34:59.04,Default,,0,0,0,,would also want to check that
Dialogue: 0,0:34:59.08,0:35:00.41,Default,,0,0,0,,the predictions that I get here
Dialogue: 0,0:35:00.41,0:35:02.02,Default,,0,0,0,,from Core ML are exactly the
Dialogue: 0,0:35:02.11,0:35:03.70,Default,,0,0,0,,same as the predictions that
Dialogue: 0,0:35:03.85,0:35:05.18,Default,,0,0,0,,Caffe would have given me for
Dialogue: 0,0:35:05.18,0:35:06.72,Default,,0,0,0,,the same input, and that's how
Dialogue: 0,0:35:06.72,0:35:07.82,Default,,0,0,0,,we know that the conversion has
Dialogue: 0,0:35:07.86,0:35:08.37,Default,,0,0,0,,succeeded.
Dialogue: 0,0:35:09.18,0:35:10.53,Default,,0,0,0,,But that will take too long for
Dialogue: 0,0:35:10.53,0:35:12.53,Default,,0,0,0,,this demo so let's move on.
Dialogue: 0,0:35:13.19,0:35:15.13,Default,,0,0,0,,What I'm going to do now is save
Dialogue: 0,0:35:15.29,0:35:16.97,Default,,0,0,0,,the model out and then look at
Dialogue: 0,0:35:16.97,0:35:17.81,Default,,0,0,0,,it in Xcode.
Dialogue: 0,0:35:18.39,0:35:18.97,Default,,0,0,0,,So I'm, going to say
Dialogue: 0,0:35:18.97,0:35:21.43,Default,,0,0,0,,coremlmodel.save, and I'm going
Dialogue: 0,0:35:21.43,0:35:21.82,Default,,0,0,0,,to call it
Dialogue: 0,0:35:21.90,0:35:23.89,Default,,0,0,0,,FlowerPredictor.mlmodel.
Dialogue: 0,0:35:24.57,0:35:27.74,Default,,0,0,0,,And then I'm just going to open
Dialogue: 0,0:35:27.74,0:35:29.08,Default,,0,0,0,,the current directory and finder
Dialogue: 0,0:35:29.52,0:35:31.19,Default,,0,0,0,,and double-click that model to
Dialogue: 0,0:35:31.19,0:35:33.65,Default,,0,0,0,,open it in Xcode.
Dialogue: 0,0:35:33.79,0:35:36.66,Default,,0,0,0,,And what we can see here is that
Dialogue: 0,0:35:36.66,0:35:37.93,Default,,0,0,0,,it's a Machine Learning Model
Dialogue: 0,0:35:37.93,0:35:39.33,Default,,0,0,0,,with name FlowerPredictor.
Dialogue: 0,0:35:39.33,0:35:40.36,Default,,0,0,0,,Type is Neural Network
Dialogue: 0,0:35:40.36,0:35:43.85,Default,,0,0,0,,Classifier and its size is 229.1
Dialogue: 0,0:35:43.85,0:35:44.27,Default,,0,0,0,,megabytes.
Dialogue: 0,0:35:45.35,0:35:46.31,Default,,0,0,0,,But there's a lot of missing
Dialogue: 0,0:35:46.31,0:35:47.19,Default,,0,0,0,,information, too.
Dialogue: 0,0:35:47.19,0:35:48.69,Default,,0,0,0,,It doesn't know the author, the
Dialogue: 0,0:35:48.69,0:35:51.22,Default,,0,0,0,,license, the description or the
Dialogue: 0,0:35:51.22,0:35:52.62,Default,,0,0,0,,descriptions for the inputs and
Dialogue: 0,0:35:52.62,0:35:52.94,Default,,0,0,0,,outputs.
Dialogue: 0,0:35:53.90,0:35:55.35,Default,,0,0,0,,So while this is a working
Dialogue: 0,0:35:55.35,0:35:57.26,Default,,0,0,0,,model, it's not necessarily one
Dialogue: 0,0:35:57.26,0:35:58.29,Default,,0,0,0,,I would want to give to a
Dialogue: 0,0:35:58.29,0:35:59.67,Default,,0,0,0,,colleague or put on the internet
Dialogue: 0,0:36:00.10,0:36:01.70,Default,,0,0,0,,because it's not quite as useful
Dialogue: 0,0:36:01.70,0:36:03.07,Default,,0,0,0,,if it doesn't really declare
Dialogue: 0,0:36:03.07,0:36:04.20,Default,,0,0,0,,what it's supposed to do and how
Dialogue: 0,0:36:04.20,0:36:04.65,Default,,0,0,0,,to use it.
Dialogue: 0,0:36:05.34,0:36:06.14,Default,,0,0,0,,So I'm going to be a good
Dialogue: 0,0:36:06.19,0:36:07.66,Default,,0,0,0,,citizen and go back and give
Dialogue: 0,0:36:07.66,0:36:08.85,Default,,0,0,0,,this model some metadata.
Dialogue: 0,0:36:14.07,0:36:15.84,Default,,0,0,0,,Back in the python prompt, I can
Dialogue: 0,0:36:15.84,0:36:17.44,Default,,0,0,0,,just mutate the model right here
Dialogue: 0,0:36:17.98,0:36:19.82,Default,,0,0,0,,by assigning to fields at the
Dialogue: 0,0:36:19.88,0:36:20.40,Default,,0,0,0,,top level.
Dialogue: 0,0:36:20.40,0:36:24.08,Default,,0,0,0,,So I can say author = "Zach
Dialogue: 0,0:36:24.98,0:36:25.13,Default,,0,0,0,,Nation".
Dialogue: 0,0:36:25.90,0:36:29.74,Default,,0,0,0,,coremlmodel.license = "BSD".
Dialogue: 0,0:36:31.65,0:36:35.92,Default,,0,0,0,,coremlmodel.shortdescription = a
Dialogue: 0,0:36:36.03,0:36:37.69,Default,,0,0,0,,flower classifier.
Dialogue: 0,0:36:39.29,0:36:41.40,Default,,0,0,0,,And let's set the help text for
Dialogue: 0,0:36:41.40,0:36:42.61,Default,,0,0,0,,those inputs and outputs as
Dialogue: 0,0:36:42.61,0:36:44.38,Default,,0,0,0,,well, because not only does that
Dialogue: 0,0:36:44.38,0:36:46.54,Default,,0,0,0,,show up in the Xcode view, but
Dialogue: 0,0:36:46.54,0:36:48.54,Default,,0,0,0,,when the generated code is there
Dialogue: 0,0:36:48.54,0:36:50.04,Default,,0,0,0,,and you can call into it that
Dialogue: 0,0:36:50.04,0:36:51.98,Default,,0,0,0,,actually becomes documentation
Dialogue: 0,0:36:52.07,0:36:53.48,Default,,0,0,0,,comments in the generated code.
Dialogue: 0,0:36:53.92,0:36:55.31,Default,,0,0,0,,So when your tab completing an
Dialogue: 0,0:36:55.56,0:36:56.80,Default,,0,0,0,,Xcode this is what someone
Dialogue: 0,0:36:56.80,0:36:58.17,Default,,0,0,0,,consuming this mode will see.
Dialogue: 0,0:36:58.83,0:37:00.66,Default,,0,0,0,,So I'm going to say
Dialogue: 0,0:37:00.91,0:37:03.51,Default,,0,0,0,,coremlmodel.inputdescription for
Dialogue: 0,0:37:03.51,0:37:07.82,Default,,0,0,0,,"data" is an image of a flower.
Dialogue: 0,0:37:09.47,0:37:09.84,Default,,0,0,0,,And
Dialogue: 0,0:37:09.84,0:37:12.00,Default,,0,0,0,,coremlmodel.outputdescription
Dialogue: 0,0:37:12.00,0:37:16.01,Default,,0,0,0,,"prob" is the probabilities for
Dialogue: 0,0:37:16.01,0:37:20.52,Default,,0,0,0,,each flower type, for the given
Dialogue: 0,0:37:20.52,0:37:20.99,Default,,0,0,0,,input.
Dialogue: 0,0:37:21.66,0:37:21.75,Default,,0,0,0,,And
Dialogue: 0,0:37:23.28,0:37:26.49,Default,,0,0,0,,coremlmodel.outputdescription
Dialogue: 0,0:37:26.55,0:37:30.52,Default,,0,0,0,,"classLabel" is "The most likely
Dialogue: 0,0:37:30.55,0:37:33.13,Default,,0,0,0,,type of flower, for the given
Dialogue: 0,0:37:33.18,0:37:33.49,Default,,0,0,0,,input."
Dialogue: 0,0:37:34.07,0:37:37.06,Default,,0,0,0,,And now we can just save that
Dialogue: 0,0:37:37.06,0:37:39.80,Default,,0,0,0,,model once again and I'm just
Dialogue: 0,0:37:41.11,0:37:42.52,Default,,0,0,0,,going to clobber the file that
Dialogue: 0,0:37:42.52,0:37:44.26,Default,,0,0,0,,was there because now I want the
Dialogue: 0,0:37:44.26,0:37:44.94,Default,,0,0,0,,one with metadata.
Dialogue: 0,0:37:44.94,0:37:46.94,Default,,0,0,0,,So I'm going to just save it
Dialogue: 0,0:37:46.94,0:37:47.95,Default,,0,0,0,,right on top of the file that
Dialogue: 0,0:37:47.95,0:37:49.93,Default,,0,0,0,,was there before and open that
Dialogue: 0,0:37:49.93,0:37:51.23,Default,,0,0,0,,directory and finder again.
Dialogue: 0,0:37:52.05,0:37:53.18,Default,,0,0,0,,And now when I double-click the
Dialogue: 0,0:37:53.18,0:37:55.55,Default,,0,0,0,,model and open it in Xcode, we
Dialogue: 0,0:37:55.55,0:37:57.18,Default,,0,0,0,,can see that it contains useful
Dialogue: 0,0:37:57.18,0:37:59.00,Default,,0,0,0,,metadata describing how the
Dialogue: 0,0:37:59.00,0:38:00.54,Default,,0,0,0,,model is intended should be used
Dialogue: 0,0:38:00.79,0:38:02.51,Default,,0,0,0,,and what the inputs and outputs
Dialogue: 0,0:38:02.58,0:38:02.82,Default,,0,0,0,,do.
Dialogue: 0,0:38:04.52,0:38:09.50,Default,,0,0,0,,[ Applause ]
Dialogue: 0,0:38:13.08,0:38:17.00,Default,,0,0,0,,So to recap, what we saw is that
Dialogue: 0,0:38:17.00,0:38:18.71,Default,,0,0,0,,using Core ML Tools to convert a
Dialogue: 0,0:38:18.71,0:38:21.27,Default,,0,0,0,,model is as easy as import
Dialogue: 0,0:38:21.27,0:38:23.53,Default,,0,0,0,,coremltools, setting up the
Dialogue: 0,0:38:23.53,0:38:25.57,Default,,0,0,0,,inputs, and then calling a
Dialogue: 0,0:38:25.65,0:38:27.19,Default,,0,0,0,,simple high-level convert
Dialogue: 0,0:38:27.19,0:38:29.32,Default,,0,0,0,,function to get back a model in
Dialogue: 0,0:38:29.32,0:38:30.36,Default,,0,0,0,,Core ML Model Format.
Dialogue: 0,0:38:31.10,0:38:32.76,Default,,0,0,0,,And the best part is, let's say
Dialogue: 0,0:38:32.76,0:38:33.95,Default,,0,0,0,,you switch training frameworks
Dialogue: 0,0:38:34.23,0:38:36.68,Default,,0,0,0,,from Caffe to Keras, switching
Dialogue: 0,0:38:36.68,0:38:38.42,Default,,0,0,0,,converters is as easy as
Dialogue: 0,0:38:38.48,0:38:40.37,Default,,0,0,0,,updating the name space because
Dialogue: 0,0:38:40.37,0:38:41.65,Default,,0,0,0,,all of the convert functions
Dialogue: 0,0:38:41.82,0:38:43.83,Default,,0,0,0,,share the same high-level API
Dialogue: 0,0:38:47.52,0:38:51.80,Default,,0,0,0,,[ Applause ]
Dialogue: 0,0:38:52.30,0:38:54.93,Default,,0,0,0,,Core ML Tools supports Caffe and
Dialogue: 0,0:38:54.96,0:38:57.03,Default,,0,0,0,,Keras models as Neural Networks.
Dialogue: 0,0:38:57.49,0:38:58.97,Default,,0,0,0,,Scikit-Learn for Pipelines.
Dialogue: 0,0:39:00.15,0:39:02.07,Default,,0,0,0,,Scikit-Learn and XGBoost for
Dialogue: 0,0:39:02.07,0:39:04.88,Default,,0,0,0,,Tree Ensembles, and LIBSVM and
Dialogue: 0,0:39:05.07,0:39:06.88,Default,,0,0,0,,Scikit-Learn for Linear Models
Dialogue: 0,0:39:07.03,0:39:08.37,Default,,0,0,0,,and Support Vector Machines.
Dialogue: 0,0:39:09.14,0:39:10.35,Default,,0,0,0,,It's also worth noting that
Dialogue: 0,0:39:10.51,0:39:12.20,Default,,0,0,0,,Keras is a really powerful
Dialogue: 0,0:39:12.38,0:39:14.22,Default,,0,0,0,,high-level interface to several
Dialogue: 0,0:39:14.22,0:39:15.51,Default,,0,0,0,,popular deep learning training
Dialogue: 0,0:39:15.51,0:39:17.06,Default,,0,0,0,,tools, including TensorFlow.
Dialogue: 0,0:39:17.65,0:39:18.45,Default,,0,0,0,,So if you're training a
Dialogue: 0,0:39:18.45,0:39:20.41,Default,,0,0,0,,TensorFlow Model in Keras, you
Dialogue: 0,0:39:20.41,0:39:22.36,Default,,0,0,0,,can use Core ML Tools to convert
Dialogue: 0,0:39:22.36,0:39:24.61,Default,,0,0,0,,it into Core ML Model Format.
Dialogue: 0,0:39:26.52,0:39:31.20,Default,,0,0,0,,[ Applause ]
Dialogue: 0,0:39:31.70,0:39:34.05,Default,,0,0,0,,Obtaining models, you want to
Dialogue: 0,0:39:34.05,0:39:35.18,Default,,0,0,0,,look in two places.
Dialogue: 0,0:39:35.82,0:39:37.94,Default,,0,0,0,,One is the set of example models
Dialogue: 0,0:39:37.94,0:39:39.47,Default,,0,0,0,,on developer.apple.com.
Dialogue: 0,0:39:39.85,0:39:40.77,Default,,0,0,0,,And again, these are
Dialogue: 0,0:39:40.90,0:39:42.53,Default,,0,0,0,,pre-training models already in
Dialogue: 0,0:39:42.53,0:39:44.21,Default,,0,0,0,,the Core ML Model Format and so
Dialogue: 0,0:39:44.21,0:39:45.47,Default,,0,0,0,,this is the easiest way to get
Dialogue: 0,0:39:45.47,0:39:46.92,Default,,0,0,0,,started if you're new to Machine
Dialogue: 0,0:39:46.92,0:39:48.52,Default,,0,0,0,,Learning or if one of these
Dialogue: 0,0:39:48.52,0:39:50.26,Default,,0,0,0,,models does the task that you're
Dialogue: 0,0:39:50.26,0:39:51.52,Default,,0,0,0,,trying to do in your app.
Dialogue: 0,0:39:51.96,0:39:52.95,Default,,0,0,0,,But because there's a whole
Dialogue: 0,0:39:52.95,0:39:54.07,Default,,0,0,0,,world of machine learning out
Dialogue: 0,0:39:54.13,0:39:55.84,Default,,0,0,0,,there and a variety of models in
Dialogue: 0,0:39:55.84,0:39:57.27,Default,,0,0,0,,use cases in a variety of
Dialogue: 0,0:39:57.27,0:39:59.24,Default,,0,0,0,,formats, we've created Core ML
Dialogue: 0,0:39:59.24,0:40:01.06,Default,,0,0,0,,Tools to allow you to convert
Dialogue: 0,0:40:01.25,0:40:02.38,Default,,0,0,0,,from any of these popular
Dialogue: 0,0:40:02.38,0:40:04.24,Default,,0,0,0,,formats into the Core ML Model
Dialogue: 0,0:40:05.10,0:40:05.29,Default,,0,0,0,,Format.
Dialogue: 0,0:40:06.52,0:40:11.31,Default,,0,0,0,,[ Applause ]
Dialogue: 0,0:40:11.81,0:40:13.53,Default,,0,0,0,,So, in summary, what we've
Dialogue: 0,0:40:13.53,0:40:15.83,Default,,0,0,0,,learned today is that Core ML
Dialogue: 0,0:40:15.83,0:40:17.40,Default,,0,0,0,,makes it really easy to
Dialogue: 0,0:40:17.40,0:40:18.36,Default,,0,0,0,,integrate Machine Learning
Dialogue: 0,0:40:18.36,0:40:19.49,Default,,0,0,0,,Models into your app.
Dialogue: 0,0:40:19.89,0:40:22.02,Default,,0,0,0,,Simply drag and drop into Xcode
Dialogue: 0,0:40:22.02,0:40:23.34,Default,,0,0,0,,and you get a code interfaced to
Dialogue: 0,0:40:23.34,0:40:23.74,Default,,0,0,0,,the model.
Dialogue: 0,0:40:25.18,0:40:26.98,Default,,0,0,0,,Core ML has rich datatype
Dialogue: 0,0:40:27.05,0:40:28.88,Default,,0,0,0,,support for a variety of use
Dialogue: 0,0:40:28.95,0:40:30.34,Default,,0,0,0,,cases and it deals with
Dialogue: 0,0:40:30.34,0:40:31.49,Default,,0,0,0,,datatypes that you're already
Dialogue: 0,0:40:31.49,0:40:33.57,Default,,0,0,0,,familiar with from your app
Dialogue: 0,0:40:35.32,0:40:35.44,Default,,0,0,0,,code.
Dialogue: 0,0:40:35.63,0:40:37.23,Default,,0,0,0,,Core ML is hardware optimized
Dialogue: 0,0:40:37.41,0:40:38.49,Default,,0,0,0,,and it's built on top of
Dialogue: 0,0:40:38.54,0:40:39.80,Default,,0,0,0,,performance primitives like
Dialogue: 0,0:40:39.80,0:40:41.30,Default,,0,0,0,,Metal Performance Shaders and
Dialogue: 0,0:40:41.30,0:40:42.98,Default,,0,0,0,,Accelerate so that you get the
Dialogue: 0,0:40:42.98,0:40:44.53,Default,,0,0,0,,best possible performance on
Dialogue: 0,0:40:44.53,0:40:45.07,Default,,0,0,0,,device.
Dialogue: 0,0:40:45.66,0:40:49.53,Default,,0,0,0,,And through Core ML Tools, Core
Dialogue: 0,0:40:49.53,0:40:51.12,Default,,0,0,0,,ML is compatible with the most
Dialogue: 0,0:40:51.16,0:40:53.38,Default,,0,0,0,,popular Machine Learning Formats
Dialogue: 0,0:40:53.73,0:40:54.90,Default,,0,0,0,,and more will be added over
Dialogue: 0,0:40:55.75,0:40:55.84,Default,,0,0,0,,time.
Dialogue: 0,0:40:57.29,0:40:59.11,Default,,0,0,0,,For more information, please see
Dialogue: 0,0:40:59.11,0:41:00.99,Default,,0,0,0,,developer.apple.com with our
Dialogue: 0,0:41:00.99,0:41:02.56,Default,,0,0,0,,session number 710.
Dialogue: 0,0:41:03.12,0:41:05.24,Default,,0,0,0,,We have a couple of related
Dialogue: 0,0:41:05.24,0:41:06.50,Default,,0,0,0,,sessions coming up you may be
Dialogue: 0,0:41:06.50,0:41:07.34,Default,,0,0,0,,interested in.
Dialogue: 0,0:41:07.53,0:41:08.52,Default,,0,0,0,,To look at some low-level
Dialogue: 0,0:41:08.52,0:41:09.90,Default,,0,0,0,,details about how we get such
Dialogue: 0,0:41:09.90,0:41:11.02,Default,,0,0,0,,good performance on this
Dialogue: 0,0:41:11.02,0:41:12.27,Default,,0,0,0,,hardware, check out the
Dialogue: 0,0:41:12.27,0:41:14.03,Default,,0,0,0,,Accelerate and Metal 2 sessions.
Dialogue: 0,0:41:14.44,0:41:14.80,Default,,0,0,0,,Thank you.
Dialogue: 0,0:41:15.52,0:41:20.50,Default,,0,0,0,,[ Applause ]
